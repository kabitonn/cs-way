<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.43" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://vuepress-theme-hope-v2-demo.mrhope.site/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html"><meta property="og:site_name" content="CS Way"><meta property="og:title" content="å…«ã€ä»»åŠ¡å–æ¶ˆä¸å…³é—­"><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-05-16T12:07:59.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:modified_time" content="2022-05-16T12:07:59.000Z"><link rel="stylesheet" href="//at.alicdn.com/t/font_2410206_mfj6e1vbwo.css"><link rel="manifest" href="/cs-way/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#46bd87"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"><title>å…«ã€ä»»åŠ¡å–æ¶ˆä¸å…³é—­ | CS Way</title><meta name="description" content="CS Way">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/cs-way/assets/style.ed81f444.css">
    <link rel="modulepreload" href="/cs-way/assets/app.7d4bd0aa.js"><link rel="modulepreload" href="/cs-way/assets/Javaå¹¶å‘è¿›é˜¶.html.3a23bb9c.js"><link rel="modulepreload" href="/cs-way/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/cs-way/assets/Javaå¹¶å‘è¿›é˜¶.html.24e1ca9e.js"><link rel="prefetch" href="/cs-way/assets/index.html.428f64d0.js"><link rel="prefetch" href="/cs-way/assets/home.html.0bd41dd0.js"><link rel="prefetch" href="/cs-way/assets/slide.html.8837fb5e.js"><link rel="prefetch" href="/cs-way/assets/index.html.9539c43d.js"><link rel="prefetch" href="/cs-way/assets/JavaEE.html.f77c4b93.js"><link rel="prefetch" href="/cs-way/assets/JavaIO.html.043a1641.js"><link rel="prefetch" href="/cs-way/assets/JavaåŸºç¡€.html.10bc9e79.js"><link rel="prefetch" href="/cs-way/assets/Javaå®¹å™¨.html.2ceee697.js"><link rel="prefetch" href="/cs-way/assets/Javaå¹¶å‘åŸºç¡€.html.d176e322.js"><link rel="prefetch" href="/cs-way/assets/Javaç‰¹æ€§.html.133c685d.js"><link rel="prefetch" href="/cs-way/assets/Javaè™šæ‹Ÿæœº-JVMè°ƒä¼˜.html.aea2e824.js"><link rel="prefetch" href="/cs-way/assets/Javaè™šæ‹Ÿæœº-å†…å­˜ç®¡ç†.html.1b60750a.js"><link rel="prefetch" href="/cs-way/assets/Javaè™šæ‹Ÿæœº-æ‰§è¡Œç³»ç»Ÿ.html.ca070534.js"><link rel="prefetch" href="/cs-way/assets/Javaé«˜çº§.html.23867857.js"><link rel="prefetch" href="/cs-way/assets/index.html.02e0653e.js"><link rel="prefetch" href="/cs-way/assets/index.html.a027ec4c.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-ä¸­ä»‹è€….html.fcec0131.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-äº«å…ƒ.html.c01dd79c.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-ä»£ç†.html.10ec8c02.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-å•ä¾‹.html.0d885b0c.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-åŸå‹æ¨¡å¼.html.c7a958ae.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-å‘½ä»¤.html.282b7bd4.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-å¤‡å¿˜å½•.html.da0ffd6b.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-å¤–è§‚.html.9f4c35dd.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-å·¥å‚æ¨¡å¼.html.b4bfec28.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-å»ºé€ è€…æ¨¡å¼.html.19c7b3fc.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-æ¡¥æ¥.html.8f9a30fb.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-æ¨¡æ¿æ–¹æ³•.html.b7f3d90d.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-çŠ¶æ€.html.381db42b.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-ç›®å½•.html.c5dd8249.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-ç©ºå¯¹è±¡.html.1e2fb7cf.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-ç­–ç•¥.html.5b66ebbd.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-ç»„åˆ.html.2eb2cb18.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-è£…é¥°.html.15164c1b.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-è§‚å¯Ÿè€….html.b193f055.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-è§£é‡Šå™¨.html.ce787a46.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-è®¿é—®è€….html.11946150.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-è´£ä»»é“¾.html.916275bb.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-è¿­ä»£å™¨.html.e19bfac3.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-é€‚é…å™¨.html.b9bea4a6.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼.html.ef55b7fd.js"><link rel="prefetch" href="/cs-way/assets/é¢å‘å¯¹è±¡æ€æƒ³.html.5f004f29.js"><link rel="prefetch" href="/cs-way/assets/index.html.8a7d1052.js"><link rel="prefetch" href="/cs-way/assets/åˆ†å¸ƒå¼ä¸­é—´ä»¶.html.b61da623.js"><link rel="prefetch" href="/cs-way/assets/åˆ†å¸ƒå¼äº‹åŠ¡.html.7170a391.js"><link rel="prefetch" href="/cs-way/assets/åˆ†å¸ƒå¼æœç´¢.html.d83bd2ad.js"><link rel="prefetch" href="/cs-way/assets/åˆ†å¸ƒå¼æ•°æ®åº“.html.6b15d98a.js"><link rel="prefetch" href="/cs-way/assets/åˆ†å¸ƒå¼æœåŠ¡.html.fc52b1ba.js"><link rel="prefetch" href="/cs-way/assets/åˆ†å¸ƒå¼æ¶ˆæ¯.html.7961b79b.js"><link rel="prefetch" href="/cs-way/assets/åˆ†å¸ƒå¼ç¼“å­˜.html.fa57d2aa.js"><link rel="prefetch" href="/cs-way/assets/åˆ†å¸ƒå¼è®¡ç®—.html.bda1a102.js"><link rel="prefetch" href="/cs-way/assets/åˆ†å¸ƒå¼è°ƒåº¦.html.889af8f6.js"><link rel="prefetch" href="/cs-way/assets/é…ç½®ä¸­å¿ƒ.html.fc79b407.js"><link rel="prefetch" href="/cs-way/assets/JS-è¿›é˜¶.html.202ada66.js"><link rel="prefetch" href="/cs-way/assets/JavaScript.html.689f32a1.js"><link rel="prefetch" href="/cs-way/assets/index.html.94f05edc.js"><link rel="prefetch" href="/cs-way/assets/å‰ç«¯åŸºç¡€.html.049f831d.js"><link rel="prefetch" href="/cs-way/assets/Docker.html.cacb3a30.js"><link rel="prefetch" href="/cs-way/assets/Git.html.139cfce4.js"><link rel="prefetch" href="/cs-way/assets/IDEA.html.3fa858b0.js"><link rel="prefetch" href="/cs-way/assets/index.html.42cdb1ee.js"><link rel="prefetch" href="/cs-way/assets/VSCode.html.b7f7095f.js"><link rel="prefetch" href="/cs-way/assets/æ„å»ºå·¥å…·.html.d3af6cc7.js"><link rel="prefetch" href="/cs-way/assets/æ­£åˆ™è¡¨è¾¾å¼.html.e57f6ffa.js"><link rel="prefetch" href="/cs-way/assets/index.html.4c938fe4.js"><link rel="prefetch" href="/cs-way/assets/ä»£ç å¯è¯»æ€§.html.bc4c00a2.js"><link rel="prefetch" href="/cs-way/assets/ä»£ç é£æ ¼è§„èŒƒ.html.c2840a92.js"><link rel="prefetch" href="/cs-way/assets/Linux.html.417259a1.js"><link rel="prefetch" href="/cs-way/assets/index.html.1ea15a64.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºæ“ä½œç³»ç»Ÿ-å†…å­˜ç®¡ç†.html.272069f1.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºæ“ä½œç³»ç»Ÿ-æ¦‚è¿°.html.43f3a0c6.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºæ“ä½œç³»ç»Ÿ-æ­»é”.html.f244a44c.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºæ“ä½œç³»ç»Ÿ-ç›®å½•.html.5ac8915d.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºæ“ä½œç³»ç»Ÿ-è®¾å¤‡ç®¡ç†.html.caa64bce.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºæ“ä½œç³»ç»Ÿ-è¿›ç¨‹ç®¡ç†.html.5a7b502a.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºæ“ä½œç³»ç»Ÿ-é“¾æ¥.html.bdf0a6fb.js"><link rel="prefetch" href="/cs-way/assets/Leetcode-Databaseé¢˜è§£.html.4053ef8b.js"><link rel="prefetch" href="/cs-way/assets/MySQL.html.c258d858.js"><link rel="prefetch" href="/cs-way/assets/index.html.da039aed.js"><link rel="prefetch" href="/cs-way/assets/Redis.html.d3a30afa.js"><link rel="prefetch" href="/cs-way/assets/SQL.html.99bd980a.js"><link rel="prefetch" href="/cs-way/assets/æ•°æ®åº“ç³»ç»ŸåŸç†.html.67380b70.js"><link rel="prefetch" href="/cs-way/assets/Dubbo.html.de463de6.js"><link rel="prefetch" href="/cs-way/assets/Kafka.html.c378c4de.js"><link rel="prefetch" href="/cs-way/assets/PandoraBoot.html.47e9d634.js"><link rel="prefetch" href="/cs-way/assets/index.html.6cc0d80c.js"><link rel="prefetch" href="/cs-way/assets/RabbitMQ.html.689c5c33.js"><link rel="prefetch" href="/cs-way/assets/Spring-MVC.html.e626b019.js"><link rel="prefetch" href="/cs-way/assets/Spring.html.90033636.js"><link rel="prefetch" href="/cs-way/assets/SpringBoot.html.70d071c8.js"><link rel="prefetch" href="/cs-way/assets/Zookeeper.html.10a75aae.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-äºŒåˆ†æŸ¥æ‰¾.html.63c70b1d.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-ä½è¿ç®—.html.daa1db7e.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-åˆ†æ²».html.1a553bdb.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-åŠ¨æ€è§„åˆ’.html.c3f68fee.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-åŒæŒ‡é’ˆ.html.1487e549.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-å“ˆå¸Œè¡¨.html.e52afdc7.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-å›¾.html.434ae080.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-å­—ç¬¦ä¸².html.3f68eef2.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-æ’åº.html.90904bb7.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-æœç´¢.html.5160fa42.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-æ•°å­¦.html.c78336c8.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-æ•°ç»„ä¸çŸ©é˜µ.html.8f597b64.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-æ ˆå’Œé˜Ÿåˆ—.html.7bb54104.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-æ ‘.html.aa387938.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-ç›®å½•.html.2b49d038.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-è´ªå¿ƒæ€æƒ³.html.b407c0f1.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-é“¾è¡¨.html.b9bd0d6f.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£.html.f422ac13.js"><link rel="prefetch" href="/cs-way/assets/index.html.a92ef41f.js"><link rel="prefetch" href="/cs-way/assets/å‰‘æŒ‡Offeré¢˜è§£-10~19.html.51f8c9c4.js"><link rel="prefetch" href="/cs-way/assets/å‰‘æŒ‡Offeré¢˜è§£-20~29.html.f6d3292e.js"><link rel="prefetch" href="/cs-way/assets/å‰‘æŒ‡Offeré¢˜è§£-30~39.html.d93aa7cd.js"><link rel="prefetch" href="/cs-way/assets/å‰‘æŒ‡Offeré¢˜è§£-3~9.html.543cacba.js"><link rel="prefetch" href="/cs-way/assets/å‰‘æŒ‡Offeré¢˜è§£-40~49.html.7f8dfd63.js"><link rel="prefetch" href="/cs-way/assets/å‰‘æŒ‡Offeré¢˜è§£-50~59.html.3976e9d1.js"><link rel="prefetch" href="/cs-way/assets/å‰‘æŒ‡Offeré¢˜è§£-60~68.html.ae46cf87.js"><link rel="prefetch" href="/cs-way/assets/å‰‘æŒ‡Offeré¢˜è§£-ç›®å½•.html.2ed35101.js"><link rel="prefetch" href="/cs-way/assets/å‰‘æŒ‡offeré¢˜è§£.html.6c86aad2.js"><link rel="prefetch" href="/cs-way/assets/ç®—æ³•-å…¶å®ƒ.html.465f6b77.js"><link rel="prefetch" href="/cs-way/assets/ç®—æ³•-å¹¶æŸ¥é›†.html.3d3f5d9d.js"><link rel="prefetch" href="/cs-way/assets/ç®—æ³•-æ’åº.html.a81344ca.js"><link rel="prefetch" href="/cs-way/assets/ç®—æ³•-æ ˆå’Œé˜Ÿåˆ—.html.8bf786e2.js"><link rel="prefetch" href="/cs-way/assets/ç®—æ³•-ç›®å½•.html.fc28a6b7.js"><link rel="prefetch" href="/cs-way/assets/ç®—æ³•-ç¬¦å·è¡¨.html.7c772d84.js"><link rel="prefetch" href="/cs-way/assets/ç®—æ³•-ç®—æ³•åˆ†æ.html.abd49a6c.js"><link rel="prefetch" href="/cs-way/assets/index.html.a3ff312a.js"><link rel="prefetch" href="/cs-way/assets/åˆ†å¸ƒå¼.html.1367e228.js"><link rel="prefetch" href="/cs-way/assets/å¾®æœåŠ¡.html.6b8a0d3b.js"><link rel="prefetch" href="/cs-way/assets/æ”»å‡»æŠ€æœ¯.html.de39e71d.js"><link rel="prefetch" href="/cs-way/assets/æ¶ˆæ¯é˜Ÿåˆ—.html.0cafff6f.js"><link rel="prefetch" href="/cs-way/assets/ç³»ç»Ÿè®¾è®¡åŸºç¡€.html.5213e40e.js"><link rel="prefetch" href="/cs-way/assets/ç¼“å­˜.html.b85ded02.js"><link rel="prefetch" href="/cs-way/assets/é›†ç¾¤.html.263dca74.js"><link rel="prefetch" href="/cs-way/assets/HTTP.html.200a36cf.js"><link rel="prefetch" href="/cs-way/assets/Netty.html.c41775fa.js"><link rel="prefetch" href="/cs-way/assets/index.html.3b112f6d.js"><link rel="prefetch" href="/cs-way/assets/Socket.html.5af740fc.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºç½‘ç»œ-ä¼ è¾“å±‚.html.645671ab.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºç½‘ç»œ-åº”ç”¨å±‚.html.49ad8f65.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºç½‘ç»œ-æ¦‚è¿°.html.b9aa4072.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºç½‘ç»œ-ç‰©ç†å±‚.html.72651189.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºç½‘ç»œ-ç›®å½•.html.009b9f13.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºç½‘ç»œ-ç½‘ç»œå±‚.html.93c77949.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºç½‘ç»œ-é“¾è·¯å±‚.html.4453b416.js"><link rel="prefetch" href="/cs-way/assets/404.html.ffe43c9f.js"><link rel="prefetch" href="/cs-way/assets/index.html.a6c1a711.js"><link rel="prefetch" href="/cs-way/assets/index.html.27fc6baf.js"><link rel="prefetch" href="/cs-way/assets/index.html.6ed75a62.js"><link rel="prefetch" href="/cs-way/assets/index.html.6935d32d.js"><link rel="prefetch" href="/cs-way/assets/index.html.0ea6ff56.js"><link rel="prefetch" href="/cs-way/assets/index.html.8cd133c2.js"><link rel="prefetch" href="/cs-way/assets/index.html.e46980d9.js"><link rel="prefetch" href="/cs-way/assets/index.html.895c1ae8.js"><link rel="prefetch" href="/cs-way/assets/index.html.ed246a1a.js"><link rel="prefetch" href="/cs-way/assets/index.html.0b093ea5.js"><link rel="prefetch" href="/cs-way/assets/index.html.64abd695.js"><link rel="prefetch" href="/cs-way/assets/index.html.b699cda5.js"><link rel="prefetch" href="/cs-way/assets/index.html.0319d1c3.js"><link rel="prefetch" href="/cs-way/assets/home.html.4142b6cc.js"><link rel="prefetch" href="/cs-way/assets/slide.html.9640240c.js"><link rel="prefetch" href="/cs-way/assets/index.html.9251eb48.js"><link rel="prefetch" href="/cs-way/assets/JavaEE.html.9fc83fd9.js"><link rel="prefetch" href="/cs-way/assets/JavaIO.html.fc4d48de.js"><link rel="prefetch" href="/cs-way/assets/JavaåŸºç¡€.html.a425c219.js"><link rel="prefetch" href="/cs-way/assets/Javaå®¹å™¨.html.d467c0f1.js"><link rel="prefetch" href="/cs-way/assets/Javaå¹¶å‘åŸºç¡€.html.8c1c3cba.js"><link rel="prefetch" href="/cs-way/assets/Javaç‰¹æ€§.html.d9a0cfe6.js"><link rel="prefetch" href="/cs-way/assets/Javaè™šæ‹Ÿæœº-JVMè°ƒä¼˜.html.f931629c.js"><link rel="prefetch" href="/cs-way/assets/Javaè™šæ‹Ÿæœº-å†…å­˜ç®¡ç†.html.e6da0d65.js"><link rel="prefetch" href="/cs-way/assets/Javaè™šæ‹Ÿæœº-æ‰§è¡Œç³»ç»Ÿ.html.80fa91f8.js"><link rel="prefetch" href="/cs-way/assets/Javaé«˜çº§.html.af96693c.js"><link rel="prefetch" href="/cs-way/assets/index.html.b461b1fa.js"><link rel="prefetch" href="/cs-way/assets/index.html.b4348210.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-ä¸­ä»‹è€….html.c6643104.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-äº«å…ƒ.html.bc3a7899.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-ä»£ç†.html.8347cf68.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-å•ä¾‹.html.97850c2a.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-åŸå‹æ¨¡å¼.html.6ce76659.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-å‘½ä»¤.html.09f37b24.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-å¤‡å¿˜å½•.html.86e0f77b.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-å¤–è§‚.html.475d9b38.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-å·¥å‚æ¨¡å¼.html.10e71abe.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-å»ºé€ è€…æ¨¡å¼.html.f5e35426.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-æ¡¥æ¥.html.02ed150c.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-æ¨¡æ¿æ–¹æ³•.html.0c1027f4.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-çŠ¶æ€.html.52ebe0d1.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-ç›®å½•.html.ebc3dd4a.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-ç©ºå¯¹è±¡.html.30a8e364.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-ç­–ç•¥.html.ecd0498e.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-ç»„åˆ.html.0d47725b.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-è£…é¥°.html.f7f011d2.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-è§‚å¯Ÿè€….html.13483dd0.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-è§£é‡Šå™¨.html.6fd2b3e9.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-è®¿é—®è€….html.24e4d866.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-è´£ä»»é“¾.html.7b841710.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-è¿­ä»£å™¨.html.0cd7c749.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼-é€‚é…å™¨.html.0cb140f7.js"><link rel="prefetch" href="/cs-way/assets/è®¾è®¡æ¨¡å¼.html.0ef585d3.js"><link rel="prefetch" href="/cs-way/assets/é¢å‘å¯¹è±¡æ€æƒ³.html.2aa3c664.js"><link rel="prefetch" href="/cs-way/assets/index.html.44b06bb3.js"><link rel="prefetch" href="/cs-way/assets/åˆ†å¸ƒå¼ä¸­é—´ä»¶.html.2d9a8049.js"><link rel="prefetch" href="/cs-way/assets/åˆ†å¸ƒå¼äº‹åŠ¡.html.247165c7.js"><link rel="prefetch" href="/cs-way/assets/åˆ†å¸ƒå¼æœç´¢.html.526d5aae.js"><link rel="prefetch" href="/cs-way/assets/åˆ†å¸ƒå¼æ•°æ®åº“.html.e1c6bf6a.js"><link rel="prefetch" href="/cs-way/assets/åˆ†å¸ƒå¼æœåŠ¡.html.355f3ae3.js"><link rel="prefetch" href="/cs-way/assets/åˆ†å¸ƒå¼æ¶ˆæ¯.html.81ec7b2d.js"><link rel="prefetch" href="/cs-way/assets/åˆ†å¸ƒå¼ç¼“å­˜.html.89d6eea4.js"><link rel="prefetch" href="/cs-way/assets/åˆ†å¸ƒå¼è®¡ç®—.html.ae857f4d.js"><link rel="prefetch" href="/cs-way/assets/åˆ†å¸ƒå¼è°ƒåº¦.html.50b63a8c.js"><link rel="prefetch" href="/cs-way/assets/é…ç½®ä¸­å¿ƒ.html.981f3b8a.js"><link rel="prefetch" href="/cs-way/assets/JS-è¿›é˜¶.html.48d76c12.js"><link rel="prefetch" href="/cs-way/assets/JavaScript.html.f407821d.js"><link rel="prefetch" href="/cs-way/assets/index.html.575d3779.js"><link rel="prefetch" href="/cs-way/assets/å‰ç«¯åŸºç¡€.html.b24a4af3.js"><link rel="prefetch" href="/cs-way/assets/Docker.html.e9879f2b.js"><link rel="prefetch" href="/cs-way/assets/Git.html.df4a94be.js"><link rel="prefetch" href="/cs-way/assets/IDEA.html.e04290f1.js"><link rel="prefetch" href="/cs-way/assets/index.html.351fdc2f.js"><link rel="prefetch" href="/cs-way/assets/VSCode.html.128dd00f.js"><link rel="prefetch" href="/cs-way/assets/æ„å»ºå·¥å…·.html.45032986.js"><link rel="prefetch" href="/cs-way/assets/æ­£åˆ™è¡¨è¾¾å¼.html.ecdd5154.js"><link rel="prefetch" href="/cs-way/assets/index.html.a0bb368c.js"><link rel="prefetch" href="/cs-way/assets/ä»£ç å¯è¯»æ€§.html.482d3ff5.js"><link rel="prefetch" href="/cs-way/assets/ä»£ç é£æ ¼è§„èŒƒ.html.00fe6f07.js"><link rel="prefetch" href="/cs-way/assets/Linux.html.dd0a80b2.js"><link rel="prefetch" href="/cs-way/assets/index.html.26779b51.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºæ“ä½œç³»ç»Ÿ-å†…å­˜ç®¡ç†.html.edfe4e37.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºæ“ä½œç³»ç»Ÿ-æ¦‚è¿°.html.12ad8a77.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºæ“ä½œç³»ç»Ÿ-æ­»é”.html.330f9806.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºæ“ä½œç³»ç»Ÿ-ç›®å½•.html.885b266b.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºæ“ä½œç³»ç»Ÿ-è®¾å¤‡ç®¡ç†.html.8b09f397.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºæ“ä½œç³»ç»Ÿ-è¿›ç¨‹ç®¡ç†.html.89abc9c9.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºæ“ä½œç³»ç»Ÿ-é“¾æ¥.html.d7d060da.js"><link rel="prefetch" href="/cs-way/assets/Leetcode-Databaseé¢˜è§£.html.3312985f.js"><link rel="prefetch" href="/cs-way/assets/MySQL.html.1a996d8c.js"><link rel="prefetch" href="/cs-way/assets/index.html.591f2ac6.js"><link rel="prefetch" href="/cs-way/assets/Redis.html.3bfaa221.js"><link rel="prefetch" href="/cs-way/assets/SQL.html.666ca38c.js"><link rel="prefetch" href="/cs-way/assets/æ•°æ®åº“ç³»ç»ŸåŸç†.html.fffa0da8.js"><link rel="prefetch" href="/cs-way/assets/Dubbo.html.bb7ad564.js"><link rel="prefetch" href="/cs-way/assets/Kafka.html.cf920637.js"><link rel="prefetch" href="/cs-way/assets/PandoraBoot.html.44d042a4.js"><link rel="prefetch" href="/cs-way/assets/index.html.15c8fbfe.js"><link rel="prefetch" href="/cs-way/assets/RabbitMQ.html.618dc22b.js"><link rel="prefetch" href="/cs-way/assets/Spring-MVC.html.8e312e27.js"><link rel="prefetch" href="/cs-way/assets/Spring.html.4d694307.js"><link rel="prefetch" href="/cs-way/assets/SpringBoot.html.d9ed577f.js"><link rel="prefetch" href="/cs-way/assets/Zookeeper.html.85b94e90.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-äºŒåˆ†æŸ¥æ‰¾.html.1d169034.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-ä½è¿ç®—.html.11685b83.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-åˆ†æ²».html.b86ab840.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-åŠ¨æ€è§„åˆ’.html.df89fc3c.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-åŒæŒ‡é’ˆ.html.7ab8a736.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-å“ˆå¸Œè¡¨.html.b49b926a.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-å›¾.html.1ee816d0.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-å­—ç¬¦ä¸².html.4191249c.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-æ’åº.html.fa75ff76.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-æœç´¢.html.cc2d6dde.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-æ•°å­¦.html.e9662f67.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-æ•°ç»„ä¸çŸ©é˜µ.html.0a9f8e03.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-æ ˆå’Œé˜Ÿåˆ—.html.9036be11.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-æ ‘.html.eaf85c7f.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-ç›®å½•.html.6f827702.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-è´ªå¿ƒæ€æƒ³.html.ce5d73eb.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£-é“¾è¡¨.html.ac0c106e.js"><link rel="prefetch" href="/cs-way/assets/Leetcodeé¢˜è§£.html.fae14de0.js"><link rel="prefetch" href="/cs-way/assets/index.html.bc6f0fb7.js"><link rel="prefetch" href="/cs-way/assets/å‰‘æŒ‡Offeré¢˜è§£-10~19.html.db18e06a.js"><link rel="prefetch" href="/cs-way/assets/å‰‘æŒ‡Offeré¢˜è§£-20~29.html.02ff6a24.js"><link rel="prefetch" href="/cs-way/assets/å‰‘æŒ‡Offeré¢˜è§£-30~39.html.2bb5255f.js"><link rel="prefetch" href="/cs-way/assets/å‰‘æŒ‡Offeré¢˜è§£-3~9.html.8bd027f8.js"><link rel="prefetch" href="/cs-way/assets/å‰‘æŒ‡Offeré¢˜è§£-40~49.html.0208cef9.js"><link rel="prefetch" href="/cs-way/assets/å‰‘æŒ‡Offeré¢˜è§£-50~59.html.f06c814a.js"><link rel="prefetch" href="/cs-way/assets/å‰‘æŒ‡Offeré¢˜è§£-60~68.html.f4d8881d.js"><link rel="prefetch" href="/cs-way/assets/å‰‘æŒ‡Offeré¢˜è§£-ç›®å½•.html.b53883fc.js"><link rel="prefetch" href="/cs-way/assets/å‰‘æŒ‡offeré¢˜è§£.html.1f04e09c.js"><link rel="prefetch" href="/cs-way/assets/ç®—æ³•-å…¶å®ƒ.html.3b8a85e1.js"><link rel="prefetch" href="/cs-way/assets/ç®—æ³•-å¹¶æŸ¥é›†.html.673400b8.js"><link rel="prefetch" href="/cs-way/assets/ç®—æ³•-æ’åº.html.154cac81.js"><link rel="prefetch" href="/cs-way/assets/ç®—æ³•-æ ˆå’Œé˜Ÿåˆ—.html.47117cf7.js"><link rel="prefetch" href="/cs-way/assets/ç®—æ³•-ç›®å½•.html.8b022a7b.js"><link rel="prefetch" href="/cs-way/assets/ç®—æ³•-ç¬¦å·è¡¨.html.e149f3f2.js"><link rel="prefetch" href="/cs-way/assets/ç®—æ³•-ç®—æ³•åˆ†æ.html.8dea9523.js"><link rel="prefetch" href="/cs-way/assets/index.html.27106679.js"><link rel="prefetch" href="/cs-way/assets/åˆ†å¸ƒå¼.html.c9331b8e.js"><link rel="prefetch" href="/cs-way/assets/å¾®æœåŠ¡.html.54a13558.js"><link rel="prefetch" href="/cs-way/assets/æ”»å‡»æŠ€æœ¯.html.4e83165f.js"><link rel="prefetch" href="/cs-way/assets/æ¶ˆæ¯é˜Ÿåˆ—.html.1cb4c0cc.js"><link rel="prefetch" href="/cs-way/assets/ç³»ç»Ÿè®¾è®¡åŸºç¡€.html.24efc180.js"><link rel="prefetch" href="/cs-way/assets/ç¼“å­˜.html.a3b6acb3.js"><link rel="prefetch" href="/cs-way/assets/é›†ç¾¤.html.54519b98.js"><link rel="prefetch" href="/cs-way/assets/HTTP.html.2e28783e.js"><link rel="prefetch" href="/cs-way/assets/Netty.html.b2a5c95a.js"><link rel="prefetch" href="/cs-way/assets/index.html.fb7ad9db.js"><link rel="prefetch" href="/cs-way/assets/Socket.html.f5349079.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºç½‘ç»œ-ä¼ è¾“å±‚.html.58e85c0d.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºç½‘ç»œ-åº”ç”¨å±‚.html.21eea6f4.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºç½‘ç»œ-æ¦‚è¿°.html.2c56fb4b.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºç½‘ç»œ-ç‰©ç†å±‚.html.ac6333db.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºç½‘ç»œ-ç›®å½•.html.ac9ea7d5.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºç½‘ç»œ-ç½‘ç»œå±‚.html.ab88a2d8.js"><link rel="prefetch" href="/cs-way/assets/è®¡ç®—æœºç½‘ç»œ-é“¾è·¯å±‚.html.0193e332.js"><link rel="prefetch" href="/cs-way/assets/404.html.0c8252b8.js"><link rel="prefetch" href="/cs-way/assets/index.html.d5cc08ad.js"><link rel="prefetch" href="/cs-way/assets/index.html.1331f6ca.js"><link rel="prefetch" href="/cs-way/assets/index.html.da6c3a69.js"><link rel="prefetch" href="/cs-way/assets/index.html.1174fbbd.js"><link rel="prefetch" href="/cs-way/assets/index.html.c73d2264.js"><link rel="prefetch" href="/cs-way/assets/index.html.1e315145.js"><link rel="prefetch" href="/cs-way/assets/index.html.514b72a3.js"><link rel="prefetch" href="/cs-way/assets/index.html.1024e797.js"><link rel="prefetch" href="/cs-way/assets/index.html.33ef0ef0.js"><link rel="prefetch" href="/cs-way/assets/index.html.7c07e9c6.js"><link rel="prefetch" href="/cs-way/assets/index.html.6f722863.js"><link rel="prefetch" href="/cs-way/assets/index.html.5a1edb43.js"><link rel="prefetch" href="/cs-way/assets/404.a5288550.js"><link rel="prefetch" href="/cs-way/assets/Layout.27cd3fc2.js"><link rel="prefetch" href="/cs-way/assets/Slide.59f1c575.js"><link rel="prefetch" href="/cs-way/assets/Blog.f5deeaed.js"><link rel="prefetch" href="/cs-way/assets/giscus.es.d2953791.js"><link rel="prefetch" href="/cs-way/assets/auto.esm.15d52109.js"><link rel="prefetch" href="/cs-way/assets/index.1842ee54.js"><link rel="prefetch" href="/cs-way/assets/mermaid.esm.min.95aabeb7.js"><link rel="prefetch" href="/cs-way/assets/highlight.esm.d982e650.js"><link rel="prefetch" href="/cs-way/assets/markdown.esm.832a189d.js"><link rel="prefetch" href="/cs-way/assets/math.esm.a3f84b6f.js"><link rel="prefetch" href="/cs-way/assets/notes.esm.3c361cb7.js"><link rel="prefetch" href="/cs-way/assets/reveal.esm.b96f05d8.js"><link rel="prefetch" href="/cs-way/assets/search.esm.80da4a02.js"><link rel="prefetch" href="/cs-way/assets/zoom.esm.8514a202.js"><link rel="prefetch" href="/cs-way/assets/photoswipe.esm.92018b73.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc sidebar-open"><!--[--><!--[--><header class="navbar"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><a href="/cs-way/" class="home-link"><img class="logo" src="/cs-way/logo.svg" alt="CS Way"><!----><span class="site-name hide-in-pad">CS Way</span><!--[--><!----><!--]--></a><nav class="nav-links" style=""><div class="nav-item hide-in-mobile"><a href="/cs-way/" class="nav-link" aria-label="ä¸»é¡µ"><i class="icon iconfont icon-home"></i>ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="è®¡ç®—æœºåŸºç¡€"><span class="title"><i class="icon iconfont icon-creative"></i>è®¡ç®—æœºåŸºç¡€</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/cs-way/notes/%E6%95%B0%E6%8D%AE%E5%BA%93" class="nav-link" aria-label="æ•°æ®åº“"><!---->æ•°æ®åº“<!----></a></li><li class="dropdown-item"><a href="/cs-way/notes/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F" class="nav-link" aria-label="æ“ä½œç³»ç»Ÿ"><!---->æ“ä½œç³»ç»Ÿ<!----></a></li><li class="dropdown-item"><a href="/cs-way/notes/%E7%BD%91%E7%BB%9C" class="nav-link" aria-label="ç½‘ç»œ"><!---->ç½‘ç»œ<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="è½¯ä»¶å·¥ç¨‹"><span class="title"><i class="icon iconfont icon-creative"></i>è½¯ä»¶å·¥ç¨‹</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/cs-way/notes/%E7%AE%97%E6%B3%95" class="nav-link" aria-label="ç®—æ³•"><!---->ç®—æ³•<!----></a></li><li class="dropdown-item"><a href="/cs-way/notes/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1" class="nav-link" aria-label="ç³»ç»Ÿè®¾è®¡"><!---->ç³»ç»Ÿè®¾è®¡<!----></a></li><li class="dropdown-item"><a href="/cs-way/notes/OOP" class="nav-link" aria-label="OOP"><!---->OOP<!----></a></li><li class="dropdown-item"><a href="/cs-way/notes/%E5%B7%A5%E7%A8%8B%E8%B4%A8%E9%87%8F" class="nav-link" aria-label="å·¥ç¨‹è´¨é‡"><!---->å·¥ç¨‹è´¨é‡<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="ç ”å‘"><span class="title"><!---->ç ”å‘</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/cs-way/notes/Java" class="nav-link active" aria-label="java"><!---->java<!----></a></li><li class="dropdown-item"><a href="/cs-way/notes/%E6%A1%86%E6%9E%B6" class="nav-link" aria-label="æ¡†æ¶"><!---->æ¡†æ¶<!----></a></li><li class="dropdown-item"><a href="/cs-way/notes/%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%AD%E9%97%B4%E4%BB%B6" class="nav-link" aria-label="ä¸­é—´ä»¶"><!---->ä¸­é—´ä»¶<!----></a></li><li class="dropdown-item"><a href="/cs-way/notes/%E5%89%8D%E7%AB%AF" class="nav-link" aria-label="å‰ç«¯"><!---->å‰ç«¯<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/cs-way/notes/%E5%B7%A5%E5%85%B7/" class="nav-link" aria-label="å·¥å…·è½¯ä»¶"><i class="icon iconfont icon-creative"></i>å·¥å…·è½¯ä»¶<!----></a></div><div class="nav-item hide-in-mobile"><a href="https://vuepress-theme-hope.github.io/v2/zh/" rel="noopener noreferrer" target="_blank" aria-label="ä¸»é¢˜æ–‡æ¡£" class="nav-link"><i class="icon iconfont icon-note"></i>ä¸»é¢˜æ–‡æ¡£<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><div class="nav-actions-wrapper"><!--[--><!----><!--]--><div class="nav-item"><!----></div><div class="nav-item"><a class="repo-link" href="https://github.com/kabitonn/cs-note" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button><!--[--><!----><!--]--></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><p class="sidebar-heading active"><!----><span class="title">Java</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E5%9F%BA%E7%A1%80.html" class="nav-link sidebar-link sidebar-page" aria-label="ä¸€ã€çº¿ç¨‹"><!---->ä¸€ã€çº¿ç¨‹<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="å…«ã€ä»»åŠ¡å–æ¶ˆä¸å…³é—­"><!---->å…«ã€ä»»åŠ¡å–æ¶ˆä¸å…³é—­<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#ä»»åŠ¡å–æ¶ˆ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä»»åŠ¡å–æ¶ˆ"><!---->ä»»åŠ¡å–æ¶ˆ<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#ä¸­æ–­" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä¸­æ–­"><!---->ä¸­æ–­<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#é€šè¿‡futureæ¥å–æ¶ˆ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="é€šè¿‡Futureæ¥å–æ¶ˆ"><!---->é€šè¿‡Futureæ¥å–æ¶ˆ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#å¤„ç†ä¸å¯ä¸­æ–­çš„é˜»å¡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å¤„ç†ä¸å¯ä¸­æ–­çš„é˜»å¡"><!---->å¤„ç†ä¸å¯ä¸­æ–­çš„é˜»å¡<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#é‡‡ç”¨newtaskforæ¥å°è£…éæ ‡å‡†åŒ–çš„å–æ¶ˆ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="é‡‡ç”¨newTaskForæ¥å°è£…éæ ‡å‡†åŒ–çš„å–æ¶ˆ"><!---->é‡‡ç”¨newTaskForæ¥å°è£…éæ ‡å‡†åŒ–çš„å–æ¶ˆ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#åœæ­¢åŸºäºçº¿ç¨‹çš„æœåŠ¡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åœæ­¢åŸºäºçº¿ç¨‹çš„æœåŠ¡"><!---->åœæ­¢åŸºäºçº¿ç¨‹çš„æœåŠ¡<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#executorservice-ä¸­çš„å…³é—­" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ExecutorService ä¸­çš„å…³é—­"><!---->ExecutorService ä¸­çš„å…³é—­<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#jvmå…³é—­" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="JVMå…³é—­"><!---->JVMå…³é—­<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/cs-way/notes/Java/Java%E5%9F%BA%E7%A1%80.html" class="nav-link sidebar-link sidebar-page" aria-label="ä¸€ã€æ•°æ®ç±»å‹"><!---->ä¸€ã€æ•°æ®ç±»å‹<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/cs-way/notes/Java/Java%E5%AE%B9%E5%99%A8.html" class="nav-link sidebar-link sidebar-page" aria-label="ä¸€ã€æ¦‚è§ˆ"><!---->ä¸€ã€æ¦‚è§ˆ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/cs-way/notes/Java/Java%E7%89%B9%E6%80%A7.html" class="nav-link sidebar-link sidebar-page" aria-label="Java 8 ç‰¹æ€§"><!---->Java 8 ç‰¹æ€§<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/cs-way/notes/Java/Java%E8%99%9A%E6%8B%9F%E6%9C%BA-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86.html" class="nav-link sidebar-link sidebar-page" aria-label="ä¸€ã€è¿è¡Œæ—¶æ•°æ®åŒºåŸŸ"><!---->ä¸€ã€è¿è¡Œæ—¶æ•°æ®åŒºåŸŸ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/cs-way/notes/Java/Java%E8%99%9A%E6%8B%9F%E6%9C%BA-%E6%89%A7%E8%A1%8C%E7%B3%BB%E7%BB%9F.html" class="nav-link sidebar-link sidebar-page" aria-label="äº”ã€ç±»æ–‡ä»¶ç»“æ„"><!---->äº”ã€ç±»æ–‡ä»¶ç»“æ„<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/cs-way/notes/Java/Java%E8%99%9A%E6%8B%9F%E6%9C%BA-JVM%E8%B0%83%E4%BC%98.html" class="nav-link sidebar-link sidebar-page" aria-label="JDKç›‘æ§"><!---->JDKç›‘æ§<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/cs-way/notes/Java/JavaEE.html" class="nav-link sidebar-link sidebar-page" aria-label="Servlet ä»‹ç»"><!---->Servlet ä»‹ç»<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/cs-way/notes/Java/JavaIO.html" class="nav-link sidebar-link sidebar-page" aria-label="ä¸€ã€æ¦‚è§ˆ"><!---->ä¸€ã€æ¦‚è§ˆ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->å…«ã€ä»»åŠ¡å–æ¶ˆä¸å…³é—­</h1><div class="page-info"><span class="author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://mrhope.site" target="_blank" rel="noopener noreferrer">Vika</a></span><span property="author" content="Vika"></span></span><!----><span class="date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>2022å¹´5æœˆ16æ—¥</span><meta property="datePublished" content="2022-05-16T12:07:59.000Z"></span><!----><!----><span class="reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 48 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT48M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc-list"><div class="toc-header">æ­¤é¡µå†…å®¹</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#å…«ã€ä»»åŠ¡å–æ¶ˆä¸å…³é—­" class="router-link-active router-link-exact-active toc-link level1">å…«ã€ä»»åŠ¡å–æ¶ˆä¸å…³é—­</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#ä»»åŠ¡å–æ¶ˆ" class="router-link-active router-link-exact-active toc-link level2">ä»»åŠ¡å–æ¶ˆ</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#ä¸­æ–­" class="router-link-active router-link-exact-active toc-link level3">ä¸­æ–­</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#é€šè¿‡futureæ¥å–æ¶ˆ" class="router-link-active router-link-exact-active toc-link level3">é€šè¿‡Futureæ¥å–æ¶ˆ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#å¤„ç†ä¸å¯ä¸­æ–­çš„é˜»å¡" class="router-link-active router-link-exact-active toc-link level3">å¤„ç†ä¸å¯ä¸­æ–­çš„é˜»å¡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#é‡‡ç”¨newtaskforæ¥å°è£…éæ ‡å‡†åŒ–çš„å–æ¶ˆ" class="router-link-active router-link-exact-active toc-link level3">é‡‡ç”¨newTaskForæ¥å°è£…éæ ‡å‡†åŒ–çš„å–æ¶ˆ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#åœæ­¢åŸºäºçº¿ç¨‹çš„æœåŠ¡" class="router-link-active router-link-exact-active toc-link level3">åœæ­¢åŸºäºçº¿ç¨‹çš„æœåŠ¡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#executorservice-ä¸­çš„å…³é—­" class="router-link-active router-link-exact-active toc-link level3">ExecutorService ä¸­çš„å…³é—­</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#jvmå…³é—­" class="router-link-active router-link-exact-active toc-link level2">JVMå…³é—­</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#ä¹ã€javaå¹¶å‘å®¹å™¨" class="router-link-active router-link-exact-active toc-link level1">ä¹ã€Javaå¹¶å‘å®¹å™¨</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#concurrenthashmap" class="router-link-active router-link-exact-active toc-link level2">ConcurrentHashMap</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#copyonwritearraylist" class="router-link-active router-link-exact-active toc-link level2">CopyOnWriteArrayList</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#è¯»å–æ“ä½œå®ç°" class="router-link-active router-link-exact-active toc-link level3">è¯»å–æ“ä½œå®ç°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#å†™å…¥æ“ä½œå®ç°" class="router-link-active router-link-exact-active toc-link level3">å†™å…¥æ“ä½œå®ç°</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#concurrentlinkedqueue" class="router-link-active router-link-exact-active toc-link level2">ConcurrentLinkedQueue</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#blockingqueue" class="router-link-active router-link-exact-active toc-link level2">BlockingQueue</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#javaé‡Œçš„blockingqueue" class="router-link-active router-link-exact-active toc-link level3">Javaé‡Œçš„BlockingQueue</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#blockingqueueå®ç°åŸç†" class="router-link-active router-link-exact-active toc-link level3">BlockingQueueå®ç°åŸç†</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#concurrentskiplistmap" class="router-link-active router-link-exact-active toc-link level2">ConcurrentSkipListMap</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#åã€çº¿ç¨‹æ± å’Œexecutoræ¡†æ¶" class="router-link-active router-link-exact-active toc-link level1">åã€çº¿ç¨‹æ± å’ŒExecutoræ¡†æ¶</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#çº¿ç¨‹æ± " class="router-link-active router-link-exact-active toc-link level2">çº¿ç¨‹æ± </a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#å®ç°åŸç†" class="router-link-active router-link-exact-active toc-link level3">å®ç°åŸç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#çº¿ç¨‹æ± çš„ä½¿ç”¨" class="router-link-active router-link-exact-active toc-link level3">çº¿ç¨‹æ± çš„ä½¿ç”¨</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#executoræ¡†æ¶" class="router-link-active router-link-exact-active toc-link level2">Executoræ¡†æ¶</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#ä¸¤çº§è°ƒåº¦æ¨¡å‹" class="router-link-active router-link-exact-active toc-link level3">ä¸¤çº§è°ƒåº¦æ¨¡å‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#æ¡†æ¶ç»“æ„" class="router-link-active router-link-exact-active toc-link level3">æ¡†æ¶ç»“æ„</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#æ¡†æ¶ä½¿ç”¨" class="router-link-active router-link-exact-active toc-link level3">æ¡†æ¶ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#executoræ¡†æ¶çš„æˆå‘˜" class="router-link-active router-link-exact-active toc-link level3">Executoræ¡†æ¶çš„æˆå‘˜</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#threadpoolexecutor" class="router-link-active router-link-exact-active toc-link level4">ThreadPoolExecutor</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#scheduledthreadpoolexecutor" class="router-link-active router-link-exact-active toc-link level4">ScheduledThreadPoolExecutor</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#futureæ¥å£" class="router-link-active router-link-exact-active toc-link level4">Futureæ¥å£</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#runnableæ¥å£å’Œcallableæ¥å£" class="router-link-active router-link-exact-active toc-link level4">Runnableæ¥å£å’ŒCallableæ¥å£</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#threadpoolexecutorè¯¦è§£" class="router-link-active router-link-exact-active toc-link level3">ThreadPoolExecutorè¯¦è§£</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#fixedthreadpool" class="router-link-active router-link-exact-active toc-link level4">FixedThreadPool</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#singlethreadexecutor" class="router-link-active router-link-exact-active toc-link level4">SingleThreadExecutor</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#cachedthreadpool" class="router-link-active router-link-exact-active toc-link level4">CachedThreadPool</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#scheduledthreadpoolexecutorè¯¦è§£" class="router-link-active router-link-exact-active toc-link level3">ScheduledThreadPoolExecutorè¯¦è§£</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#futuretaskè¯¦è§£" class="router-link-active router-link-exact-active toc-link level3">FutureTaskè¯¦è§£</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#fork-joinæ¡†æ¶" class="router-link-active router-link-exact-active toc-link level2">Fork/Joinæ¡†æ¶</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#fork-joinæ¡†æ¶çš„è®¾è®¡" class="router-link-active router-link-exact-active toc-link level3">Fork/Joinæ¡†æ¶çš„è®¾è®¡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#fork-joinæ¡†æ¶çš„ä½¿ç”¨" class="router-link-active router-link-exact-active toc-link level3">Fork/Joinæ¡†æ¶çš„ä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#fork-joinæ¡†æ¶çš„å®ç°åŸç†" class="router-link-active router-link-exact-active toc-link level3">Fork/Joinæ¡†æ¶çš„å®ç°åŸç†</a></li><!----><!--]--></ul><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E8%BF%9B%E9%98%B6.html#å‚è€ƒèµ„æ–™" class="router-link-active router-link-exact-active toc-link level1">å‚è€ƒèµ„æ–™</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><!--[--><ul><li><a href="#%E5%85%AB%E4%BB%BB%E5%8A%A1%E5%8F%96%E6%B6%88%E4%B8%8E%E5%85%B3%E9%97%AD">å…«ã€ä»»åŠ¡å–æ¶ˆä¸å…³é—­</a><ul><li><a href="#%E4%BB%BB%E5%8A%A1%E5%8F%96%E6%B6%88">ä»»åŠ¡å–æ¶ˆ</a><ul><li><a href="#%E4%B8%AD%E6%96%AD">ä¸­æ–­</a></li><li><a href="#%E9%80%9A%E8%BF%87future%E6%9D%A5%E5%8F%96%E6%B6%88">é€šè¿‡Futureæ¥å–æ¶ˆ</a></li><li><a href="#%E5%A4%84%E7%90%86%E4%B8%8D%E5%8F%AF%E4%B8%AD%E6%96%AD%E7%9A%84%E9%98%BB%E5%A1%9E">å¤„ç†ä¸å¯ä¸­æ–­çš„é˜»å¡</a></li><li><a href="#%E9%87%87%E7%94%A8newtaskfor%E6%9D%A5%E5%B0%81%E8%A3%85%E9%9D%9E%E6%A0%87%E5%87%86%E5%8C%96%E7%9A%84%E5%8F%96%E6%B6%88">é‡‡ç”¨newTaskForæ¥å°è£…éæ ‡å‡†åŒ–çš„å–æ¶ˆ</a></li><li><a href="#%E5%81%9C%E6%AD%A2%E5%9F%BA%E4%BA%8E%E7%BA%BF%E7%A8%8B%E7%9A%84%E6%9C%8D%E5%8A%A1">åœæ­¢åŸºäºçº¿ç¨‹çš„æœåŠ¡</a></li><li><a href="#executorservice-%E4%B8%AD%E7%9A%84%E5%85%B3%E9%97%AD">ExecutorService ä¸­çš„å…³é—­</a></li></ul></li><li><a href="#jvm%E5%85%B3%E9%97%AD">JVMå…³é—­</a></li></ul></li><li><a href="#%E4%B9%9Djava%E5%B9%B6%E5%8F%91%E5%AE%B9%E5%99%A8">ä¹ã€Javaå¹¶å‘å®¹å™¨</a><ul><li><a href="#concurrenthashmap">ConcurrentHashMap</a></li><li><a href="#copyonwritearraylist">CopyOnWriteArrayList</a><ul><li><a href="#%E8%AF%BB%E5%8F%96%E6%93%8D%E4%BD%9C%E5%AE%9E%E7%8E%B0">è¯»å–æ“ä½œå®ç°</a></li><li><a href="#%E5%86%99%E5%85%A5%E6%93%8D%E4%BD%9C%E5%AE%9E%E7%8E%B0">å†™å…¥æ“ä½œå®ç°</a></li></ul></li><li><a href="#concurrentlinkedqueue">ConcurrentLinkedQueue</a></li><li><a href="#blockingqueue">BlockingQueue</a><ul><li><a href="#java%E9%87%8C%E7%9A%84blockingqueue">Javaé‡Œçš„BlockingQueue</a></li><li><a href="#blockingqueue%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86">BlockingQueueå®ç°åŸç†</a></li></ul></li><li><a href="#concurrentskiplistmap">ConcurrentSkipListMap</a></li></ul></li><li><a href="#%E5%8D%81%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%92%8Cexecutor%E6%A1%86%E6%9E%B6">åã€çº¿ç¨‹æ± å’ŒExecutoræ¡†æ¶</a><ul><li><a href="#%E7%BA%BF%E7%A8%8B%E6%B1%A0">çº¿ç¨‹æ± </a><ul><li><a href="#%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86">å®ç°åŸç†</a></li><li><a href="#%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%9A%84%E4%BD%BF%E7%94%A8">çº¿ç¨‹æ± çš„ä½¿ç”¨</a></li></ul></li><li><a href="#executor%E6%A1%86%E6%9E%B6">Executoræ¡†æ¶</a><ul><li><a href="#%E4%B8%A4%E7%BA%A7%E8%B0%83%E5%BA%A6%E6%A8%A1%E5%9E%8B">ä¸¤çº§è°ƒåº¦æ¨¡å‹</a></li><li><a href="#%E6%A1%86%E6%9E%B6%E7%BB%93%E6%9E%84">æ¡†æ¶ç»“æ„</a></li><li><a href="#%E6%A1%86%E6%9E%B6%E4%BD%BF%E7%94%A8">æ¡†æ¶ä½¿ç”¨</a></li><li><a href="#executor%E6%A1%86%E6%9E%B6%E7%9A%84%E6%88%90%E5%91%98">Executoræ¡†æ¶çš„æˆå‘˜</a></li><li><a href="#threadpoolexecutor%E8%AF%A6%E8%A7%A3">ThreadPoolExecutorè¯¦è§£</a></li><li><a href="#scheduledthreadpoolexecutor%E8%AF%A6%E8%A7%A3">ScheduledThreadPoolExecutorè¯¦è§£</a></li><li><a href="#futuretask%E8%AF%A6%E8%A7%A3">FutureTaskè¯¦è§£</a></li></ul></li><li><a href="#forkjoin%E6%A1%86%E6%9E%B6">Fork/Joinæ¡†æ¶</a><ul><li><a href="#forkjoin%E6%A1%86%E6%9E%B6%E7%9A%84%E8%AE%BE%E8%AE%A1">Fork/Joinæ¡†æ¶çš„è®¾è®¡</a></li><li><a href="#forkjoin%E6%A1%86%E6%9E%B6%E7%9A%84%E4%BD%BF%E7%94%A8">Fork/Joinæ¡†æ¶çš„ä½¿ç”¨</a></li><li><a href="#forkjoin%E6%A1%86%E6%9E%B6%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86">Fork/Joinæ¡†æ¶çš„å®ç°åŸç†</a></li></ul></li></ul></li><li><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">å‚è€ƒèµ„æ–™</a></li></ul><h1 id="å…«ã€ä»»åŠ¡å–æ¶ˆä¸å…³é—­" tabindex="-1"><a class="header-anchor" href="#å…«ã€ä»»åŠ¡å–æ¶ˆä¸å…³é—­" aria-hidden="true">#</a> å…«ã€ä»»åŠ¡å–æ¶ˆä¸å…³é—­</h1><p>è¦ä½¿ä»»åŠ¡å’Œçº¿ç¨‹å®‰å…¨ã€å¿«é€Ÿã€å¯é çš„åœæ­¢ä¸‹æ¥ï¼Œå¹¶ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹æƒ…ã€‚javaæ²¡æœ‰æä¾›ä»»ä½•æœºåˆ¶æ¥å®‰å…¨åœ°ç»ˆæ­¢çº¿ç¨‹ï¼Œä½†æä¾›äº†ä¸­æ–­åä½œæœºåˆ¶ï¼Œä¸­æ–­èƒ½ä½¿ä¸€ä¸ªçº¿ç¨‹ç»ˆæ­¢å¦ä¸€ä¸ªçº¿ç¨‹çš„å½“å‰å·¥ä½œã€‚</p><h2 id="ä»»åŠ¡å–æ¶ˆ" tabindex="-1"><a class="header-anchor" href="#ä»»åŠ¡å–æ¶ˆ" aria-hidden="true">#</a> ä»»åŠ¡å–æ¶ˆ</h2><ul><li>å¦‚æœå¤–éƒ¨ä»£ç èƒ½åœ¨æŸä¸ªæ“ä½œæ­£å¸¸å®Œæˆä¹‹å‰å°†å…¶ç½®å…¥â€œå®Œæˆâ€çŠ¶æ€ï¼Œé‚£ä¹ˆè¿™ä¸ªæ“ä½œå°±å¯ä»¥æˆä¸ºå¯å–æ¶ˆçš„ã€‚</li><li>åœ¨javaä¸­æ²¡æœ‰ä¸€ç§å®‰å…¨çš„æŠ¢å å¼æ–¹æ³•æ¥åœæ­¢çº¿ç¨‹ï¼Œå› æ­¤ä¹Ÿå°±æ²¡æœ‰å®‰å…¨çš„æŠ¢å å¼æ–¹æ³•æ¥åœæ­¢ä»»åŠ¡ã€‚åªæœ‰ä¸€äº›åä½œå¼çš„æœºåˆ¶ï¼Œä½¿è¯·æ±‚å–æ¶ˆçš„ä»»åŠ¡å’Œä»£ç éƒ½éµå¾ªä¸€ç§åå•†å¥½çš„åè®®ã€‚</li><li>ä¸€ä¸ªå¯å–æ¶ˆçš„ä»»åŠ¡å¿…é¡»æ‹¥æœ‰ã€Œå–æ¶ˆç­–ç•¥ã€ï¼šè§„å®šHow(å¦‚ä½•å–æ¶ˆ)ï¼ŒWhen(ä»€ä¹ˆæ—¶å€™æ£€æµ‹å–æ¶ˆ)å’ŒWhat(å¦‚ä½•å¤„ç†å–æ¶ˆ)ã€‚</li></ul><p>å¦‚ä½•å–æ¶ˆä¸€èˆ¬æœ‰ä¸¤ç§æ–¹æ³•ï¼š</p><ul><li>ä½¿ç”¨volatileç±»å‹çŠ¶æ€å˜é‡(ä¸ä¸€å®šå¯é )ï¼šçº¿ç¨‹ä¸­å¾ªç¯éå†çŠ¶æ€å˜é‡ï¼Œæ£€æµ‹æ˜¯å¦éœ€è¦ç»“æŸå½“å‰çº¿ç¨‹ã€‚é€šè¿‡ä¸æ–­æŸ¥çœ‹volatileç±»å‹çš„çŠ¶æ€å˜é‡æ˜¯ä¸€ç§ç®€å•çš„å–æ¶ˆç­–ç•¥ï¼Œç„¶è€Œï¼Œå¦‚æœä»»åŠ¡é™¤äº†æ£€æŸ¥çŠ¶æ€å˜é‡å¤–æ‰§è¡Œäº†é˜»å¡æ–¹æ³•ï¼Œä»»åŠ¡å¯èƒ½æ°¸è¿œä¸ä¼šæ£€æŸ¥å–æ¶ˆçŠ¶æ€æ ‡å¿—ï¼Œæ­¤æ—¶æ°¸è¿œä¸ä¼šç»“æŸä»»åŠ¡ã€‚</li><li>ä½¿ç”¨ä¸­æ–­(æœ€åˆç†çš„æ–¹æ³•)ï¼šç³»ç»Ÿæä¾›çš„å¤§å¤šæ•°é˜»å¡æ–¹æ³•å“åº”ä¸­æ–­ï¼šæ¸…é™¤ä¸­æ–­çŠ¶æ€ï¼ŒæŠ›å‡ºInterruptedExceptionå¼‚å¸¸ï¼Œè¡¨ç¤ºé˜»å¡æ“ä½œç”±äºä¸­æ–­è€Œæå‰ç»“æŸã€‚</li></ul><h3 id="ä¸­æ–­" tabindex="-1"><a class="header-anchor" href="#ä¸­æ–­" aria-hidden="true">#</a> ä¸­æ–­</h3><ul><li>é€šå¸¸ï¼Œä¸­æ–­æ˜¯å®ç°å–æ¶ˆçš„æœ€åˆç†æ–¹å¼</li><li>åœ¨å–æ¶ˆä¹‹å¤–çš„æ“ä½œä¸­ä½¿ç”¨ä¸­æ–­ï¼Œéƒ½æ˜¯ä¸åˆé€‚çš„ï¼Œå¹¶ä¸”å¾ˆéš¾æ”¯æ’‘èµ·æ›´å¤§çš„åº”ç”¨ã€‚</li><li>è°ƒç”¨ interrupt() å¹¶ä¸æ„å‘³ç€ç«‹å³åœæ­¢ç›®æ ‡çº¿ç¨‹æ­£åœ¨è¿›è¡Œçš„å·¥ä½œï¼Œè€Œåªæ˜¯ä¼ é€’äº†è¯·æ±‚ä¸­æ–­çš„æ¶ˆæ¯</li></ul><p>ä¸­æ–­çš„æ­£ç¡®ç†è§£æ˜¯ï¼Œå®ƒå¹¶ä¸ä¼šçœŸæ­£åœ°ä¸­æ–­ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹ï¼Œè€Œåªæ˜¯å‘å‡ºä¸­æ–­è¯·æ±‚ï¼Œç„¶åç”±çº¿ç¨‹åœ¨ä¸‹ä¸€ä¸ªåˆé€‚çš„æ—¶åˆ»ä¸­æ–­è‡ªå·±(è¿™äº›æ—¶åˆ»è¢«ç§°ä¸ºå–æ¶ˆç‚¹)ã€‚</p><div class="language-java ext-java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">interrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span>  <span class="token comment">//è¯·æ±‚ä¸­æ–­ï¼Œè®¾ç½®çº¿ç¨‹çš„ä¸­æ–­æ ‡è®°</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isInterrupted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span> <span class="token comment">//è¿”å›çº¿ç¨‹ä¸­æ–­çŠ¶æ€</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">interrupted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span> <span class="token comment">//è‹¥è¿”å›trueåŸæœ‰çš„ä¸­æ–­çŠ¶æ€ä¼šè¢«æ¸…é™¤ï¼Œé™¤éæƒ³å±è”½ä¸­æ–­ï¼Œå¿…å¦åˆ™é¡»å¯¹å…¶ä½œå‡ºå¤„ç†ï¼šå¯ä»¥æŠ›å‡ºInterruptedExceptionå¼‚å¸¸ï¼Œä¹Ÿå¯å†æ¬¡è°ƒç”¨interruptæ¥æ¢å¤ä¸­æ–­</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>ä¸­æ–­ç­–ç•¥</strong></p><ul><li>æœ€åˆç†çš„ä¸­æ–­ç­–ç•¥æ˜¯æŸç§å½¢å¼çš„çº¿ç¨‹çº§å–æ¶ˆæ“ä½œæˆ–æœåŠ¡åŠå–æ¶ˆæ“ä½œï¼šå°½å¿«é€€å‡ºï¼Œåœ¨å¿…è¦æ—¶è¿›è¡Œæ¸…ç†ï¼Œé€šçŸ¥æŸä¸ªæ‰€æœ‰è€…è¯¥çº¿ç¨‹å·²ç»é€€å‡ºã€‚</li><li>ä¸€ä¸ªä¸­æ–­è¯·æ±‚å¯ä»¥æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªæ¥å—è€…ã€‚</li><li>å¤§å¤šæ•°å¯é˜»å¡åº“å‡½æ•°åªæŠ›å‡ºInterruptedExceptionä½œä¸ºä¸­æ–­å“åº”ï¼Œä¹Ÿæ˜¯æœ€åˆç†çš„å–æ¶ˆç­–ç•¥ï¼šå°½å¿«é€€å‡ºæ‰§è¡Œæµç¨‹å¹¶æŠŠä¸­æ–­ä¿¡æ¯ä¼ é€’ç»™è°ƒç”¨è€…ï¼Œä»è€Œä½¿æ ˆä¸­çš„ä¸Šå±‚ä»£ç å¯ä»¥é‡‡å–è¿›ä¸€æ­¥çš„æ“ä½œã€‚</li><li>ç”±äºæ¯ä¸ªçº¿ç¨‹æ‹¥æœ‰å„è‡ªçš„ä¸­æ–­ç­–ç•¥ï¼Œé™¤éçŸ¥é“ä¸­æ–­å¯¹è¯¥çº¿ç¨‹çš„å«ä¹‰ï¼Œå¦åˆ™å°±ä¸åº”è¯¥ä¸­æ–­è¿™ä¸ªçº¿ç¨‹ã€‚</li></ul><p>å½“çº¿ç¨‹åœ¨æ´»åŠ¨ä¹‹å‰æˆ–æ´»åŠ¨æœŸé—´å¤„äºæ­£åœ¨ç­‰å¾…ã€ä¼‘çœ æˆ–å ç”¨çŠ¶æ€ä¸”è¯¥çº¿ç¨‹è¢«ä¸­æ–­æ—¶ï¼ŒæŠ›å‡ºè¯¥å¼‚å¸¸InterruptedException</p><p>æŠ› InterruptedException çš„ä»£è¡¨æ–¹æ³•æœ‰ï¼š</p><ul><li>java.lang.Object ç±»çš„ wait æ–¹æ³•</li><li>java.lang.Thread ç±»çš„ sleep æ–¹æ³•</li><li>java.lang.Thread ç±»çš„ join æ–¹æ³•</li></ul><p><strong>å“åº”ä¸­æ–­</strong></p><p>å½“è°ƒç”¨å¯ä¸­æ–­çš„é˜»å¡å‡½æ•°ï¼Œä¾‹å¦‚Thread.sleepç­‰ï¼Œæœ‰ä¸¤ç§å®ç”¨ç­–ç•¥å¯ç”¨äºå¤„ç†InterruptedExceptionï¼š</p><ol><li>ä¼ é€’å¼‚å¸¸(å¯èƒ½åœ¨æ‰§è¡ŒæŸä¸ªç‰¹å®šäºä»»åŠ¡çš„æ¸…é™¤æ“ä½œä¹‹å)ï¼šä»è€Œä½¿ä½ çš„æ–¹æ³•ä¹Ÿæˆä¸ºå¯ä¸­æ–­çš„é˜»å¡æ–¹æ³•</li><li>æ¢å¤ä¸­æ–­çŠ¶æ€ï¼šä»è€Œä½¿è°ƒç”¨æ ˆçš„ä¸Šå±‚ä»£ç èƒ½å¯¹å…¶è¿›è¡Œå¤„ç†</li></ol><p>å¦‚æœä½ ä¸æƒ³æˆ–æ— æ³•ä¼ é€’InterruptedException(æˆ–è®¸é€šè¿‡Runnableæ¥å®šä¹‰ä»»åŠ¡)ï¼Œä¸€ç§æ ‡å‡†æ–¹æ³•æ˜¯å†æ¬¡è°ƒç”¨interruptæ¥æ¢å¤ä¸­æ–­ï¼Œä¸èƒ½å±è”½InterruptedExceptionã€‚</p><ul><li>åªæœ‰å®ç°äº†çº¿ç¨‹ä¸­æ–­ç­–ç•¥çš„ä»£ç æ‰å¯ä»¥å±è”½ä¸­æ–­è¯·æ±‚ï¼Œåœ¨å¸¸è§„çš„ä»»åŠ¡å’Œåº“ä»£ç ä¸­éƒ½ä¸åº”è¯¥å±è”½ä¸­æ–­è¯·æ±‚ã€‚</li><li>å¦‚æœä»£ç ä¸ä¼šè°ƒç”¨å¯ä¸­æ–­çš„é˜»å¡æ–¹æ³•ï¼Œé‚£ä¹ˆä»ç„¶å¯ä»¥é€šè¿‡åœ¨ä»»åŠ¡ä»£ç ä¸­è½®è¯¢å½“å‰çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€æ¥å“åº”ä¸­æ–­ã€‚</li><li>joinçš„ä¸è¶³ï¼šæ— æ³•çŸ¥é“æ‰§è¡Œæ§åˆ¶æ˜¯å› ä¸ºçº¿ç¨‹æ­£å¸¸é€€å‡ºè€Œè¿”å›è¿˜æ˜¯å› ä¸ºjoinè¶…æ—¶è€Œè¿”å›ã€‚</li></ul><h3 id="é€šè¿‡futureæ¥å–æ¶ˆ" tabindex="-1"><a class="header-anchor" href="#é€šè¿‡futureæ¥å–æ¶ˆ" aria-hidden="true">#</a> é€šè¿‡Futureæ¥å–æ¶ˆ</h3><p>ExecutorService.submitå°†è¿”å›ä¸€ä¸ªFutureæ¥æè¿°ä»»åŠ¡ï¼Œ</p><ul><li>æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹æ˜¯ç”±Executoråˆ›å»ºçš„ï¼Œå®ç°äº†ä¸€ç§ä¸­æ–­ç­–ç•¥ä½¿å¾—ä»»åŠ¡å¯ä»¥é€šè¿‡ä¸­æ–­è¢«å–æ¶ˆï¼Œ</li><li>å½“å°è¯•å–æ¶ˆæŸä¸ªä»»åŠ¡æ—¶ï¼Œä¸å®œç›´æ¥ä¸­æ–­çº¿ç¨‹æ± ï¼Œå› ä¸ºå¹¶ä¸çŸ¥é“å½“ä¸­æ–­è¯·æ±‚åˆ°è¾¾æ—¶æ­£åœ¨è¿è¡Œä»€ä¹ˆä»»åŠ¡ï¼Œåªèƒ½é€šè¿‡ä»»åŠ¡çš„Futureæ¥å®ç°å–æ¶ˆã€‚</li><li>å½“Future.getæŠ›å‡ºInterruptedExceptionæˆ–TimeoutExceptionæ—¶ï¼Œå¦‚æœçŸ¥é“ä¸å†éœ€è¦ç»“æœï¼Œå°±å¯ä»¥è°ƒç”¨Future.cancelæ¥å–æ¶ˆä»»åŠ¡ã€‚</li></ul><h3 id="å¤„ç†ä¸å¯ä¸­æ–­çš„é˜»å¡" tabindex="-1"><a class="header-anchor" href="#å¤„ç†ä¸å¯ä¸­æ–­çš„é˜»å¡" aria-hidden="true">#</a> å¤„ç†ä¸å¯ä¸­æ–­çš„é˜»å¡</h3><p>å¯¹äºé‚£äº›ç”±äºæ‰§è¡Œä¸å¯ä¸­æ–­æ“ä½œè€Œè¢«é˜»å¡çš„çº¿ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨ç±»ä¼¼äºä¸­æ–­çš„æ‰‹æ®µæ¥åœæ­¢è¿™äº›çº¿ç¨‹ï¼Œä½†è¦æ±‚çŸ¥é“çº¿ç¨‹é˜»å¡çš„åŸå› ã€‚</p><p>å¸¸è§çš„ä¸å¯é˜»å¡ä¸­æ–­åŒ…æ‹¬</p><ul><li>Java.ioåŒ…ä¸­çš„Socket I/O</li><li>Java.ioåŒ…ä¸­çš„åŒæ­¥I/O</li><li>Selectorçš„å¼‚æ­¥I/O</li><li>è·å–æŸä¸ªé”</li></ul><h3 id="é‡‡ç”¨newtaskforæ¥å°è£…éæ ‡å‡†åŒ–çš„å–æ¶ˆ" tabindex="-1"><a class="header-anchor" href="#é‡‡ç”¨newtaskforæ¥å°è£…éæ ‡å‡†åŒ–çš„å–æ¶ˆ" aria-hidden="true">#</a> é‡‡ç”¨newTaskForæ¥å°è£…éæ ‡å‡†åŒ–çš„å–æ¶ˆ</h3><h3 id="åœæ­¢åŸºäºçº¿ç¨‹çš„æœåŠ¡" tabindex="-1"><a class="header-anchor" href="#åœæ­¢åŸºäºçº¿ç¨‹çš„æœåŠ¡" aria-hidden="true">#</a> åœæ­¢åŸºäºçº¿ç¨‹çš„æœåŠ¡</h3><ul><li>å¦‚æœç¡¬è¦ç¨‹åºå‡†å¤‡é€€å‡ºï¼Œé‚£ä¹ˆè¿™äº›æœåŠ¡æ‰€æ‹¥æœ‰çš„çº¿ç¨‹ä¹Ÿéœ€è¦ç»“æŸã€‚</li><li>æ­£ç¡®çš„å°è£…åŸåˆ™æ˜¯ï¼Œé™¤éæ‹¥æœ‰æŸä¸ªçº¿ç¨‹ï¼Œå¦åˆ™ä¸èƒ½å¯¹è¯¥çº¿ç¨‹è¿›è¡Œæ“æ§ã€‚</li><li>å¯¹äºæŒæœ‰çº¿ç¨‹çš„æœåŠ¡ï¼Œåªè¦æœåŠ¡çš„å­˜åœ¨æ—¶é—´å¤§äºåˆ›å»ºçº¿ç¨‹çš„æ–¹æ³•çš„å­˜åœ¨æ—¶é—´ï¼Œé‚£ä¹ˆå°±åº”è¯¥æä¾›ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚</li></ul><h3 id="executorservice-ä¸­çš„å…³é—­" tabindex="-1"><a class="header-anchor" href="#executorservice-ä¸­çš„å…³é—­" aria-hidden="true">#</a> ExecutorService ä¸­çš„å…³é—­</h3><ul><li>æ­£å¸¸å…³é—­ï¼šshutdown() æ–¹æ³•ä¼šç­‰å¾…çº¿ç¨‹éƒ½æ‰§è¡Œå®Œæ¯•ä¹‹åå†å…³é—­</li><li>å¼ºè¡Œå…³é—­ï¼šshutdownNow() æ–¹æ³•ï¼Œåˆ™ç›¸å½“äºè°ƒç”¨æ¯ä¸ªçº¿ç¨‹çš„ interrupt() æ–¹æ³•ï¼Œæ— æ³•é€šè¿‡å¸¸è§„æ–¹æ³•æ¥æ‰¾å‡ºå“ªäº›ä»»åŠ¡å·²ç»å¼€å§‹ä½†å°šæœªç»“æŸ</li></ul><h2 id="jvmå…³é—­" tabindex="-1"><a class="header-anchor" href="#jvmå…³é—­" aria-hidden="true">#</a> JVMå…³é—­</h2><p><strong>å…³é—­é’©å­</strong></p><ul><li>æŒ‡é€šè¿‡Runtime.addShutdownHookæ³¨å†Œçš„ä½†å°šæœªå¼€å§‹çš„çº¿ç¨‹ã€‚</li><li>ä¸åº”è¯¥ä¾èµ–å¯èƒ½è¢«åº”ç”¨ç¨‹åºæˆ–å…¶ä»–å…³é—­é’©å­å…³é—­çš„æœåŠ¡ï¼Œå¯¹æ‰€æœ‰æœåŠ¡ä½¿ç”¨åŒä¸€ä¸ªå…³é—­é’©å­ï¼Œå„ä¸ªå…³é—­æ“ä½œä¸²è¡Œæ‰§è¡Œã€‚</li></ul><p><strong>å®ˆæŠ¤çº¿ç¨‹</strong></p><ul><li>åº”å°½å¯èƒ½å°‘åœ°ä½¿ç”¨å®ˆæŠ¤çº¿ç¨‹ï¼Œå¾ˆå°‘æœ‰æ“ä½œèƒ½å¤Ÿåœ¨ä¸è¿›è¡Œæ¸…ç†çš„æƒ…å†µä¸‹è¢«å®‰å…¨åœ°æŠ›å¼ƒã€‚</li><li>å®ˆæŠ¤çº¿ç¨‹é€šå¸¸ä¸èƒ½ç”¨æ¥æ›¿ä»£åº”ç”¨ç¨‹åºç®¡ç†ä¸­å„ä¸ªæœåŠ¡çš„ç”Ÿå‘½å‘¨æœŸã€‚</li></ul><p><strong>ç»ˆç»“å™¨</strong></p><ul><li>é¿å…ä½¿ç”¨ã€‚</li></ul><h1 id="ä¹ã€javaå¹¶å‘å®¹å™¨" tabindex="-1"><a class="header-anchor" href="#ä¹ã€javaå¹¶å‘å®¹å™¨" aria-hidden="true">#</a> ä¹ã€Javaå¹¶å‘å®¹å™¨</h1><h2 id="concurrenthashmap" tabindex="-1"><a class="header-anchor" href="#concurrenthashmap" aria-hidden="true">#</a> ConcurrentHashMap</h2><p>ConcurrentHashMapæ˜¯çº¿ç¨‹å®‰å…¨ä¸”é«˜æ•ˆçš„HashMapã€‚</p><p>åœ¨å¹¶å‘ç¼–ç¨‹ä¸­ä½¿ç”¨HashMapå¯èƒ½å¯¼è‡´ç¨‹åºæ­»å¾ªç¯ã€‚è€Œä½¿ç”¨çº¿ç¨‹å®‰å…¨çš„HashTableæ•ˆç‡åˆéå¸¸ä½ä¸‹ï¼ŒåŸºäºä»¥ä¸Šä¸¤ä¸ªåŸå› ï¼Œä¾¿æœ‰äº†ConcurrentHashMapã€‚</p><ul><li><p>çº¿ç¨‹ä¸å®‰å…¨çš„HashMap<br> åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œä½¿ç”¨HashMapè¿›è¡Œputæ“ä½œä¼šå¼•èµ·æ­»å¾ªç¯ï¼Œå¯¼è‡´CPUåˆ©ç”¨ç‡æ¥è¿‘100%ï¼Œæ‰€ä»¥åœ¨å¹¶å‘æƒ…å†µä¸‹ä¸èƒ½ä½¿ç”¨HashMapã€‚ä¾‹å¦‚ï¼Œæ‰§è¡Œä»¥ä¸‹ä»£ç ä¼šå¼•èµ·æ­»å¾ªç¯</p></li><li><p>æ•ˆç‡ä½ä¸‹çš„HashTable<br> HashTableå®¹å™¨ä½¿ç”¨synchronizedæ¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œä½†åœ¨çº¿ç¨‹ç«äº‰æ¿€çƒˆçš„æƒ…å†µä¸‹HashTableçš„æ•ˆç‡éå¸¸ä½ä¸‹ã€‚å› ä¸ºå½“ä¸€ä¸ªçº¿ç¨‹è®¿é—®HashTableçš„åŒæ­¥æ–¹æ³•ï¼Œå…¶ä»–çº¿ç¨‹ä¹Ÿè®¿é—®HashTableçš„åŒæ­¥æ–¹æ³•æ—¶ï¼Œä¼šè¿›å…¥é˜»å¡æˆ–è½®è¯¢çŠ¶æ€ã€‚</p></li><li><p>ConcurrentHashMapçš„é”åˆ†æ®µæŠ€æœ¯å¯æœ‰æ•ˆæå‡å¹¶å‘è®¿é—®ç‡<br> HashTableå®¹å™¨åœ¨ç«äº‰æ¿€çƒˆçš„å¹¶å‘ç¯å¢ƒä¸‹è¡¨ç°å‡ºæ•ˆç‡ä½ä¸‹çš„åŸå› æ˜¯æ‰€æœ‰è®¿é—®HashTableçš„çº¿ç¨‹éƒ½å¿…é¡»ç«äº‰åŒä¸€æŠŠé”ï¼Œå‡å¦‚å®¹å™¨é‡Œæœ‰å¤šæŠŠé”ï¼Œæ¯ä¸€æŠŠé”ç”¨äºé”å®¹å™¨å…¶ä¸­ä¸€éƒ¨åˆ†æ•°æ®ï¼Œé‚£ä¹ˆå½“å¤šçº¿ç¨‹è®¿é—®å®¹å™¨é‡Œä¸åŒæ•°æ®æ®µçš„æ•°æ®æ—¶ï¼Œçº¿ç¨‹é—´å°±ä¸ä¼šå­˜åœ¨é”ç«äº‰ï¼Œä»è€Œå¯ä»¥æœ‰æ•ˆæé«˜å¹¶å‘è®¿é—®æ•ˆç‡ï¼Œè¿™å°±æ˜¯ConcurrentHashMapæ‰€ä½¿ç”¨çš„é”åˆ†æ®µæŠ€æœ¯ã€‚é¦–å…ˆå°†æ•°æ®åˆ†æˆä¸€æ®µä¸€æ®µåœ°å­˜å‚¨ï¼Œç„¶åç»™æ¯ä¸€æ®µæ•°æ®é…ä¸€æŠŠé”ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹å ç”¨é”è®¿é—®å…¶ä¸­ä¸€ä¸ªæ®µæ•°æ®çš„æ—¶å€™ï¼Œå…¶ä»–æ®µçš„æ•°æ®ä¹Ÿèƒ½è¢«å…¶ä»–çº¿ç¨‹è®¿é—®ã€‚</p></li></ul><p><strong>ConcurrentHashMapçš„ç»“æ„</strong></p><p>ConcurrentHashMapæ˜¯ç”±Segmentæ•°ç»„ç»“æ„å’ŒHashEntryæ•°ç»„ç»“æ„ç»„æˆã€‚Segmentæ˜¯ä¸€ç§å¯é‡å…¥é”(ReentrantLock)ï¼Œåœ¨ConcurrentHashMapé‡Œæ‰®æ¼”é”çš„è§’è‰²ï¼›HashEntryåˆ™ç”¨äºå­˜å‚¨é”®å€¼å¯¹æ•°æ®ã€‚ä¸€ä¸ªConcurrentHashMapé‡ŒåŒ…å«ä¸€ä¸ªSegmentæ•°ç»„ã€‚Segmentçš„ç»“æ„å’ŒHashMapç±»ä¼¼ï¼Œæ˜¯ä¸€ç§æ•°ç»„å’Œé“¾è¡¨ç»“æ„ã€‚ä¸€ä¸ªSegmenté‡ŒåŒ…å«ä¸€ä¸ªHashEntryæ•°ç»„ï¼Œæ¯ä¸ªHashEntryæ˜¯ä¸€ä¸ªé“¾è¡¨ç»“æ„çš„å…ƒç´ ï¼Œæ¯ä¸ªSegmentå®ˆæŠ¤ç€ä¸€ä¸ªHashEntryæ•°ç»„é‡Œçš„å…ƒç´ ï¼Œå½“å¯¹HashEntryæ•°ç»„çš„æ•°æ®è¿›è¡Œä¿®æ”¹æ—¶ï¼Œå¿…é¡»é¦–å…ˆè·å¾—ä¸å®ƒå¯¹åº”çš„Segmenté”ï¼Œ</p><div align="center"><p><img src="/cs-way/assets/ConcurrentHashMapçš„ç»“æ„å›¾.518550a7.png" alt="" title=":size=500" loading="lazy"></p></div><h2 id="copyonwritearraylist" tabindex="-1"><a class="header-anchor" href="#copyonwritearraylist" aria-hidden="true">#</a> CopyOnWriteArrayList</h2><p>åœ¨å¾ˆå¤šåº”ç”¨åœºæ™¯ä¸­ï¼Œè¯»æ“ä½œå¯èƒ½ä¼šè¿œè¿œå¤§äºå†™æ“ä½œã€‚ç”±äºè¯»æ“ä½œæ ¹æœ¬ä¸ä¼šä¿®æ”¹åŸæœ‰çš„æ•°æ®ï¼Œå› æ­¤å¯¹äºæ¯æ¬¡è¯»å–éƒ½è¿›è¡ŒåŠ é”å…¶å®æ˜¯ä¸€ç§èµ„æºæµªè´¹ã€‚æˆ‘ä»¬åº”è¯¥å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®Listçš„å†…éƒ¨æ•°æ®ï¼Œæ¯•ç«Ÿè¯»å–æ“ä½œæ˜¯å®‰å…¨çš„ã€‚</p><p>ReentrantReadWriteLock è¯»å†™é”çš„æ€æƒ³éå¸¸ç±»ä¼¼ï¼Œä¹Ÿå°±æ˜¯è¯»è¯»å…±äº«ã€å†™å†™äº’æ–¥ã€è¯»å†™äº’æ–¥ã€å†™è¯»äº’æ–¥ã€‚JDKä¸­æä¾›äº† CopyOnWriteArrayList ç±»æ¯”ç›¸æ¯”äºåœ¨è¯»å†™é”çš„æ€æƒ³åˆæ›´è¿›ä¸€æ­¥ã€‚ä¸ºäº†å°†è¯»å–çš„æ€§èƒ½å‘æŒ¥åˆ°æè‡´ï¼ŒCopyOnWriteArrayList è¯»å–æ˜¯å®Œå…¨ä¸ç”¨åŠ é”çš„ï¼Œå¹¶ä¸”æ›´å‰å®³çš„æ˜¯ï¼šå†™å…¥ä¹Ÿä¸ä¼šé˜»å¡è¯»å–æ“ä½œã€‚åªæœ‰å†™å…¥å’Œå†™å…¥ä¹‹é—´éœ€è¦è¿›è¡ŒåŒæ­¥ç­‰å¾…ã€‚</p><h3 id="è¯»å–æ“ä½œå®ç°" tabindex="-1"><a class="header-anchor" href="#è¯»å–æ“ä½œå®ç°" aria-hidden="true">#</a> è¯»å–æ“ä½œå®ç°</h3><p>è¯»å–æ“ä½œæ²¡æœ‰ä»»ä½•åŒæ­¥æ§åˆ¶å’Œé”æ“ä½œï¼Œç†ç”±å°±æ˜¯å†…éƒ¨æ•°ç»„ array ä¸ä¼šå‘ç”Ÿä¿®æ”¹ï¼Œåªä¼šè¢«å¦å¤–ä¸€ä¸ª array æ›¿æ¢ï¼Œå› æ­¤å¯ä»¥ä¿è¯æ•°æ®å®‰å…¨ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token doc-comment comment">/** The array, accessed only via getArray/setArray. */</span>
    <span class="token keyword">private</span> <span class="token keyword">transient</span> <span class="token keyword">volatile</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> array<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">E</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token function">getArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">&quot;unchecked&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">E</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">E</span><span class="token punctuation">)</span> a<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">final</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> array<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="å†™å…¥æ“ä½œå®ç°" tabindex="-1"><a class="header-anchor" href="#å†™å…¥æ“ä½œå®ç°" aria-hidden="true">#</a> å†™å…¥æ“ä½œå®ç°</h3><p>CopyOnWriteArrayList å†™å…¥æ“ä½œ add() æ–¹æ³•åœ¨æ·»åŠ é›†åˆçš„æ—¶å€™åŠ äº†é”ï¼Œä¿è¯äº†åŒæ­¥ï¼Œé¿å…äº†å¤šçº¿ç¨‹å†™çš„æ—¶å€™ä¼š copy å‡ºå¤šä¸ªå‰¯æœ¬å‡ºæ¥ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token doc-comment comment">/**
     * Appends the specified element to the end of this list.
     *
     * <span class="token keyword">@param</span> <span class="token parameter">e</span> element to be appended to this list
     * <span class="token keyword">@return</span> <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java"><span class="token boolean">true</span></span></span><span class="token punctuation">}</span> (as specified by <span class="token punctuation">{</span><span class="token keyword">@link</span> <span class="token reference"><span class="token class-name">Collection</span><span class="token punctuation">#</span><span class="token field">add</span></span><span class="token punctuation">}</span>)
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">E</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">final</span> <span class="token class-name">ReentrantLock</span> lock <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lock<span class="token punctuation">;</span>
        lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åŠ é”</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> elements <span class="token operator">=</span> <span class="token function">getArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> len <span class="token operator">=</span> elements<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
            <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> newElements <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>elements<span class="token punctuation">,</span> len <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ‹·è´æ–°æ•°ç»„</span>
            newElements<span class="token punctuation">[</span>len<span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>
            <span class="token function">setArray</span><span class="token punctuation">(</span>newElements<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//é‡Šæ”¾é”</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="concurrentlinkedqueue" tabindex="-1"><a class="header-anchor" href="#concurrentlinkedqueue" aria-hidden="true">#</a> ConcurrentLinkedQueue</h2><p>Javaæä¾›çš„çº¿ç¨‹å®‰å…¨çš„ Queue å¯ä»¥åˆ†ä¸ºé˜»å¡é˜Ÿåˆ—å’Œéé˜»å¡é˜Ÿåˆ—ï¼Œå…¶ä¸­é˜»å¡é˜Ÿåˆ—çš„å…¸å‹ä¾‹å­æ˜¯ BlockingQueueï¼Œéé˜»å¡é˜Ÿåˆ—çš„å…¸å‹ä¾‹å­æ˜¯ConcurrentLinkedQueueï¼Œåœ¨å®é™…åº”ç”¨ä¸­è¦æ ¹æ®å®é™…éœ€è¦é€‰ç”¨é˜»å¡é˜Ÿåˆ—æˆ–è€…éé˜»å¡é˜Ÿåˆ—ã€‚ é˜»å¡é˜Ÿåˆ—å¯ä»¥é€šè¿‡åŠ é”æ¥å®ç°ï¼Œéé˜»å¡é˜Ÿåˆ—å¯ä»¥é€šè¿‡ CAS æ“ä½œå®ç°ã€‚</p><p>ConcurrentLinkedQueueæ˜¯ä¸€ä¸ªåŸºäºé“¾æ¥èŠ‚ç‚¹çš„æ— ç•Œçº¿ç¨‹å®‰å…¨é˜Ÿåˆ—ï¼Œå®ƒé‡‡ç”¨å…ˆè¿›å…ˆå‡ºçš„è§„åˆ™å¯¹èŠ‚ç‚¹è¿›è¡Œæ’åºï¼Œå½“æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œå®ƒä¼šæ·»åŠ åˆ°é˜Ÿåˆ—çš„å°¾éƒ¨ï¼›å½“æˆ‘ä»¬è·å–ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œå®ƒä¼šè¿”å›é˜Ÿåˆ—å¤´éƒ¨çš„å…ƒç´ ã€‚å®ƒé‡‡ç”¨äº†â€œwait-freeâ€ç®—æ³•(å³CASç®—æ³•)æ¥å®ç°ã€‚</p><p><strong>ConcurrentLinkedQueueçš„ç»“æ„</strong>ï¼š ConcurrentLinkedQueueç”±headèŠ‚ç‚¹å’ŒtailèŠ‚ç‚¹ç»„æˆï¼Œæ¯ä¸ªèŠ‚ç‚¹(Node)ç”±èŠ‚ç‚¹å…ƒç´ (item)å’ŒæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹(next)çš„å¼•ç”¨ç»„æˆï¼ŒèŠ‚ç‚¹ä¸èŠ‚ç‚¹ä¹‹é—´å°±æ˜¯é€šè¿‡è¿™ä¸ªnextå…³è”èµ·æ¥ï¼Œä»è€Œç»„æˆä¸€å¼ é“¾è¡¨ç»“æ„çš„é˜Ÿåˆ—ã€‚</p><p>ConcurrentLinkedQueue é€‚åˆåœ¨å¯¹æ€§èƒ½è¦æ±‚ç›¸å¯¹è¾ƒé«˜ï¼ŒåŒæ—¶å¯¹é˜Ÿåˆ—çš„è¯»å†™å­˜åœ¨å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿›è¡Œçš„åœºæ™¯ï¼Œå³å¦‚æœå¯¹é˜Ÿåˆ—åŠ é”çš„æˆæœ¬è¾ƒé«˜åˆ™é€‚åˆä½¿ç”¨æ— é”çš„ConcurrentLinkedQueueæ¥æ›¿ä»£ã€‚</p><h2 id="blockingqueue" tabindex="-1"><a class="header-anchor" href="#blockingqueue" aria-hidden="true">#</a> BlockingQueue</h2><p>é˜»å¡é˜Ÿåˆ—(BlockingQueue)æ˜¯ä¸€ä¸ªæ”¯æŒä¸¤ä¸ªé™„åŠ æ“ä½œçš„é˜Ÿåˆ—ã€‚è¿™ä¸¤ä¸ªé™„åŠ çš„æ“ä½œæ”¯æŒé˜»å¡çš„æ’å…¥å’Œç§»é™¤æ–¹æ³•ã€‚</p><ul><li>æ”¯æŒé˜»å¡çš„æ’å…¥æ–¹æ³•ï¼šå½“é˜Ÿåˆ—æ»¡æ—¶ï¼Œé˜Ÿåˆ—ä¼šé˜»å¡æ’å…¥å…ƒç´ çš„çº¿ç¨‹ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸æ»¡ã€‚</li><li>æ”¯æŒé˜»å¡çš„ç§»é™¤æ–¹æ³•ï¼šå½“é˜Ÿåˆ—ç©ºæ—¶ï¼Œè·å–å…ƒç´ çš„çº¿ç¨‹ä¼šç­‰å¾…é˜Ÿåˆ—å˜ä¸ºéç©ºã€‚</li></ul><p>æ’å…¥å’Œç§»é™¤æ“ä½œçš„4ç§å¤„ç†æ–¹å¼</p><table><thead><tr><th>æ–¹æ³•/å¤„ç†æ–¹å¼</th><th>æŠ›å‡ºå¼‚å¸¸</th><th>è¿”å›ç‰¹æ®Šå€¼</th><th>ä¸€ç›´é˜»å¡</th><th>è¶…æ—¶é€€å‡º</th></tr></thead><tbody><tr><td>æ’å…¥æ–¹æ³•</td><td>add(e)</td><td>offer(e)</td><td>put(e)</td><td>offer(e, time, unit)</td></tr><tr><td>ç§»é™¤æ–¹æ³•</td><td>remove()</td><td>poll()</td><td>take()</td><td>poll(time, unit)</td></tr><tr><td>æ£€æŸ¥æ–¹æ³•</td><td>element()</td><td>peek()</td><td>ä¸å¯ç”¨</td><td>ä¸å¯ç”¨</td></tr></tbody></table><ul><li>æŠ›å‡ºå¼‚å¸¸ï¼šå½“é˜Ÿåˆ—æ»¡æ—¶ï¼Œå¦‚æœå†å¾€é˜Ÿåˆ—é‡Œæ’å…¥å…ƒç´ ä¼šæŠ›å‡ºIllegalStateException(&quot;Queue full&quot;)å¼‚å¸¸ã€‚å½“é˜Ÿåˆ—ç©ºæ—¶ï¼Œä»é˜Ÿåˆ—é‡Œè·å–å…ƒç´ ä¼šæŠ›å‡ºNoSuchElementExceptionå¼‚å¸¸ã€‚</li><li>è¿”å›ç‰¹æ®Šå€¼ï¼šå½“å¾€é˜Ÿåˆ—æ’å…¥å…ƒç´ æ—¶ï¼Œä¼šè¿”å›å…ƒç´ æ˜¯å¦æ’å…¥æˆåŠŸï¼ŒæˆåŠŸè¿”å›trueã€‚å¦‚æœæ˜¯ç§»é™¤æ–¹æ³•ï¼Œåˆ™ä»é˜Ÿåˆ—é‡Œå–å‡ºä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœæ²¡æœ‰åˆ™è¿”å›nullã€‚</li><li>ä¸€ç›´é˜»å¡ï¼šå½“é˜»å¡é˜Ÿåˆ—æ»¡æ—¶ï¼Œå¦‚æœç”Ÿäº§è€…çº¿ç¨‹å¾€é˜Ÿåˆ—é‡Œputå…ƒç´ ï¼Œé˜Ÿåˆ—ä¼šä¸€ç›´é˜»å¡ç”Ÿäº§è€…çº¿ç¨‹ï¼Œç›´åˆ°é˜Ÿåˆ—å¯ç”¨æˆ–è€…å“åº”ä¸­æ–­é€€å‡ºã€‚å½“é˜Ÿåˆ—ç©ºæ—¶ï¼Œå¦‚æœæ¶ˆè´¹è€…çº¿ç¨‹ä»é˜Ÿåˆ—åˆ—takeå…ƒç´ ï¼Œé˜Ÿåˆ—ä¼šé˜»å¡æ¶ˆè´¹è€…çº¿ç¨‹ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸ä¸ºç©ºã€‚</li><li>è¶…æ—¶é€€å‡ºï¼šå½“é˜»å¡é˜Ÿåˆ—æ»¡æ—¶ï¼Œå¦‚æœç”Ÿäº§è€…çº¿ç¨‹å¾€é˜Ÿåˆ—é‡Œæ’å…¥å…ƒç´ ï¼Œé˜Ÿåˆ—ä¼šé˜»å¡ç”Ÿäº§è€…çº¿ç¨‹ä¸€æ®µæ—¶é—´ï¼Œå¦‚æœè¶…æ—¶åˆ™é€€å‡ºã€‚</li></ul><p>å¦‚æœæ˜¯æ— ç•Œé˜»å¡é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—ä¸å¯èƒ½ä¼šå‡ºç°æ»¡çš„æƒ…å†µï¼Œæ‰€ä»¥ä½¿ç”¨putæˆ–offeræ–¹æ³•æ°¸è¿œä¸ä¼šè¢«é˜»å¡ï¼Œè€Œä¸”ä½¿ç”¨offeræ–¹æ³•æ—¶ï¼Œè¯¥æ–¹æ³•æ°¸è¿œè¿”å›true</p><h3 id="javaé‡Œçš„blockingqueue" tabindex="-1"><a class="header-anchor" href="#javaé‡Œçš„blockingqueue" aria-hidden="true">#</a> Javaé‡Œçš„BlockingQueue</h3><ul><li>ArrayBlockingQueueï¼šç”¨æ•°ç»„å®ç°çš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ï¼ŒæŒ‰FIFOåŸåˆ™å¯¹å…ƒç´ è¿›è¡Œæ’åºã€‚ <ul><li>ä¸€æ—¦åˆ›å»ºï¼Œå®¹é‡ä¸èƒ½æ”¹å˜</li><li>å¹¶å‘æ§åˆ¶é‡‡ç”¨å¯é‡å…¥é”æ¥æ§åˆ¶ï¼Œä¸ç®¡æ˜¯æ’å…¥æ“ä½œè¿˜æ˜¯è¯»å–æ“ä½œï¼Œéƒ½éœ€è¦è·å–åˆ°é”æ‰èƒ½è¿›è¡Œæ“ä½œ</li><li>é»˜è®¤æƒ…å†µä¸‹ä¸èƒ½ä¿è¯çº¿ç¨‹è®¿é—®é˜Ÿåˆ—çš„å…¬å¹³æ€§,(æ‰€è°“å…¬å¹³æ€§æ˜¯æŒ‡ä¸¥æ ¼æŒ‰ç…§çº¿ç¨‹ç­‰å¾…çš„ç»å¯¹æ—¶é—´é¡ºåºï¼Œå³æœ€å…ˆç­‰å¾…çš„çº¿ç¨‹èƒ½å¤Ÿæœ€å…ˆè®¿é—®åˆ° ArrayBlockingQueueã€‚)ä¸ºäº†ä¿è¯å…¬å¹³æ€§ï¼Œé€šå¸¸ä¼šé™ä½ååé‡</li></ul></li><li>LinkedBlockingQueueï¼šç”¨<strong>å•å‘é“¾è¡¨</strong>å®ç°çš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ï¼Œé»˜è®¤å’Œæœ€å¤§é•¿åº¦ä¸ºInteger.MAX_VALUEï¼ŒæŒ‰FIFOåŸåˆ™å¯¹å…ƒç´ è¿›è¡Œæ’åºã€‚ <ul><li>ä¸ArrayBlockingQueue ç›¸æ¯”èµ·æ¥å…·æœ‰æ›´é«˜çš„ååé‡ï¼Œä¸ºäº†é˜²æ­¢ LinkedBlockingQueue å®¹é‡è¿…é€Ÿå¢ï¼ŒæŸè€—å¤§é‡å†…å­˜ã€‚é€šå¸¸åœ¨åˆ›å»ºLinkedBlockingQueue å¯¹è±¡æ—¶ï¼Œä¼šæŒ‡å®šå…¶å¤§å°ï¼Œå¦‚æœæœªæŒ‡å®šï¼Œå®¹é‡ç­‰äºInteger.MAX_VALUEã€‚</li></ul></li><li>PriorityBlockingQueueï¼šæ”¯æŒä¼˜å…ˆçº§çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ï¼Œé»˜è®¤æƒ…å†µä¸‹å…ƒç´ é‡‡å–è‡ªç„¶é¡ºåºå‡åºæ’åˆ—ã€‚ä¸ä¿è¯åŒä¼˜å…ˆçº§å…ƒç´ çš„é¡ºåºã€‚ <ul><li>å¹¶å‘æ§åˆ¶é‡‡ç”¨çš„æ˜¯ ReentrantLock</li><li>åªèƒ½æŒ‡å®šåˆå§‹çš„é˜Ÿåˆ—å¤§å°ï¼Œåé¢æ’å…¥å…ƒç´ çš„æ—¶å€™ï¼Œå¦‚æœç©ºé—´ä¸å¤Ÿçš„è¯ä¼šè‡ªåŠ¨æ‰©å®¹)</li><li>PriorityQueue çš„çº¿ç¨‹å®‰å…¨ç‰ˆæœ¬ã€‚ä¸å¯ä»¥æ’å…¥ null å€¼ï¼ŒåŒæ—¶ï¼Œæ’å…¥é˜Ÿåˆ—çš„å¯¹è±¡å¿…é¡»æ˜¯å¯æ¯”è¾ƒå¤§å°çš„(comparable)ï¼Œå¦åˆ™æŠ¥ ClassCastException å¼‚å¸¸</li><li>å®ƒçš„æ’å…¥æ“ä½œ put æ–¹æ³•ä¸ä¼š blockï¼Œå› ä¸ºå®ƒæ˜¯æ— ç•Œé˜Ÿåˆ—(take æ–¹æ³•åœ¨é˜Ÿåˆ—ä¸ºç©ºçš„æ—¶å€™ä¼šé˜»å¡)</li></ul></li><li>DelayQueueï¼šæ”¯æŒå»¶æ—¶è·å–å…ƒç´ çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚é˜Ÿåˆ—ä½¿ç”¨PriorityQueueå®ç°ï¼Œé˜Ÿåˆ—ä¸­çš„å…ƒç´ å¿…é¡»å®ç°Delayedæ¥å£ï¼Œåœ¨åˆ›å»ºå…ƒç´ æ—¶å¯ä»¥æŒ‡å®šå¤šä¹…æ‰èƒ½ä»é˜Ÿåˆ—ä¸­è·å–å½“å‰å…ƒç´ ã€‚åªæœ‰åœ¨å»¶è¿ŸæœŸæ»¡æ—¶æ‰èƒ½ä»é˜Ÿåˆ—ä¸­æå–å…ƒç´ ã€‚å¯åº”ç”¨äºï¼š <ul><li>ç¼“å­˜ç³»ç»Ÿçš„è®¾è®¡ï¼šç”¨DelayQueueä¿å­˜ç¼“å­˜å…ƒç´ çš„æœ‰æ•ˆæœŸï¼Œä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹å¾ªç¯æŸ¥è¯¢DelayQueueï¼Œä¸€æ—¦èƒ½ä»DelayQueueä¸­è·å–å…ƒç´ è¡¨ç¤ºç¼“å­˜æœ‰æ•ˆæœŸåˆ°äº†ã€‚</li><li>å®šæ—¶ä»»åŠ¡è°ƒåº¦ï¼šä½¿ç”¨DelayQueueä¿å­˜å½“å¤©å°†ä¼šæ‰§è¡Œçš„ä»»åŠ¡å’Œæ‰§è¡Œæ—¶é—´ï¼Œä¸€æ—¦ä»DelayQueueä¸­è·å–åˆ°ä»»åŠ¡å°±å¼€å§‹æ‰§è¡Œï¼Œæ¯”å¦‚TimerQueueå°±æ˜¯ä½¿ç”¨DelayQueueå®ç°çš„ã€‚</li></ul></li><li>SynchronousQueueï¼šä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡é˜Ÿåˆ—ã€‚æ¯ä¸€ä¸ªputæ“ä½œå¿…é¡»ç­‰å¾…ä¸€ä¸ªtakeæ“ä½œï¼Œå¦åˆ™ä¸èƒ½ç»§ç»­æ·»åŠ å…ƒç´ ã€‚</li><li>LinkedTransferQueueï¼šé“¾è¡¨ç»“æ„ç»„æˆçš„æ— ç•Œé˜»å¡TransferQueueé˜Ÿåˆ—ã€‚ç›¸å¯¹äºå…¶ä»–é˜»å¡é˜Ÿåˆ—ï¼ŒLinkedTransferQueueå¤šäº†tryTransferå’Œtransferæ–¹æ³•ã€‚ <ul><li>transferæ–¹æ³•ï¼šå¦‚æœå½“å‰æœ‰æ¶ˆè´¹è€…æ­£åœ¨ç­‰å¾…æ¥æ”¶å…ƒç´ ï¼Œtransferæ–¹æ³•å¯ä»¥æŠŠç”Ÿäº§è€…ä¼ å…¥çš„å…ƒç´ ç«‹åˆ»ä¼ ç»™æ¶ˆè´¹è€…ã€‚å¦‚æœæ²¡æœ‰æ¶ˆè´¹è€…åœ¨ç­‰å¾…æ¥æ”¶å…ƒç´ ï¼Œåˆ™å°†å…ƒç´ å­˜æ”¾åœ¨é˜Ÿåˆ—tailèŠ‚ç‚¹å¹¶ç­‰åˆ°é’™å…ƒç´ è¢«æ¶ˆè´¹è€…æ¶ˆè´¹äº†æ‰è¿”å›ã€‚</li><li>tryTransferæ–¹æ³•ï¼šå¦‚æœæ²¡æœ‰æ¶ˆè´¹è€…ç­‰å¾…æ¥æ”¶å…ƒç´ ï¼Œåˆ™ç«‹å³è¿”å›falseã€‚</li></ul></li><li>LinkedBlockingDequeï¼šé“¾è¡¨ç»“æ„ç»„æˆçš„åŒå‘é˜»å¡é˜Ÿåˆ—ã€‚</li></ul><h3 id="blockingqueueå®ç°åŸç†" tabindex="-1"><a class="header-anchor" href="#blockingqueueå®ç°åŸç†" aria-hidden="true">#</a> BlockingQueueå®ç°åŸç†</h3><p>ä½¿ç”¨é€šçŸ¥æ¨¡å¼å®ç°ã€‚æ‰€è°“é€šçŸ¥æ¨¡å¼ï¼Œå°±æ˜¯å½“ç”Ÿäº§è€…å¾€æ»¡çš„é˜Ÿåˆ—é‡Œæ·»åŠ å…ƒç´ æ—¶ä¼šé˜»å¡ä½ç”Ÿäº§è€…ï¼Œå½“æ¶ˆè´¹è€…æ¶ˆè´¹äº†ä¸€ä¸ªé˜Ÿåˆ—ä¸­çš„å…ƒç´ åï¼Œä¼šé€šçŸ¥ç”Ÿäº§è€…å½“å‰é˜Ÿåˆ—å¯ç”¨ã€‚</p><h2 id="concurrentskiplistmap" tabindex="-1"><a class="header-anchor" href="#concurrentskiplistmap" aria-hidden="true">#</a> ConcurrentSkipListMap</h2><p><strong>è·³è¡¨</strong></p><p>å¯¹äºä¸€ä¸ªå•é“¾è¡¨ï¼Œå³ä½¿é“¾è¡¨æ˜¯æœ‰åºçš„ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨å…¶ä¸­æŸ¥æ‰¾æŸä¸ªæ•°æ®ï¼Œä¹Ÿåªèƒ½ä»å¤´åˆ°å°¾éå†é“¾è¡¨ï¼Œè¿™æ ·æ•ˆç‡è‡ªç„¶å°±ä¼šå¾ˆä½ï¼Œè·³è¡¨å°±ä¸ä¸€æ ·äº†ã€‚è·³è¡¨æ˜¯ä¸€ç§å¯ä»¥ç”¨æ¥å¿«é€ŸæŸ¥æ‰¾çš„æ•°æ®ç»“æ„ï¼Œæœ‰ç‚¹ç±»ä¼¼äºå¹³è¡¡æ ‘ã€‚å®ƒä»¬éƒ½å¯ä»¥å¯¹å…ƒç´ è¿›è¡Œå¿«é€Ÿçš„æŸ¥æ‰¾ã€‚ä½†ä¸€ä¸ªé‡è¦çš„åŒºåˆ«æ˜¯ï¼šå¯¹å¹³è¡¡æ ‘çš„æ’å…¥å’Œåˆ é™¤å¾€å¾€å¾ˆå¯èƒ½å¯¼è‡´å¹³è¡¡æ ‘è¿›è¡Œä¸€æ¬¡å…¨å±€çš„è°ƒæ•´ã€‚è€Œå¯¹è·³è¡¨çš„æ’å…¥å’Œåˆ é™¤åªéœ€è¦å¯¹æ•´ä¸ªæ•°æ®ç»“æ„çš„å±€éƒ¨è¿›è¡Œæ“ä½œå³å¯ã€‚è¿™æ ·å¸¦æ¥çš„å¥½å¤„æ˜¯ï¼šåœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œä½ ä¼šéœ€è¦ä¸€ä¸ªå…¨å±€é”æ¥ä¿è¯æ•´ä¸ªå¹³è¡¡æ ‘çš„çº¿ç¨‹å®‰å…¨ã€‚è€Œå¯¹äºè·³è¡¨ï¼Œä½ åªéœ€è¦éƒ¨åˆ†é”å³å¯ã€‚è¿™æ ·ï¼Œåœ¨é«˜å¹¶å‘ç¯å¢ƒä¸‹ï¼Œä½ å°±å¯ä»¥æ‹¥æœ‰æ›´å¥½çš„æ€§èƒ½ã€‚è€Œå°±æŸ¥è¯¢çš„æ€§èƒ½è€Œè¨€ï¼Œè·³è¡¨çš„æ—¶é—´å¤æ‚åº¦ä¹Ÿæ˜¯ O(logn) æ‰€ä»¥åœ¨å¹¶å‘æ•°æ®ç»“æ„ä¸­ï¼ŒJDK ä½¿ç”¨è·³è¡¨æ¥å®ç°ä¸€ä¸ª Mapã€‚</p><p>è·³è¡¨çš„æœ¬è´¨æ˜¯åŒæ—¶ç»´æŠ¤äº†å¤šä¸ªé“¾è¡¨ï¼Œå¹¶ä¸”é“¾è¡¨æ˜¯åˆ†å±‚çš„ï¼Œ</p><div align="center"><p><img src="/cs-way/assets/è·³è¡¨ç»“æ„.fe2e8eaf.png" alt="" title=":size=500" loading="lazy"></p></div><p>æœ€ä½å±‚çš„é“¾è¡¨ç»´æŠ¤äº†è·³è¡¨å†…æ‰€æœ‰çš„å…ƒç´ ï¼Œæ¯ä¸Šé¢ä¸€å±‚é“¾è¡¨éƒ½æ˜¯ä¸‹é¢ä¸€å±‚çš„å­é›†ã€‚</p><p>è·³è¡¨å†…çš„æ‰€æœ‰é“¾è¡¨çš„å…ƒç´ éƒ½æ˜¯æ’åºçš„ã€‚æŸ¥æ‰¾æ—¶ï¼Œå¯ä»¥ä»é¡¶çº§é“¾è¡¨å¼€å§‹æ‰¾ã€‚ä¸€æ—¦å‘ç°è¢«æŸ¥æ‰¾çš„å…ƒç´ å¤§äºå½“å‰é“¾è¡¨ä¸­çš„å–å€¼ï¼Œå°±ä¼šè½¬å…¥ä¸‹ä¸€å±‚é“¾è¡¨ç»§ç»­æ‰¾ã€‚è¿™ä¹Ÿå°±æ˜¯è¯´åœ¨æŸ¥æ‰¾è¿‡ç¨‹ä¸­ï¼Œæœç´¢æ˜¯è·³è·ƒå¼çš„ã€‚</p><div align="center"><p><img src="/cs-way/assets/è·³è¡¨æŸ¥æ‰¾.0115b9bd.png" alt="" title=":size=500" loading="lazy"></p></div><p>æŸ¥æ‰¾18 çš„æ—¶å€™åŸæ¥éœ€è¦éå† 18 æ¬¡ï¼Œç°åœ¨åªéœ€è¦ 7 æ¬¡å³å¯ã€‚é’ˆå¯¹é“¾è¡¨é•¿åº¦æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œæ„å»ºç´¢å¼•æŸ¥æ‰¾æ•ˆç‡çš„æå‡å°±ä¼šéå¸¸æ˜æ˜¾ã€‚</p><p>ä»ä¸Šé¢å¾ˆå®¹æ˜“çœ‹å‡ºï¼Œè·³è¡¨æ˜¯ä¸€ç§åˆ©ç”¨ç©ºé—´æ¢æ—¶é—´çš„ç®—æ³•ã€‚</p><p>ä½¿ç”¨è·³è¡¨å®ç°Map å’Œä½¿ç”¨å“ˆå¸Œç®—æ³•å®ç°Mapçš„å¦å¤–ä¸€ä¸ªä¸åŒä¹‹å¤„æ˜¯ï¼šå“ˆå¸Œå¹¶ä¸ä¼šä¿å­˜å…ƒç´ çš„é¡ºåºï¼Œè€Œè·³è¡¨å†…æ‰€æœ‰çš„å…ƒç´ éƒ½æ˜¯æ’åºçš„ã€‚å› æ­¤åœ¨å¯¹è·³è¡¨è¿›è¡Œéå†æ—¶ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ªæœ‰åºçš„ç»“æœã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ çš„åº”ç”¨éœ€è¦æœ‰åºæ€§ï¼Œé‚£ä¹ˆè·³è¡¨å°±æ˜¯ä½ ä¸äºŒçš„é€‰æ‹©ã€‚JDK ä¸­å®ç°è¿™ä¸€æ•°æ®ç»“æ„çš„ç±»æ˜¯ConcurrentSkipListMapã€‚</p><h1 id="åã€çº¿ç¨‹æ± å’Œexecutoræ¡†æ¶" tabindex="-1"><a class="header-anchor" href="#åã€çº¿ç¨‹æ± å’Œexecutoræ¡†æ¶" aria-hidden="true">#</a> åã€çº¿ç¨‹æ± å’ŒExecutoræ¡†æ¶</h1><h2 id="çº¿ç¨‹æ± " tabindex="-1"><a class="header-anchor" href="#çº¿ç¨‹æ± " aria-hidden="true">#</a> çº¿ç¨‹æ± </h2><blockquote><p>æ± åŒ–æŠ€æœ¯æƒ³å¿…å¤§å®¶å·²ç»å±¡è§ä¸é²œäº†ï¼Œçº¿ç¨‹æ± ã€æ•°æ®åº“è¿æ¥æ± ã€Http è¿æ¥æ± ç­‰ç­‰éƒ½æ˜¯å¯¹è¿™ä¸ªæ€æƒ³çš„åº”ç”¨ã€‚æ± åŒ–æŠ€æœ¯çš„æ€æƒ³ä¸»è¦æ˜¯ä¸ºäº†å‡å°‘æ¯æ¬¡è·å–èµ„æºçš„æ¶ˆè€—ï¼Œæé«˜å¯¹èµ„æºçš„åˆ©ç”¨ç‡ã€‚</p></blockquote><p>Javaä¸­çš„çº¿ç¨‹æ± æ˜¯è¿ç”¨åœºæ™¯æœ€å¤šçš„å¹¶å‘æ¡†æ¶ï¼Œå‡ ä¹æ‰€æœ‰éœ€è¦å¼‚æ­¥æˆ–å¹¶å‘æ‰§è¡Œä»»åŠ¡çš„ç¨‹åºéƒ½å¯ä»¥ä½¿ç”¨çº¿ç¨‹æ± ã€‚</p><p>åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œåˆç†åœ°ä½¿ç”¨çº¿ç¨‹æ± èƒ½å¤Ÿå¸¦æ¥3ä¸ªå¥½å¤„:</p><ul><li>é™ä½èµ„æºæ¶ˆè€—ã€‚é€šè¿‡é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹é™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—ã€‚</li><li>æé«˜å“åº”é€Ÿåº¦ã€‚å½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œã€‚</li><li>æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§ã€‚çº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œå¦‚æœæ— é™åˆ¶åœ°åˆ›å»ºï¼Œä¸ä»…ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œè¿˜ä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€åˆ†é…ã€è°ƒä¼˜å’Œç›‘æ§ã€‚ä½†æ˜¯ï¼Œè¦åšåˆ°åˆç†åˆ©ç”¨çº¿ç¨‹æ± ï¼Œå¿…é¡»å¯¹å…¶å®ç°åŸç†äº†å¦‚æŒ‡æŒã€‚</li></ul><h3 id="å®ç°åŸç†" tabindex="-1"><a class="header-anchor" href="#å®ç°åŸç†" aria-hidden="true">#</a> å®ç°åŸç†</h3><p>å½“æäº¤ä¸€ä¸ªæ–°ä»»åŠ¡åˆ°çº¿ç¨‹æ± æ—¶ï¼Œçº¿ç¨‹æ± çš„å¤„ç†æµç¨‹å¦‚ä¸‹ã€‚</p><ol><li>çº¿ç¨‹æ± åˆ¤æ–­æ ¸å¿ƒçº¿ç¨‹æ± é‡Œçš„çº¿ç¨‹æ˜¯å¦éƒ½åœ¨æ‰§è¡Œä»»åŠ¡ã€‚å¦‚æœä¸æ˜¯ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ã€‚å¦‚æœæ ¸å¿ƒçº¿ç¨‹æ± é‡Œçš„çº¿ç¨‹éƒ½åœ¨æ‰§è¡Œä»»åŠ¡ï¼Œåˆ™è¿›å…¥ä¸‹ä¸ªæµç¨‹ã€‚</li><li>çº¿ç¨‹æ± åˆ¤æ–­å·¥ä½œé˜Ÿåˆ—æ˜¯å¦å·²ç»æ»¡ã€‚å¦‚æœå·¥ä½œé˜Ÿåˆ—æ²¡æœ‰æ»¡ï¼Œåˆ™å°†æ–°æäº¤çš„ä»»åŠ¡å­˜å‚¨åœ¨è¿™ä¸ªå·¥ä½œé˜Ÿåˆ—é‡Œã€‚å¦‚æœå·¥ä½œé˜Ÿåˆ—æ»¡äº†ï¼Œåˆ™è¿›å…¥ä¸‹ä¸ªæµç¨‹ã€‚</li><li>çº¿ç¨‹æ± åˆ¤æ–­çº¿ç¨‹æ± çš„çº¿ç¨‹æ˜¯å¦éƒ½å¤„äºå·¥ä½œçŠ¶æ€ã€‚å¦‚æœæ²¡æœ‰ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ã€‚å¦‚æœå·²ç»æ»¡äº†ï¼Œåˆ™äº¤ç»™é¥±å’Œç­–ç•¥æ¥å¤„ç†è¿™ä¸ªä»»åŠ¡</li></ol><p>çº¿ç¨‹æ± çš„ä¸»è¦å¤„ç†æµç¨‹å¦‚å›¾</p><div align="center"><p><img src="/cs-way/assets/çº¿ç¨‹æ± çš„ä¸»è¦å¤„ç†æµç¨‹.28847541.png" alt="" title=":size=500" loading="lazy"></p></div><p>ThreadPoolExecutoræ‰§è¡Œexecuteæ–¹æ³•åˆ†ä¸‹é¢4ç§æƒ…å†µï¼š</p><ol><li>å¦‚æœå½“å‰è¿è¡Œçš„çº¿ç¨‹å°‘äºcorePoolSizeï¼Œåˆ™åˆ›å»ºæ–°çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡</li><li>å¦‚æœè¿è¡Œçš„çº¿ç¨‹ç­‰äºæˆ–å¤šäºcorePollSizeï¼Œåˆ™å°†ä»»åŠ¡åŠ å…¥BlockingQueue</li><li>å¦‚æœæ— æ³•å°†ä»»åŠ¡åŠ å…¥BlockingQueue(é˜Ÿåˆ—å·²æ»¡)ï¼Œåˆ™åˆ›å»ºæ–°çš„çº¿ç¨‹æ¥å¤„ç†ä»»åŠ¡</li><li>å¦‚æœåˆ›å»ºæ–°çº¿ç¨‹å°†å¯¼è‡´å½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°è¶…è¿‡maximumPoolSizeï¼Œä»»åŠ¡å°†è¢«æ‹’ç»ï¼Œå¹¶è°ƒç”¨RejectedExecutionHandler.rejectedExecution()æ–¹æ³•ã€‚</li></ol><p>ç¨‹æ± ä¸­çš„çº¿ç¨‹æ‰§è¡Œä»»åŠ¡åˆ†ä¸¤ç§æƒ…å†µï¼Œå¦‚ä¸‹ï¼š</p><ol><li>åœ¨execute()æ–¹æ³•ä¸­åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ—¶ï¼Œä¼šè®©è¿™ä¸ªçº¿ç¨‹æ‰§è¡Œå½“å‰ä»»åŠ¡ã€‚</li><li>è¿™ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œä¸€ä¸ªä»»åŠ¡åï¼Œä¼šåå¤ä»BlockingQueueè·å–ä»»åŠ¡æ¥æ‰§è¡Œã€‚</li></ol><h3 id="çº¿ç¨‹æ± çš„ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#çº¿ç¨‹æ± çš„ä½¿ç”¨" aria-hidden="true">#</a> çº¿ç¨‹æ± çš„ä½¿ç”¨</h3><p>é€šè¿‡ThreadPoolExecutoræ¥<strong>åˆ›å»º</strong>ä¸€ä¸ªçº¿ç¨‹æ± </p><div class="language-java ext-java"><pre class="language-java"><code>    <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span>corePoolSize<span class="token punctuation">,</span> maximumPoolSize<span class="token punctuation">,</span> keepAliveTime<span class="token punctuation">,</span> milliseconds<span class="token punctuation">,</span>runnableTaskQueue<span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol><li>corePoolSize(çº¿ç¨‹æ± çš„åŸºæœ¬å¤§å°)ï¼šå½“æäº¤ä¸€ä¸ªä»»åŠ¡åˆ°çº¿ç¨‹æ± æ—¶ï¼Œçº¿ç¨‹æ± ä¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œå³ä½¿å…¶ä»–ç©ºé—²çš„åŸºæœ¬çº¿ç¨‹èƒ½å¤Ÿæ‰§è¡Œæ–°ä»»åŠ¡ä¹Ÿä¼šåˆ›å»ºçº¿ç¨‹ï¼Œç›´åˆ°éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡æ•°å¤§äºçº¿ç¨‹æ± åŸºæœ¬å¤§å°ã€‚å¦‚æœè°ƒç”¨äº†çº¿ç¨‹prestartAllCoreThreads()æ–¹æ³•ï¼Œçº¿ç¨‹æ± ä¼šæå‰åˆ›å»ºå¹¶å¯åŠ¨æ‰€æœ‰åŸºæœ¬çº¿ç¨‹ã€‚</li><li>runnableTaskQueue(ä»»åŠ¡é˜Ÿåˆ—)ï¼šç”¨äºä¿å­˜ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡çš„é˜»å¡é˜Ÿåˆ—ã€‚å¯ä»¥é€‰æ‹©ArratBlockingQueue, LinkedBlockingQueue, SynchronousQueue, PriorityBlockingQueueã€‚</li><li>maximumPoolSize(çº¿ç¨‹æ± æœ€å¤§æ•°é‡)ï¼šçº¿ç¨‹æ± å…è®¸åˆ›å»ºçš„æœ€å¤§çº¿ç¨‹æ•°ã€‚</li><li>ThreadFactoryï¼šç”¨äºè®¾ç½®åˆ›å»ºçº¿ç¨‹çš„å·¥å‚ï¼Œå¯ä»¥é€šè¿‡çº¿ç¨‹å·¥å‚ç»™æ¯ä¸ªåˆ›å»ºå‡ºæ¥çš„çº¿ç¨‹è®¾ç½®æ›´æœ‰æ„ä¹‰çš„åå­—ã€‚</li><li>RejectedExecutionHandler(é¥±å’Œç­–ç•¥)ï¼šå½“é˜Ÿåˆ—å’Œçº¿ç¨‹æ± éƒ½æ»¡äº†ï¼Œè¯´æ˜çº¿ç¨‹æ± å¤„äºé¥±å’ŒçŠ¶æ€ï¼Œé‚£ä¹ˆå¿…é¡»é‡‡å–ä¸€ç§ç­–ç•¥å¤„ç†æäº¤çš„æ–°ä»»åŠ¡ã€‚è¿™ä¸ªç­–ç•¥é»˜è®¤æƒ…å†µä¸‹æ˜¯AbortPolicyï¼Œè¡¨ç¤ºæ— æ³•å¤„ç†æ–°ä»»åŠ¡æ—¶æŠ›å‡ºå¼‚å¸¸ã€‚ç­–ç•¥æœ‰ä¸‹åˆ—å‡ ç§ï¼š <ul><li>AbortPolicyï¼šç›´æ¥æŠ›å‡ºå¼‚å¸¸</li><li>CallerRunsPolicyï¼šåªç”¨è°ƒç”¨è€…æ‰€åœ¨çº¿ç¨‹æ¥è¿è¡Œä»»åŠ¡ã€‚</li><li>DiscardOldestPolicyï¼šä¸¢å¼ƒé˜Ÿåˆ—é‡Œæœ€è¿‘çš„ä¸€ä¸ªä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œå½“å‰ä»»åŠ¡ã€‚</li><li>DiscardPolicyï¼šä¸å¤„ç†ï¼Œä¸¢å¼ƒæ‰ã€‚</li><li>å…¶ä»–åº”ç”¨åœºæ™¯éœ€è¦å®ç°RejectedExecutionHandleræ¥å£è‡ªå®šä¹‰ã€‚</li></ul></li><li>keepAliveTime(çº¿ç¨‹æ´»åŠ¨ä¿æŒæ—¶é—´)ï¼šçº¿ç¨‹æ± çš„å·¥ä½œçº¿ç¨‹ç©ºé—²åï¼Œä¿æŒå­˜æ´»çš„æ—¶é—´ã€‚å¦‚æœä»»åŠ¡å¤šä¸”æ‰§è¡Œæ—¶é—´çŸ­ï¼Œå¯ä»¥è°ƒé«˜å­˜æ´»æ—¶é—´æé«˜çº¿ç¨‹åˆ©ç”¨ç‡ã€‚</li><li>TimeUnit(çº¿ç¨‹æ´»åŠ¨ä¿æŒæ—¶é—´çš„å•ä½)</li></ol><p>å‘çº¿ç¨‹æ± <strong>æäº¤ä»»åŠ¡</strong>æœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ul><li>execute(Runnable command)ï¼šæ–¹æ³•ç”¨äºæäº¤ä¸éœ€è¦è¿”å›å€¼çš„ä»»åŠ¡ï¼Œæ‰€ä»¥æ— æ³•åˆ¤æ–­ä»»åŠ¡æ˜¯å¦è¢«çº¿ç¨‹æ± æ‰§è¡ŒæˆåŠŸä¸å¦ï¼›</li><li>submit(Callable task)ï¼šæ–¹æ³•ç”¨äºæäº¤éœ€è¦è¿”å›å€¼çš„ä»»åŠ¡ã€‚çº¿ç¨‹æ± ä¼šè¿”å›ä¸€ä¸ª Future ç±»å‹çš„å¯¹è±¡ï¼Œé€šè¿‡è¿™ä¸ª Future å¯¹è±¡å¯ä»¥åˆ¤æ–­ä»»åŠ¡æ˜¯å¦æ‰§è¡ŒæˆåŠŸï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ Future çš„ get()æ–¹æ³•æ¥è·å–è¿”å›å€¼ï¼Œget()æ–¹æ³•ä¼šé˜»å¡å½“å‰çº¿ç¨‹ç›´åˆ°ä»»åŠ¡å®Œæˆï¼Œè€Œä½¿ç”¨ get(long timeoutï¼ŒTimeUnit unit)æ–¹æ³•åˆ™ä¼šé˜»å¡å½“å‰çº¿ç¨‹ä¸€æ®µæ—¶é—´åç«‹å³è¿”å›ï¼Œè¿™æ—¶å€™æœ‰å¯èƒ½ä»»åŠ¡æ²¡æœ‰æ‰§è¡Œå®Œã€‚</li></ul><p>çº¿ç¨‹æ± çš„<strong>å…³é—­</strong>æœ‰ä¸¤ç§æ–¹æ³•ï¼š</p><ul><li>shutdown()ï¼šå…³é—­çº¿ç¨‹æ± ï¼Œçº¿ç¨‹æ± çš„çŠ¶æ€å˜ä¸º SHUTDOWNã€‚çº¿ç¨‹æ± ä¸å†æ¥å—æ–°ä»»åŠ¡äº†ï¼Œä½†æ˜¯é˜Ÿåˆ—é‡Œçš„ä»»åŠ¡å¾—æ‰§è¡Œå®Œæ¯•ã€‚</li><li>shutdownNow()ï¼šå…³é—­çº¿ç¨‹æ± ï¼Œçº¿ç¨‹çš„çŠ¶æ€å˜ä¸º STOPã€‚çº¿ç¨‹æ± ä¼šç»ˆæ­¢å½“å‰æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡ï¼Œå¹¶åœæ­¢å¤„ç†æ’é˜Ÿçš„ä»»åŠ¡å¹¶è¿”å›æ­£åœ¨ç­‰å¾…æ‰§è¡Œçš„ Listã€‚</li></ul><p><strong>æŸ¥è¯¢å…³é—­</strong>çŠ¶æ€</p><ul><li>isShutDown å½“è°ƒç”¨ shutdown() æ–¹æ³•æˆ– shutdownNow() åè¿”å›ä¸º trueã€‚</li><li>isTerminated å½“è°ƒç”¨ shutdown() æ–¹æ³•åï¼Œå¹¶ä¸”æ‰€æœ‰æäº¤çš„ä»»åŠ¡å®Œæˆåè¿”å›ä¸º trueï¼›å½“ä¸”ä»…å½“æ‰€æœ‰ä»»åŠ¡éƒ½å…³é—­ï¼ŒCIAè¡¨ç¤ºçº¿ç¨‹æ± å…³é—­æˆåŠŸï¼Œè¿™æ˜¯isTerminaed()æ–¹æ³•æ‰ä¼šè¿”å›trueã€‚</li></ul><p><strong>åˆç†é…ç½®çº¿ç¨‹æ± </strong>(è®¾Nä¸ºCPUä¸ªæ•°)</p><ul><li>CPUå¯†é›†å‹ä»»åŠ¡ï¼Œåº”é…ç½®å°½å¯èƒ½å°‘çš„çº¿ç¨‹ï¼Œå¦‚N+1ã€‚</li><li>IOå¯†é›†å‹ä»»åŠ¡ï¼Œåº”é…ç½®å°½å¯èƒ½å¤šçš„çº¿ç¨‹ï¼Œå¦‚2Nã€‚</li><li>ä¼˜å…ˆçº§ä¸åŒçš„ä»»åŠ¡å¯ä»¥è€ƒè™‘ä½¿ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—priorityBlockingQueueæ¥å¤„ç†ï¼Œä½†ä¼˜å…ˆçº§ä½çš„ä»»åŠ¡å¯èƒ½æ°¸è¿œä¸è¢«æ‰§è¡Œã€‚</li><li>ä½¿ç”¨æœ‰ç•Œé˜Ÿåˆ—èƒ½å¢åŠ ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œé¢„è­¦æ€§ï¼Œé¿å…é˜Ÿåˆ—è¶Šæ¥è¶Šå¤šæ’‘æ»¡å†…å­˜ï¼Œå¯¼è‡´ç³»ç»Ÿä¸å¯ç”¨ã€‚</li></ul><p><strong>çº¿ç¨‹æ± çš„ç›‘æ§</strong>: ç›‘æ§çº¿ç¨‹æ± çš„æ—¶å€™å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å±æ€§ï¼š</p><ul><li>taskCountï¼šçº¿ç¨‹æ± éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡æ•°é‡ã€‚</li><li>completedTaskCountï¼šçº¿ç¨‹æ± åœ¨è¿è¡Œè¿‡ç¨‹ä¸­å·²å®Œæˆçš„ä»»åŠ¡æ•°é‡ï¼Œå°äºæˆ–ç­‰äºtaskCountã€‚</li><li>largestPoolSizeï¼šçº¿ç¨‹æ± é‡Œæ›¾ç»åˆ›å»ºè¿‡çš„æœ€å¤§çº¿ç¨‹æ•°é‡ã€‚é€šè¿‡è¿™ä¸ªæ•°æ®å¯ä»¥çŸ¥é“çº¿ç¨‹æ± æ˜¯å¦æ›¾ç»æ»¡è¿‡ã€‚</li><li>getPoolSizeï¼šçº¿ç¨‹æ± çš„çº¿ç¨‹æ•°é‡ã€‚å¦‚æœçº¿ç¨‹æ± ä¸é”€æ¯çš„è¯ï¼Œçº¿ç¨‹æ± é‡Œçš„çº¿ç¨‹ä¸ä¼šè‡ªåŠ¨é”€æ¯ï¼Œæ‰€ä»¥è¿™ä¸ªå¤§å°åªå¢ä¸å‡ã€‚</li><li>getActiveCountï¼šè·å–æ´»åŠ¨çš„çº¿ç¨‹æ•°ã€‚</li></ul><p>å¯ä»¥é€šè¿‡ç»§æ‰¿çº¿ç¨‹æ± æ¥è‡ªå®šä¹‰çº¿ç¨‹æ± ï¼Œé‡å†™çº¿ç¨‹æ± çš„beforeExecute, afterExecuteå’Œterminatedæ–¹æ³•ï¼Œä¹Ÿå¯ä»¥åœ¨ä»»åŠ¡æ‰§è¡Œå‰åå’Œçº¿ç¨‹æ± å…³é—­å‰æ‰§è¡Œä¸€äº›ä»£ç æ¥è¿›è¡Œç›‘æ§ã€‚ä¾‹å¦‚ï¼Œç›‘æ§ä»»åŠ¡çš„å¹³å‡æ‰§è¡Œæ—¶é—´ã€æœ€å¤§æ‰§è¡Œæ—¶é—´å’Œæœ€å°æ‰§è¡Œæ—¶é—´ç­‰ã€‚è¿™å‡ ä¸ªæ–¹æ³•åœ¨çº¿ç¨‹æ± é‡Œéƒ½æ˜¯ç©ºæ–¹æ³•ã€‚</p><h2 id="executoræ¡†æ¶" tabindex="-1"><a class="header-anchor" href="#executoræ¡†æ¶" aria-hidden="true">#</a> Executoræ¡†æ¶</h2><p>åœ¨Javaä¸­ï¼Œä½¿ç”¨çº¿ç¨‹æ¥å¼‚æ­¥æ‰§è¡Œä»»åŠ¡ã€‚Javaçº¿ç¨‹çš„åˆ›å»ºä¸é”€æ¯éœ€è¦ä¸€å®šçš„å¼€é”€ï¼Œå¦‚æœæˆ‘ä»¬ä¸ºæ¯ä¸€ä¸ªä»»åŠ¡åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹æ¥æ‰§è¡Œï¼Œè¿™äº›çº¿ç¨‹çš„åˆ›å»ºä¸é”€æ¯å°†æ¶ˆè€—å¤§é‡çš„è®¡ç®—èµ„æºã€‚åŒæ—¶ï¼Œä¸ºæ¯ä¸€ä¸ªä»»åŠ¡åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹æ¥æ‰§è¡Œï¼Œè¿™ç§ç­–ç•¥å¯èƒ½ä¼šä½¿å¤„äºé«˜è´Ÿè·çŠ¶æ€çš„åº”ç”¨æœ€ç»ˆå´©æºƒã€‚</p><p>Javaçš„çº¿ç¨‹æ—¢æ˜¯å·¥ä½œå•å…ƒï¼Œä¹Ÿæ˜¯æ‰§è¡Œæœºåˆ¶ã€‚ä»JDK5å¼€å§‹ï¼ŒæŠŠå·¥ä½œå•å…ƒä¸æ‰§è¡Œæœºåˆ¶åˆ†ç¦»å¼€æ¥ã€‚å·¥ä½œå•å…ƒåŒ…æ‹¬Runnableå’ŒCallableï¼Œè€Œæ‰§è¡Œæœºåˆ¶ç”±Executoræ¡†æ¶æä¾›ã€‚</p><h3 id="ä¸¤çº§è°ƒåº¦æ¨¡å‹" tabindex="-1"><a class="header-anchor" href="#ä¸¤çº§è°ƒåº¦æ¨¡å‹" aria-hidden="true">#</a> ä¸¤çº§è°ƒåº¦æ¨¡å‹</h3><p>åœ¨ä¸Šå±‚ï¼ŒJavaå¤šçº¿ç¨‹ç¨‹åºé€šå¸¸æŠŠåº”ç”¨åˆ†è§£ä¸ºè‹¥å¹²ä¸ªä»»åŠ¡ï¼Œç„¶åä½¿ç”¨ç”¨æˆ·çº§çš„è°ƒåº¦å™¨(Executoræ¡†æ¶)å°†è¿™äº›ä»»åŠ¡æ˜ å°„ä¸ºå›ºå®šæ•°é‡çš„çº¿ç¨‹ï¼›åœ¨åº•å±‚ï¼Œæ“ä½œç³»ç»Ÿå†…æ ¸å°†è¿™äº›çº¿ç¨‹æ˜ å°„åˆ°ç¡¬ä»¶å¤„ç†å™¨ä¸Šã€‚</p><p>åº”ç”¨ç¨‹åºé€šè¿‡Executoræ¡†æ¶æ§åˆ¶ä¸Šå±‚çš„è°ƒåº¦ï¼›è€Œä¸‹å±‚çš„è°ƒåº¦ç”±æ“ä½œç³»ç»Ÿå†…æ ¸æ§åˆ¶ï¼Œä¸‹å±‚çš„è°ƒåº¦ä¸å—åº”ç”¨ç¨‹åºçš„æ§åˆ¶ã€‚</p><div align="center"><p><img src="/cs-way/assets/ä»»åŠ¡çš„ä¸¤çº§è°ƒåº¦æ¨¡å‹.3df94856.png" alt="" title=":size=500" loading="lazy"></p></div><h3 id="æ¡†æ¶ç»“æ„" tabindex="-1"><a class="header-anchor" href="#æ¡†æ¶ç»“æ„" aria-hidden="true">#</a> æ¡†æ¶ç»“æ„</h3><p>Executoræ¡†æ¶ä¸»è¦ç”±3å¤§éƒ¨åˆ†ç»„æˆå¦‚ä¸‹</p><ul><li>ä»»åŠ¡(Runnable / Callable)ï¼š<br> æ‰§è¡Œä»»åŠ¡éœ€è¦å®ç°çš„ Runnable æ¥å£ æˆ– Callableæ¥å£ã€‚Runnable æ¥å£æˆ– Callable æ¥å£ å®ç°ç±»éƒ½å¯ä»¥è¢« ThreadPoolExecutor æˆ– ScheduledThreadPoolExecutor æ‰§è¡Œã€‚</li><li>ä»»åŠ¡çš„æ‰§è¡Œ(Executor)<br> åŒ…æ‹¬ä»»åŠ¡æ‰§è¡Œæœºåˆ¶çš„æ ¸å¿ƒæ¥å£Executorï¼Œä»¥åŠç»§æ‰¿è‡ªExecutorçš„ExecutorServiceæ¥å£ã€‚Executoræ¡†æ¶æœ‰ä¸¤ä¸ªå…³é”®ç±»å®ç°äº†ExecutorServiceæ¥å£(<strong>ThreadPoolExecutor</strong> å’Œ <strong>ScheduledThreadPoolExecutor</strong>) <blockquote><p>æ³¨æ„ï¼š é€šè¿‡æŸ¥çœ‹ ScheduledThreadPoolExecutor æºä»£ç æˆ‘ä»¬å‘ç° ScheduledThreadPoolExecutor å®é™…ä¸Šæ˜¯ç»§æ‰¿äº† ThreadPoolExecutor å¹¶å®ç°äº† ScheduledExecutorService ï¼Œè€Œ ScheduledExecutorService åˆå®ç°äº† ExecutorServiceï¼Œæ­£å¦‚æˆ‘ä»¬ä¸‹é¢ç»™å‡ºçš„ç±»å…³ç³»å›¾æ˜¾ç¤ºçš„ä¸€æ ·ã€‚</p></blockquote></li></ul><div align="center"><p><img src="/cs-way/assets/ä»»åŠ¡çš„æ‰§è¡Œç›¸å…³æ¥å£.70dc9c7c.png" alt="" title=":size=500" loading="lazy"></p></div><ul><li>å¼‚æ­¥è®¡ç®—çš„ç»“æœ(Future)<br> Future æ¥å£ä»¥åŠ Future æ¥å£çš„å®ç°ç±» FutureTask ç±»éƒ½å¯ä»¥ä»£è¡¨å¼‚æ­¥è®¡ç®—çš„ç»“æœã€‚<br> å½“æˆ‘ä»¬æŠŠ Runnableæ¥å£ æˆ– Callable æ¥å£ çš„å®ç°ç±»æäº¤ç»™ ThreadPoolExecutor æˆ– ScheduledThreadPoolExecutor æ‰§è¡Œã€‚(è°ƒç”¨ submit() æ–¹æ³•æ—¶ä¼šè¿”å›ä¸€ä¸ª FutureTask å¯¹è±¡)</li></ul><h3 id="æ¡†æ¶ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#æ¡†æ¶ä½¿ç”¨" aria-hidden="true">#</a> æ¡†æ¶ä½¿ç”¨</h3><div align="center"><p><img src="/cs-way/assets/æ¡†æ¶ä½¿ç”¨ç¤ºæ„å›¾.800a06ac.png" alt="" title=":size=500" loading="lazy"></p></div><ol><li>ä¸»çº¿ç¨‹é¦–å…ˆè¦åˆ›å»ºå®ç° Runnable æˆ–è€… Callable æ¥å£çš„ä»»åŠ¡å¯¹è±¡ã€‚</li><li>æŠŠåˆ›å»ºå®Œæˆçš„å®ç° Runnable/Callableæ¥å£çš„ å¯¹è±¡ç›´æ¥äº¤ç»™ ExecutorService æ‰§è¡Œ: <code>ExecutorService.execute(Runnable command))</code>æˆ–è€…ä¹Ÿå¯ä»¥æŠŠ Runnable å¯¹è±¡æˆ–Callable å¯¹è±¡æäº¤ç»™ ExecutorService æ‰§è¡Œ <code>ExecutorService.submit(Runnable task)</code>æˆ– <code>ExecutorService.submit(Callable &lt;T&gt; task))</code>ã€‚</li><li>å¦‚æœæ‰§è¡Œ ExecutorService.submit(â€¦)ï¼ŒExecutorService å°†è¿”å›ä¸€ä¸ªå®ç° Future æ¥å£çš„å¯¹è±¡(æˆ‘ä»¬åˆšåˆšä¹Ÿæåˆ°è¿‡äº†æ‰§è¡Œ execute() æ–¹æ³•å’Œ submit() æ–¹æ³•çš„åŒºåˆ«ï¼Œsubmit()ä¼šè¿”å›ä¸€ä¸ª FutureTask å¯¹è±¡)ã€‚ç”±äº FutureTask å®ç°äº† Runnableï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ›å»º FutureTaskï¼Œç„¶åç›´æ¥äº¤ç»™ ExecutorService æ‰§è¡Œã€‚</li><li>æœ€åï¼Œä¸»çº¿ç¨‹å¯ä»¥æ‰§è¡Œ FutureTask.get() æ–¹æ³•æ¥ç­‰å¾…ä»»åŠ¡æ‰§è¡Œå®Œæˆã€‚ä¸»çº¿ç¨‹ä¹Ÿå¯ä»¥æ‰§è¡Œ FutureTask.cancel(boolean mayInterruptIfRunning)æ¥å–æ¶ˆæ­¤ä»»åŠ¡çš„æ‰§è¡Œã€‚</li></ol><h3 id="executoræ¡†æ¶çš„æˆå‘˜" tabindex="-1"><a class="header-anchor" href="#executoræ¡†æ¶çš„æˆå‘˜" aria-hidden="true">#</a> Executoræ¡†æ¶çš„æˆå‘˜</h3><h4 id="threadpoolexecutor" tabindex="-1"><a class="header-anchor" href="#threadpoolexecutor" aria-hidden="true">#</a> ThreadPoolExecutor</h4><p>ThreadPoolExecutoré€šå¸¸ä½¿ç”¨å·¥å‚ç±»Executorsæ¥åˆ›å»ºã€‚Executorså¯ä»¥åˆ›å»º3ç§ç±»å‹çš„ThreadPoolExecutorï¼š</p><ul><li>FixedThreadPool è¢«ç§°ä¸ºå¯é‡ç”¨å›ºå®šçº¿ç¨‹æ•°çš„çº¿ç¨‹æ± ,é€‚ç”¨äºä¸ºäº†æ»¡è¶³èµ„æºç®¡ç†çš„éœ€æ±‚ï¼Œè€Œéœ€è¦é™åˆ¶å½“å‰çº¿ç¨‹æ•°é‡çš„åº”ç”¨åœºæ™¯ï¼Œå®ƒé€‚ç”¨äºè´Ÿè½½æ¯”è¾ƒé‡çš„æœåŠ¡å™¨</li><li>SingleThreadExecutor æ˜¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± ,é€‚ç”¨äºéœ€è¦ä¿è¯é¡ºåºåœ°æ‰§è¡Œå„ä¸ªä»»åŠ¡ï¼›å¹¶ä¸”åœ¨ä»»æ„æ—¶é—´ç‚¹ï¼Œä¸ä¼šæœ‰å¤šä¸ªçº¿ç¨‹æ˜¯æ´»åŠ¨çš„åº”ç”¨åœºæ™¯</li><li>CachedThreadPool: æ˜¯ä¸€ä¸ªä¼šæ ¹æ®éœ€è¦åˆ›å»ºæ–°çº¿ç¨‹çš„çº¿ç¨‹æ± ,æ˜¯å¤§å°æ— ç•Œçš„çº¿ç¨‹æ± ï¼Œé€‚ç”¨äºæ‰§è¡Œå¾ˆå¤šçš„çŸ­æœŸå¼‚æ­¥ä»»åŠ¡çš„å°ç¨‹åºï¼Œæˆ–è€…æ˜¯è´Ÿè½½è¾ƒè½»çš„æœåŠ¡å™¨ã€‚</li></ul><h4 id="scheduledthreadpoolexecutor" tabindex="-1"><a class="header-anchor" href="#scheduledthreadpoolexecutor" aria-hidden="true">#</a> ScheduledThreadPoolExecutor</h4><p>ScheduledThreadPoolExecutoré€šå¸¸ä½¿ç”¨å·¥å‚ç±»Executorsæ¥åˆ›å»ºã€‚Executorså¯ä»¥åˆ›å»º2ç§ç±»å‹çš„ScheduledThreadPoolExecutorï¼Œå¦‚ä¸‹:</p><ul><li>ScheduledThreadPoolExecutorã€‚åŒ…å«è‹¥å¹²ä¸ªçº¿ç¨‹çš„ScheduledThreadPoolExecutor</li><li>SingleThreadScheduledExecutorã€‚åªåŒ…å«ä¸€ä¸ªçº¿ç¨‹çš„ScheduledThreadPoolExecutor</li></ul><h4 id="futureæ¥å£" tabindex="-1"><a class="header-anchor" href="#futureæ¥å£" aria-hidden="true">#</a> Futureæ¥å£</h4><p>Futureæ¥å£å’Œå®ç°Futureæ¥å£çš„FutureTaskç±»ç”¨æ¥è¡¨ç¤ºå¼‚æ­¥è®¡ç®—çš„ç»“æœã€‚å½“æˆ‘ä»¬æŠŠRunnableæ¥å£æˆ–Callableæ¥å£çš„å®ç°ç±»æäº¤(submit)ç»™ThreadPoolExecutoræˆ–ScheduledThreadPoolExecutoræ—¶ï¼ŒThreadPoolExecutoræˆ–ScheduledThreadPoolExecutorä¼šå‘æˆ‘ä»¬è¿”å›ä¸€ä¸ªFutureTaskå¯¹è±¡ã€‚</p><h4 id="runnableæ¥å£å’Œcallableæ¥å£" tabindex="-1"><a class="header-anchor" href="#runnableæ¥å£å’Œcallableæ¥å£" aria-hidden="true">#</a> Runnableæ¥å£å’ŒCallableæ¥å£</h4><p>Runnableæ¥å£å’ŒCallableæ¥å£çš„å®ç°ç±»ï¼Œéƒ½å¯ä»¥è¢«ThreadPoolExecutoræˆ–ScheduledThreadPoolExecutoræ‰§è¡Œã€‚å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯Runnableä¸ä¼šè¿”å›ç»“æœï¼Œè€ŒCallableå¯ä»¥è¿”å›ç»“æœ</p><p><strong>æ¯”è¾ƒ</strong></p><ul><li>Runnableè‡ª Java 1.0 ä»¥æ¥ä¸€ç›´å­˜åœ¨ï¼Œä½†Callableä»…åœ¨ Java 1.5 ä¸­å¼•å…¥,ç›®çš„å°±æ˜¯ä¸ºäº†æ¥å¤„ç†Runnableä¸æ”¯æŒçš„ç”¨ä¾‹ã€‚Runnable æ¥å£ä¸ä¼šè¿”å›ç»“æœæˆ–æŠ›å‡ºæ£€æŸ¥å¼‚å¸¸ï¼Œä½†æ˜¯Callable æ¥å£å¯ä»¥ã€‚æ‰€ä»¥ï¼Œå¦‚æœä»»åŠ¡ä¸éœ€è¦è¿”å›ç»“æœæˆ–æŠ›å‡ºå¼‚å¸¸æ¨èä½¿ç”¨ Runnable æ¥å£ï¼Œè¿™æ ·ä»£ç çœ‹èµ·æ¥ä¼šæ›´åŠ ç®€æ´ã€‚</li></ul><h3 id="threadpoolexecutorè¯¦è§£" tabindex="-1"><a class="header-anchor" href="#threadpoolexecutorè¯¦è§£" aria-hidden="true">#</a> ThreadPoolExecutorè¯¦è§£</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token doc-comment comment">/**
     * ç”¨ç»™å®šçš„åˆå§‹å‚æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ThreadPoolExecutorã€‚
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token keyword">int</span> corePoolSize<span class="token punctuation">,</span><span class="token comment">//çº¿ç¨‹æ± çš„æ ¸å¿ƒçº¿ç¨‹æ•°é‡</span>
                              <span class="token keyword">int</span> maximumPoolSize<span class="token punctuation">,</span><span class="token comment">//çº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹æ•°</span>
                              <span class="token keyword">long</span> keepAliveTime<span class="token punctuation">,</span><span class="token comment">//å½“çº¿ç¨‹æ•°å¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°æ—¶ï¼Œå¤šä½™çš„ç©ºé—²çº¿ç¨‹å­˜æ´»çš„æœ€é•¿æ—¶é—´</span>
                              <span class="token class-name">TimeUnit</span> unit<span class="token punctuation">,</span><span class="token comment">//æ—¶é—´å•ä½</span>
                              <span class="token class-name">BlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span> workQueue<span class="token punctuation">,</span><span class="token comment">//ä»»åŠ¡é˜Ÿåˆ—ï¼Œç”¨æ¥å‚¨å­˜ç­‰å¾…æ‰§è¡Œä»»åŠ¡çš„é˜Ÿåˆ—</span>
                              <span class="token class-name">ThreadFactory</span> threadFactory<span class="token punctuation">,</span><span class="token comment">//çº¿ç¨‹å·¥å‚ï¼Œç”¨æ¥åˆ›å»ºçº¿ç¨‹ï¼Œä¸€èˆ¬é»˜è®¤å³å¯</span>
                              <span class="token class-name">RejectedExecutionHandler</span> handler<span class="token comment">//æ‹’ç»ç­–ç•¥ï¼Œå½“æäº¤çš„ä»»åŠ¡è¿‡å¤šè€Œä¸èƒ½åŠæ—¶å¤„ç†æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å®šåˆ¶ç­–ç•¥æ¥å¤„ç†ä»»åŠ¡</span>
                               <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>corePoolSize <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span>
            maximumPoolSize <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span>
            maximumPoolSize <span class="token operator">&lt;</span> corePoolSize <span class="token operator">||</span>
            keepAliveTime <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>workQueue <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> threadFactory <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> handler <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>corePoolSize <span class="token operator">=</span> corePoolSize<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>maximumPoolSize <span class="token operator">=</span> maximumPoolSize<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>workQueue <span class="token operator">=</span> workQueue<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>keepAliveTime <span class="token operator">=</span> unit<span class="token punctuation">.</span><span class="token function">toNanos</span><span class="token punctuation">(</span>keepAliveTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>threadFactory <span class="token operator">=</span> threadFactory<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>handler <span class="token operator">=</span> handler<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>ThreadPoolExecutor 3 ä¸ªæœ€é‡è¦çš„å‚æ•°ï¼š</p><ul><li>corePoolSize : æ ¸å¿ƒçº¿ç¨‹æ•°çº¿ç¨‹æ•°å®šä¹‰äº†æœ€å°å¯ä»¥åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡ã€‚</li><li>maximumPoolSize : å½“é˜Ÿåˆ—ä¸­å­˜æ”¾çš„ä»»åŠ¡è¾¾åˆ°é˜Ÿåˆ—å®¹é‡çš„æ—¶å€™ï¼Œå½“å‰å¯ä»¥åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡å˜ä¸ºæœ€å¤§çº¿ç¨‹æ•°ã€‚</li><li>workQueue: å½“æ–°ä»»åŠ¡æ¥çš„æ—¶å€™ä¼šå…ˆåˆ¤æ–­å½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°é‡æ˜¯å¦è¾¾åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå¦‚æœè¾¾åˆ°çš„è¯ï¼Œä¿¡ä»»å°±ä¼šè¢«å­˜æ”¾åœ¨é˜Ÿåˆ—ä¸­ã€‚</li></ul><p>ThreadPoolExecutorå…¶ä»–å¸¸è§å‚æ•°:</p><ul><li>keepAliveTime:å½“çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡å¤§äº corePoolSize çš„æ—¶å€™ï¼Œå¦‚æœè¿™æ—¶æ²¡æœ‰æ–°çš„ä»»åŠ¡æäº¤ï¼Œæ ¸å¿ƒçº¿ç¨‹å¤–çš„çº¿ç¨‹ä¸ä¼šç«‹å³é”€æ¯ï¼Œè€Œæ˜¯ä¼šç­‰å¾…ï¼Œç›´åˆ°ç­‰å¾…çš„æ—¶é—´è¶…è¿‡äº† keepAliveTimeæ‰ä¼šè¢«å›æ”¶é”€æ¯ï¼›</li><li>unit : keepAliveTime å‚æ•°çš„æ—¶é—´å•ä½ã€‚</li><li>threadFactory :executor åˆ›å»ºæ–°çº¿ç¨‹çš„æ—¶å€™ä¼šç”¨åˆ°ã€‚</li><li>handler :é¥±å’Œç­–ç•¥ã€‚å…³äºé¥±å’Œç­–ç•¥ä¸‹é¢å•ç‹¬ä»‹ç»ä¸€ä¸‹ã€‚</li></ul><p>çº¿ç¨‹æ± ä¸­å„ä¸ªå‚æ•°çš„ç›¸äº’å…³ç³»</p><div align="center"><p><img src="/cs-way/assets/çº¿ç¨‹æ± å„ä¸ªå‚æ•°çš„å…³ç³».82f3ddef.png" alt="" title=":size=500" loading="lazy"></p></div><p>ThreadPoolExecutor é¥±å’Œç­–ç•¥å®šä¹‰:</p><p>å¦‚æœå½“å‰åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡è¾¾åˆ°æœ€å¤§çº¿ç¨‹æ•°é‡å¹¶ä¸”é˜Ÿåˆ—ä¹Ÿå·²ç»è¢«æ”¾æ»¡äº†ä»»æ—¶ï¼ŒThreadPoolTaskExecutor å®šä¹‰ä¸€äº›ç­–ç•¥:</p><ul><li>ThreadPoolExecutor.AbortPolicyï¼šæŠ›å‡º RejectedExecutionExceptionæ¥æ‹’ç»æ–°ä»»åŠ¡çš„å¤„ç†ã€‚</li><li>ThreadPoolExecutor.CallerRunsPolicyï¼šè°ƒç”¨æ‰§è¡Œè‡ªå·±çš„çº¿ç¨‹è¿è¡Œä»»åŠ¡ã€‚æ‚¨ä¸ä¼šä»»åŠ¡è¯·æ±‚ã€‚ä½†æ˜¯è¿™ç§ç­–ç•¥ä¼šé™ä½å¯¹äºæ–°ä»»åŠ¡æäº¤é€Ÿåº¦ï¼Œå½±å“ç¨‹åºçš„æ•´ä½“æ€§èƒ½ã€‚å¦å¤–ï¼Œè¿™ä¸ªç­–ç•¥å–œæ¬¢å¢åŠ é˜Ÿåˆ—å®¹é‡ã€‚å¦‚æœæ‚¨çš„åº”ç”¨ç¨‹åºå¯ä»¥æ‰¿å—æ­¤å»¶è¿Ÿå¹¶ä¸”ä½ ä¸èƒ½ä»»åŠ¡ä¸¢å¼ƒä»»ä½•ä¸€ä¸ªä»»åŠ¡è¯·æ±‚çš„è¯ï¼Œä½ å¯ä»¥é€‰æ‹©è¿™ä¸ªç­–ç•¥ã€‚</li><li>ThreadPoolExecutor.DiscardPolicyï¼š ä¸å¤„ç†æ–°ä»»åŠ¡ï¼Œç›´æ¥ä¸¢å¼ƒæ‰ã€‚</li><li>ThreadPoolExecutor.DiscardOldestPolicyï¼š æ­¤ç­–ç•¥å°†ä¸¢å¼ƒæœ€æ—©çš„æœªå¤„ç†çš„ä»»åŠ¡è¯·æ±‚ã€‚</li></ul><blockquote><p>Spring é€šè¿‡ ThreadPoolTaskExecutor æˆ–è€…æˆ‘ä»¬ç›´æ¥é€šè¿‡ ThreadPoolExecutor çš„æ„é€ å‡½æ•°åˆ›å»ºçº¿ç¨‹æ± çš„æ—¶å€™ï¼Œå½“æˆ‘ä»¬ä¸æŒ‡å®š RejectedExecutionHandler é¥±å’Œç­–ç•¥çš„è¯æ¥é…ç½®çº¿ç¨‹æ± çš„æ—¶å€™é»˜è®¤ä½¿ç”¨çš„æ˜¯ ThreadPoolExecutor.AbortPolicyã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒThreadPoolExecutor å°†æŠ›å‡º RejectedExecutionException æ¥æ‹’ç»æ–°æ¥çš„ä»»åŠ¡ ï¼Œè¿™ä»£è¡¨ä½ å°†ä¸¢å¤±å¯¹è¿™ä¸ªä»»åŠ¡çš„å¤„ç†ã€‚ å¯¹äºå¯ä¼¸ç¼©çš„åº”ç”¨ç¨‹åºï¼Œå»ºè®®ä½¿ç”¨ ThreadPoolExecutor.CallerRunsPolicyã€‚å½“æœ€å¤§æ± è¢«å¡«æ»¡æ—¶ï¼Œæ­¤ç­–ç•¥ä¸ºæˆ‘ä»¬æä¾›å¯ä¼¸ç¼©é˜Ÿåˆ—ã€‚(è¿™ä¸ªç›´æ¥æŸ¥çœ‹ ThreadPoolExecutor çš„æ„é€ å‡½æ•°æºç å°±å¯ä»¥çœ‹å‡ºï¼Œæ¯”è¾ƒç®€å•çš„åŸå› ï¼Œè¿™é‡Œå°±ä¸è´´ä»£ç äº†ã€‚)</p></blockquote><p>åœ¨ã€Šé˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œã€‹â€œå¹¶å‘å¤„ç†â€è¿™ä¸€ç« èŠ‚ï¼Œæ˜ç¡®æŒ‡å‡ºçº¿ç¨‹èµ„æºå¿…é¡»é€šè¿‡çº¿ç¨‹æ± æä¾›ï¼Œä¸å…è®¸åœ¨åº”ç”¨ä¸­è‡ªè¡Œæ˜¾ç¤ºåˆ›å»ºçº¿ç¨‹ã€‚</p><blockquote><p>ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„æ˜¯å‡å°‘åœ¨åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹ä¸Šæ‰€æ¶ˆè€—çš„æ—¶é—´ä»¥åŠç³»ç»Ÿèµ„æºå¼€é”€ï¼Œè§£å†³èµ„æºä¸è¶³çš„é—®é¢˜ã€‚å¦‚æœä¸ä½¿ç”¨çº¿ç¨‹æ± ï¼Œæœ‰å¯èƒ½ä¼šé€ æˆç³»ç»Ÿåˆ›å»ºå¤§é‡åŒç±»çº¿ç¨‹è€Œå¯¼è‡´æ¶ˆè€—å®Œå†…å­˜æˆ–è€…â€œè¿‡åº¦åˆ‡æ¢â€çš„é—®é¢˜ã€‚</p></blockquote><p>å¦å¤–ã€Šé˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œã€‹ä¸­å¼ºåˆ¶çº¿ç¨‹æ± ä¸å…è®¸ä½¿ç”¨ Executors å»åˆ›å»ºï¼Œè€Œæ˜¯é€šè¿‡ ThreadPoolExecutor æ„é€ å‡½æ•°çš„æ–¹å¼ï¼Œè¿™æ ·çš„å¤„ç†æ–¹å¼è®©å†™çš„åŒå­¦æ›´åŠ æ˜ç¡®çº¿ç¨‹æ± çš„è¿è¡Œè§„åˆ™ï¼Œè§„é¿èµ„æºè€—å°½çš„é£é™©</p><blockquote><p>Executors è¿”å›çº¿ç¨‹æ± å¯¹è±¡çš„å¼Šç«¯å¦‚ä¸‹ï¼š</p></blockquote><ul><li>FixedThreadPool å’Œ SingleThreadExecutor ï¼š å…è®¸è¯·æ±‚çš„é˜Ÿåˆ—é•¿åº¦ä¸º Integer.MAX_VALUE,å¯èƒ½å †ç§¯å¤§é‡çš„è¯·æ±‚ï¼Œä»è€Œå¯¼è‡´ OOMã€‚</li><li>CachedThreadPool å’Œ ScheduledThreadPool ï¼š å…è®¸åˆ›å»ºçš„çº¿ç¨‹æ•°é‡ä¸º Integer.MAX_VALUE ï¼Œå¯èƒ½ä¼šåˆ›å»ºå¤§é‡çº¿ç¨‹ï¼Œä»è€Œå¯¼è‡´ OOMã€‚</li></ul><h4 id="fixedthreadpool" tabindex="-1"><a class="header-anchor" href="#fixedthreadpool" aria-hidden="true">#</a> FixedThreadPool</h4><div class="language-java ext-java"><pre class="language-java"><code>    <span class="token doc-comment comment">/**
     * åˆ›å»ºä¸€ä¸ªå¯é‡ç”¨å›ºå®šæ•°é‡çº¿ç¨‹çš„çº¿ç¨‹æ± 
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ExecutorService</span> <span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token keyword">int</span> nThreads<span class="token punctuation">,</span> <span class="token class-name">ThreadFactory</span> threadFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span>nThreads<span class="token punctuation">,</span> nThreads<span class="token punctuation">,</span>
                                      <span class="token number">0L</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">,</span>
                                      <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                      threadFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>å¯ä»¥çœ‹å‡ºæ–°åˆ›å»ºçš„ FixedThreadPool çš„ corePoolSize å’Œ maximumPoolSize éƒ½è¢«è®¾ç½®ä¸º nThreadsï¼Œè¿™ä¸ª nThreads å‚æ•°æ˜¯ä½¿ç”¨çš„æ—¶ä¼ é€’çš„ã€‚</p><p>FixedThreadPool çš„ execute() æ–¹æ³•è¿è¡Œç¤ºæ„å›¾</p><div align="center"><p><img src="/cs-way/assets/FixedThreadPoolè¿è¡Œç¤ºæ„.8f783ad8.png" alt="" title=":size=500" loading="lazy"></p></div><ol><li>å¦‚æœå½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°å°äº corePoolSizeï¼Œ å¦‚æœå†æ¥æ–°ä»»åŠ¡çš„è¯ï¼Œå°±åˆ›å»ºæ–°çš„çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼›</li><li>å½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°ç­‰äº corePoolSize åï¼Œ å¦‚æœå†æ¥æ–°ä»»åŠ¡çš„è¯ï¼Œä¼šå°†ä»»åŠ¡åŠ å…¥ LinkedBlockingQueueï¼›</li><li>çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ‰§è¡Œå®Œæ‰‹å¤´çš„ä»»åŠ¡åï¼Œä¼šåœ¨å¾ªç¯ä¸­åå¤ä» LinkedBlockingQueue ä¸­è·å–ä»»åŠ¡æ¥æ‰§è¡Œï¼›</li></ol><p><strong>ä¸æ¨èä½¿ç”¨FixedThreadPool</strong></p><p>FixedThreadPool ä½¿ç”¨æ— ç•Œé˜Ÿåˆ— LinkedBlockingQueue(é˜Ÿåˆ—çš„å®¹é‡ä¸º Intger.MAX_VALUE)ä½œä¸ºçº¿ç¨‹æ± çš„å·¥ä½œé˜Ÿåˆ—ä¼šå¯¹çº¿ç¨‹æ± å¸¦æ¥å¦‚ä¸‹å½±å“ ï¼š</p><ol><li>å½“çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°è¾¾åˆ° corePoolSize åï¼Œæ–°ä»»åŠ¡å°†åœ¨æ— ç•Œé˜Ÿåˆ—ä¸­ç­‰å¾…ï¼Œå› æ­¤çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ä¸ä¼šè¶…è¿‡ corePoolSizeï¼›</li><li>ç”±äºä½¿ç”¨æ— ç•Œé˜Ÿåˆ—æ—¶ maximumPoolSize å°†æ˜¯ä¸€ä¸ªæ— æ•ˆå‚æ•°ï¼Œå› ä¸ºä¸å¯èƒ½å­˜åœ¨ä»»åŠ¡é˜Ÿåˆ—æ»¡çš„æƒ…å†µã€‚æ‰€ä»¥ï¼Œé€šè¿‡åˆ›å»º FixedThreadPoolçš„æºç å¯ä»¥çœ‹å‡ºåˆ›å»ºçš„ FixedThreadPool çš„ corePoolSize å’Œ maximumPoolSize è¢«è®¾ç½®ä¸ºåŒä¸€ä¸ªå€¼ã€‚</li><li>ç”±äº 1 å’Œ 2ï¼Œä½¿ç”¨æ— ç•Œé˜Ÿåˆ—æ—¶ keepAliveTime å°†æ˜¯ä¸€ä¸ªæ— æ•ˆå‚æ•°ï¼›</li><li>è¿è¡Œä¸­çš„ FixedThreadPool(æœªæ‰§è¡Œ shutdown()æˆ– shutdownNow())ä¸ä¼šæ‹’ç»ä»»åŠ¡ï¼Œåœ¨ä»»åŠ¡æ¯”è¾ƒå¤šçš„æ—¶å€™ä¼šå¯¼è‡´ OOM(å†…å­˜æº¢å‡º)ã€‚</li></ol><h4 id="singlethreadexecutor" tabindex="-1"><a class="header-anchor" href="#singlethreadexecutor" aria-hidden="true">#</a> SingleThreadExecutor</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token doc-comment comment">/**
     *è¿”å›åªæœ‰ä¸€ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± 
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ExecutorService</span> <span class="token function">newSingleThreadExecutor</span><span class="token punctuation">(</span><span class="token class-name">ThreadFactory</span> threadFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">FinalizableDelegatedExecutorService</span>
            <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
                                    <span class="token number">0L</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">,</span>
                                    <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                    threadFactory<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ExecutorService</span> <span class="token function">newSingleThreadExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">FinalizableDelegatedExecutorService</span>
            <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
                                    <span class="token number">0L</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">,</span>
                                    <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>å¯ä»¥çœ‹å‡ºæ–°åˆ›å»ºçš„ SingleThreadExecutor çš„ corePoolSize å’Œ maximumPoolSize éƒ½è¢«è®¾ç½®ä¸º 1.å…¶ä»–å‚æ•°å’Œ FixedThreadPool ç›¸åŒã€‚</p><div align="center"><p><img src="/cs-way/assets/SingleThreadExecutorè¿è¡Œç¤ºæ„.efe44d49.png" alt="" title=":size=500" loading="lazy"></p></div><ol><li>å¦‚æœå½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°å°‘äº corePoolSizeï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼›</li><li>å½“å‰çº¿ç¨‹æ± ä¸­æœ‰ä¸€ä¸ªè¿è¡Œçš„çº¿ç¨‹åï¼Œå°†ä»»åŠ¡åŠ å…¥ LinkedBlockingQueue</li><li>çº¿ç¨‹æ‰§è¡Œå®Œå½“å‰çš„ä»»åŠ¡åï¼Œä¼šåœ¨å¾ªç¯ä¸­åå¤ä»LinkedBlockingQueue ä¸­è·å–ä»»åŠ¡æ¥æ‰§è¡Œï¼›</li></ol><p><strong>ä¸æ¨èä½¿ç”¨ SingleThreadExecutor</strong></p><p>SingleThreadExecutor ä½¿ç”¨æ— ç•Œé˜Ÿåˆ— LinkedBlockingQueue ä½œä¸ºçº¿ç¨‹æ± çš„å·¥ä½œé˜Ÿåˆ—(é˜Ÿåˆ—çš„å®¹é‡ä¸º Intger.MAX_VALUE)ã€‚SingleThreadExecutor ä½¿ç”¨æ— ç•Œé˜Ÿåˆ—ä½œä¸ºçº¿ç¨‹æ± çš„å·¥ä½œé˜Ÿåˆ—ä¼šå¯¹çº¿ç¨‹æ± å¸¦æ¥çš„å½±å“ä¸ FixedThreadPool ç›¸åŒã€‚è¯´ç®€å•ç‚¹å°±æ˜¯å¯èƒ½ä¼šå¯¼è‡´ OOMï¼Œ</p><h4 id="cachedthreadpool" tabindex="-1"><a class="header-anchor" href="#cachedthreadpool" aria-hidden="true">#</a> CachedThreadPool</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token doc-comment comment">/**
     * åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± ï¼Œæ ¹æ®éœ€è¦åˆ›å»ºæ–°çº¿ç¨‹ï¼Œä½†ä¼šåœ¨å…ˆå‰æ„å»ºçš„çº¿ç¨‹å¯ç”¨æ—¶é‡ç”¨å®ƒã€‚
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ExecutorService</span> <span class="token function">newCachedThreadPool</span><span class="token punctuation">(</span><span class="token class-name">ThreadFactory</span> threadFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">,</span>
                                      <span class="token number">60L</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">,</span>
                                      <span class="token keyword">new</span> <span class="token class-name">SynchronousQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                      threadFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ExecutorService</span> <span class="token function">newCachedThreadPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">,</span>
                                      <span class="token number">60L</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">,</span>
                                      <span class="token keyword">new</span> <span class="token class-name">SynchronousQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>CachedThreadPool çš„corePoolSize è¢«è®¾ç½®ä¸ºç©º(0)ï¼ŒmaximumPoolSizeè¢«è®¾ç½®ä¸º Integer.MAX.VALUEï¼Œå³å®ƒæ˜¯æ— ç•Œçš„ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€å¦‚æœä¸»çº¿ç¨‹æäº¤ä»»åŠ¡çš„é€Ÿåº¦é«˜äº maximumPool ä¸­çº¿ç¨‹å¤„ç†ä»»åŠ¡çš„é€Ÿåº¦æ—¶ï¼ŒCachedThreadPool ä¼šä¸æ–­åˆ›å»ºæ–°çš„çº¿ç¨‹ã€‚æç«¯æƒ…å†µä¸‹ï¼Œè¿™æ ·ä¼šå¯¼è‡´è€—å°½ cpu å’Œå†…å­˜èµ„æºã€‚</p><div align="center"><p><img src="/cs-way/assets/CachedThreadPoolè¿è¡Œç¤ºæ„.29be15cd.png" alt="" title=":size=500" loading="lazy"></p></div><ol><li>é¦–å…ˆæ‰§è¡Œ SynchronousQueue.offer(Runnable task) æäº¤ä»»åŠ¡åˆ°ä»»åŠ¡é˜Ÿåˆ—ã€‚å¦‚æœå½“å‰ maximumPool ä¸­æœ‰é—²çº¿ç¨‹æ­£åœ¨æ‰§è¡Œ SynchronousQueue.poll(keepAliveTime,TimeUnit.NANOSECONDS)ï¼Œé‚£ä¹ˆä¸»çº¿ç¨‹æ‰§è¡Œ offer æ“ä½œä¸ç©ºé—²çº¿ç¨‹æ‰§è¡Œçš„ poll æ“ä½œé…å¯¹æˆåŠŸï¼Œä¸»çº¿ç¨‹æŠŠä»»åŠ¡äº¤ç»™ç©ºé—²çº¿ç¨‹æ‰§è¡Œï¼Œexecute()æ–¹æ³•æ‰§è¡Œå®Œæˆï¼Œå¦åˆ™æ‰§è¡Œä¸‹é¢çš„æ­¥éª¤ 2ï¼›</li><li>å½“åˆå§‹ maximumPool ä¸ºç©ºï¼Œæˆ–è€… maximumPool ä¸­æ²¡æœ‰ç©ºé—²çº¿ç¨‹æ—¶ï¼Œå°†æ²¡æœ‰çº¿ç¨‹æ‰§è¡Œ SynchronousQueue.poll(keepAliveTime,TimeUnit.NANOSECONDS)ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæ­¥éª¤ 1 å°†å¤±è´¥ï¼Œæ­¤æ—¶ CachedThreadPool ä¼šåˆ›å»ºæ–°çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼Œexecute æ–¹æ³•æ‰§è¡Œå®Œæˆï¼›</li></ol><h3 id="scheduledthreadpoolexecutorè¯¦è§£" tabindex="-1"><a class="header-anchor" href="#scheduledthreadpoolexecutorè¯¦è§£" aria-hidden="true">#</a> ScheduledThreadPoolExecutorè¯¦è§£</h3><p>ScheduledThreadPoolExecutor ä½¿ç”¨çš„ä»»åŠ¡é˜Ÿåˆ— DelayQueue å°è£…äº†ä¸€ä¸ª PriorityQueueï¼ŒPriorityQueue ä¼šå¯¹é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡è¿›è¡Œæ’åºï¼Œæ‰§è¡Œæ‰€éœ€æ—¶é—´çŸ­çš„æ”¾åœ¨å‰é¢å…ˆè¢«æ‰§è¡Œ(ScheduledFutureTask çš„ time å˜é‡å°çš„å…ˆæ‰§è¡Œ)ï¼Œå¦‚æœæ‰§è¡Œæ‰€éœ€æ—¶é—´ç›¸åŒåˆ™å…ˆæäº¤çš„ä»»åŠ¡å°†è¢«å…ˆæ‰§è¡Œ(ScheduledFutureTask çš„ squenceNumber å˜é‡å°çš„å…ˆæ‰§è¡Œ)ã€‚</p><p>ScheduledThreadPoolExecutor å’Œ Timer çš„æ¯”è¾ƒï¼š</p><ul><li>Timer å¯¹ç³»ç»Ÿæ—¶é’Ÿçš„å˜åŒ–æ•æ„Ÿï¼ŒScheduledThreadPoolExecutorä¸æ˜¯ï¼›</li><li>Timer åªæœ‰ä¸€ä¸ªæ‰§è¡Œçº¿ç¨‹ï¼Œå› æ­¤é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡å¯ä»¥å»¶è¿Ÿå…¶ä»–ä»»åŠ¡ã€‚ ScheduledThreadPoolExecutor å¯ä»¥é…ç½®ä»»æ„æ•°é‡çš„çº¿ç¨‹ã€‚ æ­¤å¤–ï¼Œå¦‚æœä½ æƒ³(é€šè¿‡æä¾› ThreadFactory)ï¼Œä½ å¯ä»¥å®Œå…¨æ§åˆ¶åˆ›å»ºçš„çº¿ç¨‹;</li><li>åœ¨TimerTask ä¸­æŠ›å‡ºçš„è¿è¡Œæ—¶å¼‚å¸¸ä¼šæ€æ­»ä¸€ä¸ªçº¿ç¨‹ï¼Œä»è€Œå¯¼è‡´ Timer æ­»æœº: <ul><li>( ...å³è®¡åˆ’ä»»åŠ¡å°†ä¸å†è¿è¡Œã€‚ScheduledThreadExecutor ä¸ä»…æ•è·è¿è¡Œæ—¶å¼‚å¸¸ï¼Œè¿˜å…è®¸æ‚¨åœ¨éœ€è¦æ—¶å¤„ç†å®ƒä»¬(é€šè¿‡é‡å†™ afterExecute æ–¹æ³•ThreadPoolExecutor)ã€‚æŠ›å‡ºå¼‚å¸¸çš„ä»»åŠ¡å°†è¢«å–æ¶ˆï¼Œä½†å…¶ä»–ä»»åŠ¡å°†ç»§ç»­è¿è¡Œã€‚</li></ul></li></ul><p>ç»¼ä¸Šï¼Œåœ¨ JDK1.5 ä¹‹åï¼Œä½ æ²¡æœ‰ç†ç”±å†ä½¿ç”¨ Timer è¿›è¡Œä»»åŠ¡è°ƒåº¦äº†ã€‚</p><blockquote><p>å¤‡æ³¨ï¼š Quartz æ˜¯ä¸€ä¸ªç”± java ç¼–å†™çš„ä»»åŠ¡è°ƒåº¦åº“ï¼Œç”± OpenSymphony ç»„ç»‡å¼€æºå‡ºæ¥ã€‚åœ¨å®é™…é¡¹ç›®å¼€å‘ä¸­ä½¿ç”¨ Quartz çš„è¿˜æ˜¯å±…å¤šï¼Œæ¯”è¾ƒæ¨èä½¿ç”¨ Quartzã€‚å› ä¸º Quartz ç†è®ºä¸Šèƒ½å¤ŸåŒæ—¶å¯¹ä¸Šä¸‡ä¸ªä»»åŠ¡è¿›è¡Œè°ƒåº¦ï¼Œæ‹¥æœ‰ä¸°å¯Œçš„åŠŸèƒ½ç‰¹æ€§ï¼ŒåŒ…æ‹¬ä»»åŠ¡è°ƒåº¦ã€ä»»åŠ¡æŒä¹…åŒ–ã€å¯é›†ç¾¤åŒ–ã€æ’ä»¶ç­‰ç­‰ã€‚</p></blockquote><div align="center"><p><img src="/cs-way/assets/ScheduledThreadPoolExecutorè¿è¡Œç¤ºæ„.9cead530.png" alt="" title=":size=500" loading="lazy"></p></div><p><strong>ScheduledThreadPoolExecutor çš„æ‰§è¡Œä¸»è¦åˆ†ä¸ºä¸¤å¤§éƒ¨åˆ†ï¼š</strong></p><ol><li>å½“è°ƒç”¨ ScheduledThreadPoolExecutor çš„ scheduleAtFixedRate() æ–¹æ³•æˆ–è€…scheduleWirhFixedDelay() æ–¹æ³•æ—¶ï¼Œä¼šå‘ ScheduledThreadPoolExecutor çš„ DelayQueue æ·»åŠ ä¸€ä¸ªå®ç°äº† RunnableScheduledFuture æ¥å£çš„ ScheduledFutureTask ã€‚</li><li>çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ä» DelayQueue ä¸­è·å– ScheduledFutureTaskï¼Œç„¶åæ‰§è¡Œä»»åŠ¡ã€‚</li></ol><p>ScheduledThreadPoolExecutor ä¸ºäº†å®ç°å‘¨æœŸæ€§çš„æ‰§è¡Œä»»åŠ¡ï¼Œå¯¹ ThreadPoolExecutoråšäº†å¦‚ä¸‹ä¿®æ”¹ï¼š</p><ul><li>ä½¿ç”¨ DelayQueue ä½œä¸ºä»»åŠ¡é˜Ÿåˆ—ï¼›</li><li>è·å–ä»»åŠ¡çš„æ–¹ä¸åŒ</li><li>æ‰§è¡Œå‘¨æœŸä»»åŠ¡åï¼Œå¢åŠ äº†é¢å¤–çš„å¤„ç†</li></ul><p><strong>ScheduledThreadPoolExecutoræ‰§è¡Œå‘¨æœŸä»»åŠ¡çš„æ­¥éª¤</strong></p><div align="center"><p><img src="/cs-way/assets/ScheduledThreadPoolExecutoræ‰§è¡Œå‘¨æœŸä»»åŠ¡è¿è¡Œç¤ºæ„.731d67de.png" alt="" title=":size=500" loading="lazy"></p></div><ol><li>çº¿ç¨‹ 1 ä» DelayQueue ä¸­è·å–å·²åˆ°æœŸçš„ ScheduledFutureTask(DelayQueue.take())ã€‚åˆ°æœŸä»»åŠ¡æ˜¯æŒ‡ ScheduledFutureTaskçš„ time å¤§äºç­‰äºå½“å‰ç³»ç»Ÿçš„æ—¶é—´ï¼›</li><li>çº¿ç¨‹ 1 æ‰§è¡Œè¿™ä¸ª ScheduledFutureTaskï¼›</li><li>çº¿ç¨‹ 1 ä¿®æ”¹ ScheduledFutureTask çš„ time å˜é‡ä¸ºä¸‹æ¬¡å°†è¦è¢«æ‰§è¡Œçš„æ—¶é—´ï¼›</li><li>çº¿ç¨‹ 1 æŠŠè¿™ä¸ªä¿®æ”¹ time ä¹‹åçš„ ScheduledFutureTask æ”¾å› DelayQueue ä¸­(DelayQueue.add())ã€‚</li></ol><h3 id="futuretaskè¯¦è§£" tabindex="-1"><a class="header-anchor" href="#futuretaskè¯¦è§£" aria-hidden="true">#</a> FutureTaskè¯¦è§£</h3><p>FutureTaské™¤äº†å®ç°Futureæ¥å£å¤–ï¼Œè¿˜å®ç°äº†Runnableæ¥å£ã€‚å› æ­¤ï¼ŒFutureTaskå¯ä»¥äº¤ç»™Executoræ‰§è¡Œï¼Œä¹Ÿå¯ä»¥ç”±è°ƒç”¨çº¿ç¨‹ç›´æ¥æ‰§è¡Œ(FutureTask.run())ã€‚æ ¹æ®FutureTask.run()æ–¹æ³•è¢«æ‰§è¡Œçš„æ—¶æœºï¼ŒFutureTaskå¯ä»¥å¤„äºä¸‹é¢3ç§çŠ¶æ€ï¼š</p><ol><li>æœªå¯åŠ¨ã€‚FutureTask.run()æ–¹æ³•è¿˜æ²¡æœ‰è¢«æ‰§è¡Œä¹‹å‰ï¼ŒFutureTaskå¤„äºæœªå¯åŠ¨çŠ¶æ€ã€‚å½“åˆ›å»ºä¸€ä¸ªFutureTaskï¼Œä¸”æ²¡æœ‰æ‰§è¡ŒFutureTask.run()æ–¹æ³•ä¹‹å‰ï¼Œè¿™ä¸ªFutureTaskå¤„äºæœªå¯åŠ¨çŠ¶æ€ã€‚</li><li>å·²å¯åŠ¨ã€‚FutureTask.run()æ–¹æ³•è¢«æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼ŒFutureTaskå¤„äºå·²å¯åŠ¨çŠ¶æ€ã€‚</li><li>å·²å®Œæˆã€‚FutureTask.run()æ–¹æ³•æ‰§è¡Œå®Œåæ­£å¸¸ç»“æŸï¼Œæˆ–è¢«å–æ¶ˆ(FutureTask.cancel(â€¦))ï¼Œæˆ–æ‰§è¡ŒFutureTask.run()æ–¹æ³•æ—¶æŠ›å‡ºå¼‚å¸¸è€Œå¼‚å¸¸ç»“æŸï¼ŒFutureTaskå¤„äºå·²å®ŒæˆçŠ¶æ€</li></ol><p>FutureTaskçš„çŠ¶æ€è¿ç§»çš„ç¤ºæ„:</p><div align="center"><p><img src="/cs-way/assets/FutureTaskçš„çŠ¶æ€è¿ç§»ç¤ºæ„å›¾.0eebc3bc.png" alt="" title=":size=500" loading="lazy"></p></div><p>å½“FutureTaskå¤„äºæœªå¯åŠ¨æˆ–å·²å¯åŠ¨çŠ¶æ€æ—¶ï¼Œæ‰§è¡ŒFutureTask.get()æ–¹æ³•å°†å¯¼è‡´è°ƒç”¨çº¿ç¨‹é˜»å¡ï¼›å½“FutureTaskå¤„äºå·²å®ŒæˆçŠ¶æ€æ—¶ï¼Œæ‰§è¡ŒFutureTask.get()æ–¹æ³•å°†å¯¼è‡´è°ƒç”¨çº¿ç¨‹ç«‹å³è¿”å›ç»“æœæˆ–æŠ›å‡ºå¼‚å¸¸ã€‚</p><p>å½“FutureTaskå¤„äºæœªå¯åŠ¨çŠ¶æ€æ—¶ï¼Œæ‰§è¡ŒFutureTask.cancel()æ–¹æ³•å°†å¯¼è‡´æ­¤ä»»åŠ¡æ°¸è¿œä¸ä¼šè¢«æ‰§è¡Œï¼›å½“FutureTaskå¤„äºå·²å¯åŠ¨çŠ¶æ€æ—¶ï¼Œæ‰§è¡ŒFutureTask.cancel(true)æ–¹æ³•å°†ä»¥ä¸­æ–­æ‰§è¡Œæ­¤ä»»åŠ¡çº¿ç¨‹çš„æ–¹å¼æ¥è¯•å›¾åœæ­¢ä»»åŠ¡ï¼›å½“FutureTaskå¤„äºå·²å¯åŠ¨çŠ¶æ€æ—¶ï¼Œæ‰§è¡ŒFutureTask.cancel(false)æ–¹æ³•å°†ä¸ä¼šå¯¹æ­£åœ¨æ‰§è¡Œæ­¤ä»»åŠ¡çš„çº¿ç¨‹äº§ç”Ÿå½±å“(è®©æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡è¿è¡Œå®Œæˆ)ï¼›å½“FutureTaskå¤„äºå·²å®ŒæˆçŠ¶æ€æ—¶ï¼Œæ‰§è¡ŒFutureTask.cancel(â€¦)æ–¹æ³•å°†è¿”å›falseã€‚</p><p><strong>FutureTask çš„ä½¿ç”¨</strong></p><p>å¯ä»¥æŠŠFutureTaskäº¤ç»™Executoræ‰§è¡Œï¼›ä¹Ÿå¯ä»¥é€šè¿‡ExecutorService.submit(â€¦)æ–¹æ³•è¿”å›ä¸€ä¸ªFutureTaskï¼Œç„¶åæ‰§è¡ŒFutureTask.get()æ–¹æ³•æˆ–FutureTask.cancel(â€¦)æ–¹æ³•ã€‚é™¤æ­¤ä»¥å¤–ï¼Œè¿˜å¯ä»¥å•ç‹¬ä½¿ç”¨FutureTaskã€‚</p><p><strong>FutureTask çš„å®ç°</strong></p><p>FutureTaskçš„å®ç°åŸºäºAbstractQueuedSynchronizer(ä»¥ä¸‹ç®€ç§°ä¸ºAQS)ã€‚</p><p>åŸºäºâ€œå¤åˆä¼˜å…ˆäºç»§æ‰¿â€çš„åŸåˆ™ï¼ŒFutureTaskå£°æ˜äº†ä¸€ä¸ªå†…éƒ¨ç§æœ‰çš„ç»§æ‰¿äºAQSçš„å­ç±»Syncï¼Œå¯¹FutureTaskæ‰€æœ‰å…¬æœ‰æ–¹æ³•çš„è°ƒç”¨éƒ½ä¼šå§”æ‰˜ç»™è¿™ä¸ªå†…éƒ¨å­ç±»ã€‚</p><p>AQSè¢«ä½œä¸ºâ€œæ¨¡æ¿æ–¹æ³•æ¨¡å¼â€çš„åŸºç¡€ç±»æä¾›ç»™FutureTaskçš„å†…éƒ¨å­ç±»Syncï¼Œè¿™ä¸ªå†…éƒ¨å­ç±»åªéœ€è¦å®ç°çŠ¶æ€æ£€æŸ¥å’ŒçŠ¶æ€æ›´æ–°çš„æ–¹æ³•å³å¯ï¼Œè¿™äº›æ–¹æ³•å°†æ§åˆ¶FutureTaskçš„è·å–å’Œé‡Šæ”¾æ“ä½œã€‚å…·ä½“æ¥è¯´ï¼ŒSyncå®ç°äº†AQSçš„tryAcquireShared(int)æ–¹æ³•å’ŒtryReleaseShared(int)æ–¹æ³•ï¼ŒSyncé€šè¿‡è¿™ä¸¤ä¸ªæ–¹æ³•æ¥æ£€æŸ¥å’Œæ›´æ–°åŒæ­¥çŠ¶æ€</p><div align="center"><p><img src="/cs-way/assets/FutureTaskçš„è®¾è®¡ç¤ºæ„å›¾.14ab7277.png" alt="" title=":size=500" loading="lazy"></p></div><p>FutureTask.get()æ–¹æ³•ä¼šè°ƒç”¨AQS.acquireSharedInterruptibly(int arg)æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•çš„æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ã€‚</p><ol><li>è°ƒç”¨AQS.acquireSharedInterruptibly(int arg)æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•é¦–å…ˆä¼šå›è°ƒåœ¨å­ç±»Syncä¸­å®ç°çš„tryAcquireShared()æ–¹æ³•æ¥åˆ¤æ–­acquireæ“ä½œæ˜¯å¦å¯ä»¥æˆåŠŸã€‚acquireæ“ä½œå¯ä»¥æˆåŠŸçš„æ¡ä»¶ä¸ºï¼šstateä¸ºæ‰§è¡Œå®ŒæˆçŠ¶æ€RANæˆ–å·²å–æ¶ˆçŠ¶æ€CANCELLEDï¼Œä¸”runnerä¸ä¸ºnullã€‚</li><li>å¦‚æœæˆåŠŸåˆ™get()æ–¹æ³•ç«‹å³è¿”å›ã€‚å¦‚æœå¤±è´¥åˆ™åˆ°çº¿ç¨‹ç­‰å¾…é˜Ÿåˆ—ä¸­å»ç­‰å¾…å…¶ä»–çº¿ç¨‹æ‰§è¡Œreleaseæ“ä½œã€‚</li><li>å½“å…¶ä»–çº¿ç¨‹æ‰§è¡Œreleaseæ“ä½œ(æ¯”å¦‚FutureTask.run()æˆ–FutureTask.cancel(â€¦))å”¤é†’å½“å‰çº¿ç¨‹åï¼Œå½“å‰çº¿ç¨‹å†æ¬¡æ‰§è¡ŒtryAcquireShared()å°†è¿”å›æ­£å€¼1ï¼Œå½“å‰çº¿ç¨‹å°†ç¦»å¼€çº¿ç¨‹ç­‰å¾…é˜Ÿåˆ—å¹¶å”¤é†’å®ƒçš„åç»§çº¿ç¨‹(è¿™é‡Œä¼šäº§ç”Ÿçº§è”å”¤é†’çš„æ•ˆæœï¼Œåé¢ä¼šä»‹ç»)ã€‚</li><li>æœ€åè¿”å›è®¡ç®—çš„ç»“æœæˆ–æŠ›å‡ºå¼‚å¸¸ã€‚</li></ol><p>FutureTask.run()çš„æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ã€‚</p><ol><li>æ‰§è¡Œåœ¨æ„é€ å‡½æ•°ä¸­æŒ‡å®šçš„ä»»åŠ¡(Callable.call())ã€‚</li><li>ä»¥åŸå­æ–¹å¼æ¥æ›´æ–°åŒæ­¥çŠ¶æ€(è°ƒç”¨AQS.compareAndSetState(int expectï¼Œint update)ï¼Œè®¾ç½®stateä¸ºæ‰§è¡Œå®ŒæˆçŠ¶æ€RAN)ã€‚å¦‚æœè¿™ä¸ªåŸå­æ“ä½œæˆåŠŸï¼Œå°±è®¾ç½®ä»£è¡¨è®¡ç®—ç»“æœçš„å˜é‡resultçš„å€¼ä¸ºCallable.call()çš„è¿”å›å€¼ï¼Œç„¶åè°ƒç”¨AQS.releaseShared(int arg)ã€‚</li><li>AQS.releaseShared(int arg)é¦–å…ˆä¼šå›è°ƒåœ¨å­ç±»Syncä¸­å®ç°çš„tryReleaseShared(arg)æ¥æ‰§è¡Œreleaseæ“ä½œ(è®¾ç½®è¿è¡Œä»»åŠ¡çš„çº¿ç¨‹runnerä¸ºnullï¼Œç„¶ä¼šè¿”å›true)ï¼›AQS.releaseShared(int arg)ï¼Œç„¶åå”¤é†’çº¿ç¨‹ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªçº¿ç¨‹ã€‚</li><li>è°ƒç”¨FutureTask.done()ã€‚</li></ol><p>å½“æ‰§è¡ŒFutureTask.get()æ–¹æ³•æ—¶ï¼Œå¦‚æœFutureTaskä¸æ˜¯å¤„äºæ‰§è¡Œå®ŒæˆçŠ¶æ€RANæˆ–å·²å–æ¶ˆçŠ¶æ€CANCELLEDï¼Œå½“å‰æ‰§è¡Œçº¿ç¨‹å°†åˆ°AQSçš„çº¿ç¨‹ç­‰å¾…é˜Ÿåˆ—ä¸­ç­‰å¾…(è§ä¸‹å›¾çš„çº¿ç¨‹Aã€Bã€Cå’ŒD)ã€‚å½“æŸä¸ªçº¿ç¨‹æ‰§è¡ŒFutureTask.run()æ–¹æ³•æˆ–FutureTask.cancel(...)æ–¹æ³•æ—¶ï¼Œä¼šå”¤é†’çº¿ç¨‹ç­‰å¾…é˜Ÿåˆ—çš„ç¬¬ä¸€ä¸ªçº¿ç¨‹(è§å›¾æ‰€ç¤ºçš„çº¿ç¨‹Eå”¤é†’çº¿ç¨‹A)</p><div align="center"><p><img src="/cs-way/assets/FutureTaskçš„çº§è”å”¤é†’ç¤ºæ„å›¾.06239f91.png" alt="" title=":size=500" loading="lazy"></p></div><p>å‡è®¾å¼€å§‹æ—¶FutureTaskå¤„äºæœªå¯åŠ¨çŠ¶æ€æˆ–å·²å¯åŠ¨çŠ¶æ€ï¼Œç­‰å¾…é˜Ÿåˆ—ä¸­å·²ç»æœ‰3ä¸ªçº¿ç¨‹(Aã€Bå’ŒC)åœ¨ç­‰å¾…ã€‚æ­¤æ—¶ï¼Œçº¿ç¨‹Dæ‰§è¡Œget()æ–¹æ³•å°†å¯¼è‡´çº¿ç¨‹Dä¹Ÿåˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­å»ç­‰å¾…ã€‚</p><p>å½“çº¿ç¨‹Eæ‰§è¡Œrun()æ–¹æ³•æ—¶ï¼Œä¼šå”¤é†’é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªçº¿ç¨‹Aã€‚çº¿ç¨‹Aè¢«å”¤é†’åï¼Œé¦–å…ˆæŠŠè‡ªå·±ä»é˜Ÿåˆ—ä¸­åˆ é™¤ï¼Œç„¶åå”¤é†’å®ƒçš„åç»§çº¿ç¨‹Bï¼Œæœ€åçº¿ç¨‹Aä»get()æ–¹æ³•è¿”å›ã€‚çº¿ç¨‹Bã€Cå’ŒDé‡å¤Açº¿ç¨‹çš„å¤„ç†æµç¨‹ã€‚æœ€ç»ˆï¼Œåœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…çš„æ‰€æœ‰çº¿ç¨‹éƒ½è¢«çº§è”å”¤é†’å¹¶ä»get()æ–¹æ³•è¿”å›</p><h2 id="fork-joinæ¡†æ¶" tabindex="-1"><a class="header-anchor" href="#fork-joinæ¡†æ¶" aria-hidden="true">#</a> Fork/Joinæ¡†æ¶</h2><p>Fork/Joinæ¡†æ¶æ˜¯Java 7æä¾›çš„ä¸€ä¸ªç”¨äºå¹¶è¡Œæ‰§è¡Œä»»åŠ¡çš„æ¡†æ¶ï¼Œæ˜¯ä¸€ä¸ªæŠŠå¤§ä»»åŠ¡åˆ†å‰²æˆè‹¥å¹²ä¸ªå°ä»»åŠ¡ï¼Œæœ€ç»ˆæ±‡æ€»æ¯ä¸ªå°ä»»åŠ¡ç»“æœåå¾—åˆ°å¤§ä»»åŠ¡ç»“æœçš„æ¡†æ¶ã€‚</p><div align="center"><p><img src="/cs-way/assets/Fork-Joinçš„è¿è¡Œæµç¨‹å›¾.0c82e045.png" alt="" title=":size=500" loading="lazy"></p></div><p><strong>å·¥ä½œçªƒå–(work-stealing)ç®—æ³•</strong>ï¼šå‡å¦‚æˆ‘ä»¬éœ€è¦åšä¸€ä¸ªæ¯”è¾ƒå¤§çš„ä»»åŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªä»»åŠ¡åˆ†å‰²ä¸ºè‹¥å¹²äº’ä¸ä¾èµ–çš„å­ä»»åŠ¡ï¼Œä¸ºäº†å‡å°‘çº¿ç¨‹é—´çš„ç«äº‰ï¼Œäºæ˜¯æŠŠè¿™äº›å­ä»»åŠ¡åˆ†åˆ«æ”¾åˆ°ä¸åŒçš„é˜Ÿåˆ—é‡Œï¼Œå¹¶ä¸ºæ¯ä¸ªé˜Ÿåˆ—åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹æ¥æ‰§è¡Œé˜Ÿåˆ—é‡Œçš„ä»»åŠ¡ï¼Œçº¿ç¨‹å’Œé˜Ÿåˆ—ä¸€ä¸€å¯¹åº”ï¼Œæ¯”å¦‚Açº¿ç¨‹è´Ÿè´£å¤„ç†Aé˜Ÿåˆ—é‡Œçš„ä»»åŠ¡ã€‚ä½†æ˜¯æœ‰çš„çº¿ç¨‹ä¼šå…ˆæŠŠè‡ªå·±é˜Ÿåˆ—é‡Œçš„ä»»åŠ¡å¹²å®Œï¼Œè€Œå…¶ä»–çº¿ç¨‹å¯¹åº”çš„é˜Ÿåˆ—é‡Œè¿˜æœ‰ä»»åŠ¡ç­‰å¾…å¤„ç†ã€‚å¹²å®Œæ´»çš„çº¿ç¨‹ä¸å…¶ç­‰ç€ï¼Œä¸å¦‚å»å¸®å…¶ä»–çº¿ç¨‹å¹²æ´»ï¼Œäºæ˜¯å®ƒå°±å»å…¶ä»–çº¿ç¨‹çš„é˜Ÿåˆ—é‡Œçªƒå–ä¸€ä¸ªä»»åŠ¡æ¥æ‰§è¡Œã€‚è€Œåœ¨è¿™æ—¶å®ƒä»¬ä¼šè®¿é—®åŒä¸€ä¸ªé˜Ÿåˆ—ï¼Œæ‰€ä»¥ä¸ºäº†å‡å°‘çªƒå–ä»»åŠ¡çº¿ç¨‹å’Œè¢«çªƒå–ä»»åŠ¡çº¿ç¨‹ä¹‹é—´çš„ç«äº‰ï¼Œé€šå¸¸ä¼šä½¿ç”¨åŒç«¯é˜Ÿåˆ—ï¼Œè¢«çªƒå–ä»»åŠ¡çº¿ç¨‹æ°¸è¿œä»åŒç«¯é˜Ÿåˆ—çš„å¤´éƒ¨æ‹¿ä»»åŠ¡æ‰§è¡Œï¼Œè€Œçªƒå–ä»»åŠ¡çš„çº¿ç¨‹æ°¸è¿œä»åŒç«¯é˜Ÿåˆ—çš„å°¾éƒ¨æ‹¿ä»»åŠ¡æ‰§è¡Œã€‚</p><ul><li>å·¥ä½œçªƒå–ç®—æ³•çš„ä¼˜ç‚¹æ˜¯å……åˆ†åˆ©ç”¨çº¿ç¨‹è¿›è¡Œå¹¶è¡Œè®¡ç®—ï¼Œå¹¶å‡å°‘äº†çº¿ç¨‹é—´çš„ç«äº‰ï¼Œ</li><li>ç¼ºç‚¹æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹è¿˜æ˜¯å­˜åœ¨ç«äº‰ï¼Œæ¯”å¦‚åŒç«¯é˜Ÿåˆ—é‡Œåªæœ‰ä¸€ä¸ªä»»åŠ¡æ—¶ã€‚å¹¶ä¸”æ¶ˆè€—äº†æ›´å¤šçš„ç³»ç»Ÿèµ„æºï¼Œæ¯”å¦‚åˆ›å»ºå¤šä¸ªçº¿ç¨‹å’Œå¤šä¸ªåŒç«¯é˜Ÿåˆ—ã€‚</li></ul><h3 id="fork-joinæ¡†æ¶çš„è®¾è®¡" tabindex="-1"><a class="header-anchor" href="#fork-joinæ¡†æ¶çš„è®¾è®¡" aria-hidden="true">#</a> Fork/Joinæ¡†æ¶çš„è®¾è®¡</h3><ul><li>æ­¥éª¤1 åˆ†å‰²ä»»åŠ¡ã€‚é¦–å…ˆæˆ‘ä»¬éœ€è¦æœ‰ä¸€ä¸ªforkç±»æ¥æŠŠå¤§ä»»åŠ¡åˆ†å‰²æˆå­ä»»åŠ¡ï¼Œæœ‰å¯èƒ½å­ä»»åŠ¡è¿˜æ˜¯å¾ˆå¤§ï¼Œæ‰€ä»¥è¿˜éœ€è¦ä¸åœåœ°åˆ†å‰²ï¼Œç›´åˆ°åˆ†å‰²å‡ºçš„å­ä»»åŠ¡è¶³å¤Ÿå°ã€‚</li><li>æ­¥éª¤2 æ‰§è¡Œä»»åŠ¡å¹¶åˆå¹¶ç»“æœã€‚åˆ†å‰²çš„å­ä»»åŠ¡åˆ†åˆ«æ”¾åœ¨åŒç«¯é˜Ÿåˆ—é‡Œï¼Œç„¶åå‡ ä¸ªå¯åŠ¨çº¿ç¨‹åˆ†åˆ«ä»åŒç«¯é˜Ÿåˆ—é‡Œè·å–ä»»åŠ¡æ‰§è¡Œã€‚å­ä»»åŠ¡æ‰§è¡Œå®Œçš„ç»“æœéƒ½ç»Ÿä¸€æ”¾åœ¨ä¸€ä¸ªé˜Ÿåˆ—é‡Œï¼Œå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ä»é˜Ÿåˆ—é‡Œæ‹¿æ•°æ®ï¼Œç„¶ååˆå¹¶è¿™äº›æ•°æ®ã€‚</li></ul><p>Fork/Joinä½¿ç”¨ä¸¤ä¸ªç±»æ¥å®Œæˆä»¥ä¸Šä¸¤ä»¶äº‹æƒ…</p><ul><li>ForkJoinTaskï¼šæˆ‘ä»¬è¦ä½¿ç”¨ForkJoinæ¡†æ¶ï¼Œå¿…é¡»é¦–å…ˆåˆ›å»ºä¸€ä¸ªForkJoinä»»åŠ¡ã€‚å®ƒæä¾›åœ¨ä»»åŠ¡ä¸­æ‰§è¡Œfork()å’Œjoin()æ“ä½œçš„æœºåˆ¶ï¼Œé€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬ä¸éœ€è¦ç›´æ¥ç»§æ‰¿ForkJoinTaskç±»ï¼Œè€Œåªéœ€è¦ç»§æ‰¿å®ƒçš„å­ç±»ï¼ŒFork/Joinæ¡†æ¶æä¾›äº†ä»¥ä¸‹ä¸¤ä¸ªå­ç±»ï¼š <ul><li>RecursiveActionï¼šç”¨äºæ²¡æœ‰è¿”å›ç»“æœçš„ä»»åŠ¡ã€‚</li><li>RecursiveTask ï¼šç”¨äºæœ‰è¿”å›ç»“æœçš„ä»»åŠ¡ã€‚</li></ul></li><li>ForkJoinPool ï¼šForkJoinTaskéœ€è¦é€šè¿‡ForkJoinPoolæ¥æ‰§è¡Œï¼Œä»»åŠ¡åˆ†å‰²å‡ºçš„å­ä»»åŠ¡ä¼šæ·»åŠ åˆ°å½“å‰å·¥ä½œçº¿ç¨‹æ‰€ç»´æŠ¤çš„åŒç«¯é˜Ÿåˆ—ä¸­ï¼Œè¿›å…¥é˜Ÿåˆ—çš„å¤´éƒ¨ã€‚å½“ä¸€ä¸ªå·¥ä½œçº¿ç¨‹çš„é˜Ÿåˆ—é‡Œæš‚æ—¶æ²¡æœ‰ä»»åŠ¡æ—¶ï¼Œå®ƒä¼šéšæœºä»å…¶ä»–å·¥ä½œçº¿ç¨‹çš„é˜Ÿåˆ—çš„å°¾éƒ¨è·å–ä¸€ä¸ªä»»åŠ¡ã€‚</li></ul><h3 id="fork-joinæ¡†æ¶çš„ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#fork-joinæ¡†æ¶çš„ä½¿ç”¨" aria-hidden="true">#</a> Fork/Joinæ¡†æ¶çš„ä½¿ç”¨</h3><p>ForkJoinTaskä¸ä¸€èˆ¬ä»»åŠ¡çš„ä¸»è¦åŒºåˆ«åœ¨äºå®ƒéœ€è¦å®ç°computeæ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•é‡Œï¼Œé¦–å…ˆéœ€è¦åˆ¤æ–­ä»»åŠ¡æ˜¯å¦è¶³å¤Ÿå°ï¼Œå¦‚æœè¶³å¤Ÿå°å°±ç›´æ¥æ‰§è¡Œä»»åŠ¡ã€‚å¦‚æœä¸è¶³å¤Ÿå°ï¼Œå°±å¿…é¡»åˆ†å‰²æˆä¸¤ä¸ªå­ä»»åŠ¡ï¼Œæ¯ä¸ªå­ä»»åŠ¡åœ¨è°ƒç”¨forkæ–¹æ³•æ—¶ï¼Œåˆä¼šè¿›å…¥computeæ–¹æ³•ï¼Œçœ‹çœ‹å½“å‰å­ä»»åŠ¡æ˜¯å¦éœ€è¦ç»§ç»­åˆ†å‰²æˆå­ä»»åŠ¡ï¼Œå¦‚æœä¸éœ€è¦ç»§ç»­åˆ†å‰²ï¼Œåˆ™æ‰§è¡Œå½“å‰å­ä»»åŠ¡å¹¶è¿”å›ç»“æœã€‚ä½¿ç”¨joinæ–¹æ³•ä¼šç­‰å¾…å­ä»»åŠ¡æ‰§è¡Œå®Œå¹¶å¾—åˆ°å…¶ç»“æœã€‚</p><p>ForkJoinTaskåœ¨æ‰§è¡Œçš„æ—¶å€™å¯èƒ½ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡åŠæ³•åœ¨ä¸»çº¿ç¨‹é‡Œç›´æ¥æ•è·å¼‚å¸¸ï¼Œæ‰€ä»¥ForkJoinTaskæä¾›äº†isCompletedAbnormally()æ–¹æ³•æ¥æ£€æŸ¥ä»»åŠ¡æ˜¯å¦ä¸€ä»¶æŠ›å‡ºå¼‚å¸¸æˆ–å·²ç»è¢«å–æ¶ˆäº†ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ForkJoinTaskçš„getExceptionæ–¹æ³•è·å–å¼‚å¸¸ã€‚å…¶ä¸­ï¼ŒgetExceptionæ–¹æ³•è¿”å›Throwableå¯¹è±¡ï¼Œå¦‚æœä»»åŠ¡è¢«å–æ¶ˆäº†åˆ™è¿”å›CancellationExceptionï¼Œå¦‚æœä»»åŠ¡æ²¡æœ‰å®Œæˆæˆ–è€…æ²¡æœ‰æŠ›å‡ºå¼‚å¸¸åˆ™è¿”å›nullã€‚</p><h3 id="fork-joinæ¡†æ¶çš„å®ç°åŸç†" tabindex="-1"><a class="header-anchor" href="#fork-joinæ¡†æ¶çš„å®ç°åŸç†" aria-hidden="true">#</a> Fork/Joinæ¡†æ¶çš„å®ç°åŸç†</h3><p>ForkJoinPoolç”±ForkJoinTaskæ•°ç»„å’ŒForkJoinWorkerThreadæ•°ç»„ç»„æˆï¼ŒForkJoinTaskæ•°ç»„è´Ÿè´£å°†å­˜æ”¾ç¨‹åºæäº¤ç»™ForkJoinPoolçš„ä»»åŠ¡ï¼Œè€ŒForkJoinWorkerThreadæ•°ç»„è´Ÿè´£æ‰§è¡Œè¿™äº›ä»»åŠ¡</p><ol><li>ForkJoinTaskçš„<strong>fork</strong>æ–¹æ³•å®ç°åŸç†<br> å½“æˆ‘ä»¬è°ƒç”¨ForkJoinTaskçš„forkæ–¹æ³•æ—¶ï¼Œç¨‹åºä¼šè°ƒç”¨ForkJoinWorkerThreadçš„pushTaskæ–¹æ³•å¼‚æ­¥åœ°æ‰§è¡Œè¿™ä¸ªä»»åŠ¡ï¼Œç„¶åç«‹å³è¿”å›ç»“æœã€‚</li></ol><div class="language-java ext-java"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">ForkJoinTask</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">ForkJoinWorkerThread</span><span class="token punctuation">)</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">pushTask</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>pushTaskæ–¹æ³•æŠŠå½“å‰ä»»åŠ¡å­˜æ”¾åœ¨ForkJoinTaskæ•°ç»„é˜Ÿåˆ—é‡Œã€‚ç„¶åå†è°ƒç”¨ForkJoinPoolçš„signalWork()æ–¹æ³•å”¤é†’æˆ–åˆ›å»ºä¸€ä¸ªå·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">pushTask</span><span class="token punctuation">(</span><span class="token class-name">ForkJoinTask</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ForkJoinTask</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> q<span class="token punctuation">;</span> <span class="token keyword">int</span> s<span class="token punctuation">,</span> m<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>q <span class="token operator">=</span> queue<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// ignore if queue removed</span>
            <span class="token keyword">long</span> u <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s <span class="token operator">=</span> queueTop<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>m <span class="token operator">=</span> q<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> ASHIFT<span class="token punctuation">)</span> <span class="token operator">+</span> ABASE<span class="token punctuation">;</span>
            UNSAFE<span class="token punctuation">.</span><span class="token function">putOrderedObject</span><span class="token punctuation">(</span>q<span class="token punctuation">,</span> u<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>
            queueTop <span class="token operator">=</span> s <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// or use putOrderedInt</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>s <span class="token operator">-=</span> queueBase<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">2</span><span class="token punctuation">)</span>
                pool<span class="token punctuation">.</span><span class="token function">signalWork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">==</span> m<span class="token punctuation">)</span>
                <span class="token function">growQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ol start="2"><li>ForkJoinTaskçš„<strong>join</strong>æ–¹æ³•å®ç°åŸç†<br> Joinæ–¹æ³•çš„ä¸»è¦ä½œç”¨æ˜¯é˜»å¡å½“å‰çº¿ç¨‹å¹¶ç­‰å¾…è·å–ç»“æœ</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">V</span> <span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">doJoin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> NORMAL<span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token function">reportResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            <span class="token keyword">return</span> <span class="token function">getRawResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">V</span> <span class="token function">reportResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> s<span class="token punctuation">;</span>
        <span class="token class-name">Throwable</span> ex<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>s <span class="token operator">=</span> status<span class="token punctuation">)</span> <span class="token operator">==</span> CANCELLED<span class="token punctuation">)</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">CancellationException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">==</span> EXCEPTIONAL <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>ex <span class="token operator">=</span> <span class="token function">getThrowableException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            UNSAFE<span class="token punctuation">.</span><span class="token function">throwException</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">getRawResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>é¦–å…ˆï¼Œå®ƒè°ƒç”¨äº†doJoin()æ–¹æ³•ï¼Œé€šè¿‡doJoin()æ–¹æ³•å¾—åˆ°å½“å‰ä»»åŠ¡çš„çŠ¶æ€æ¥åˆ¤æ–­è¿”å›ä»€ä¹ˆç»“æœï¼Œä»»åŠ¡çŠ¶æ€æœ‰4ç§ï¼šå·²å®Œæˆ(NORMAL)ã€è¢«å–æ¶ˆ(CANCELLED)ã€ä¿¡å·(SIGNAL)å’Œå‡ºç°å¼‚å¸¸(EXCEPTIONAL)ã€‚</p><ul><li>å¦‚æœä»»åŠ¡çŠ¶æ€æ˜¯å·²å®Œæˆï¼Œåˆ™ç›´æ¥è¿”å›ä»»åŠ¡ç»“æœã€‚</li><li>å¦‚æœä»»åŠ¡çŠ¶æ€æ˜¯è¢«å–æ¶ˆï¼Œåˆ™ç›´æ¥æŠ›å‡ºCancellationExceptionã€‚</li><li>å¦‚æœä»»åŠ¡çŠ¶æ€æ˜¯æŠ›å‡ºå¼‚å¸¸ï¼Œåˆ™ç›´æ¥æŠ›å‡ºå¯¹åº”çš„å¼‚å¸¸ã€‚</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">doJoin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span> t<span class="token punctuation">;</span>
        <span class="token class-name">ForkJoinWorkerThread</span> w<span class="token punctuation">;</span>
        <span class="token keyword">int</span> s<span class="token punctuation">;</span>
        <span class="token keyword">boolean</span> completed<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>t <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">instanceof</span> <span class="token class-name">ForkJoinWorkerThread</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>s <span class="token operator">=</span> status<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> s<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>w <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ForkJoinWorkerThread</span><span class="token punctuation">)</span> t<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unpushTask</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    completed <span class="token operator">=</span> <span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> rex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> <span class="token function">setExceptionalCompletion</span><span class="token punctuation">(</span>rex<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>completed<span class="token punctuation">)</span>
                    <span class="token keyword">return</span> <span class="token function">setCompletion</span><span class="token punctuation">(</span>NORMAL<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> w<span class="token punctuation">.</span><span class="token function">joinTask</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span>
            <span class="token keyword">return</span> <span class="token function">externalAwaitDone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>åœ¨doJoin()æ–¹æ³•é‡Œï¼Œé¦–å…ˆé€šè¿‡æŸ¥çœ‹ä»»åŠ¡çš„çŠ¶æ€ï¼Œçœ‹ä»»åŠ¡æ˜¯å¦å·²ç»æ‰§è¡Œå®Œæˆï¼Œå¦‚æœæ‰§è¡Œå®Œæˆï¼Œåˆ™ç›´æ¥è¿”å›ä»»åŠ¡çŠ¶æ€ï¼›å¦‚æœæ²¡æœ‰æ‰§è¡Œå®Œï¼Œåˆ™ä»ä»»åŠ¡æ•°ç»„é‡Œå–å‡ºä»»åŠ¡å¹¶æ‰§è¡Œã€‚å¦‚æœä»»åŠ¡é¡ºåˆ©æ‰§è¡Œå®Œæˆï¼Œåˆ™è®¾ç½®ä»»åŠ¡çŠ¶æ€ä¸ºNORMALï¼Œå¦‚æœå‡ºç°å¼‚å¸¸ï¼Œåˆ™è®°å½•å¼‚å¸¸ï¼Œå¹¶å°†ä»»åŠ¡çŠ¶æ€è®¾ç½®ä¸ºEXCEPTIONALã€‚</p><h1 id="å‚è€ƒèµ„æ–™" tabindex="-1"><a class="header-anchor" href="#å‚è€ƒèµ„æ–™" aria-hidden="true">#</a> å‚è€ƒèµ„æ–™</h1><ul><li>BruceEckel. Java ç¼–ç¨‹æ€æƒ³: ç¬¬ 4 ç‰ˆ [M]. æœºæ¢°å·¥ä¸šå‡ºç‰ˆç¤¾, 2007.</li><li>å‘¨å¿—æ˜. æ·±å…¥ç†è§£ Java è™šæ‹Ÿæœº [M]. æœºæ¢°å·¥ä¸šå‡ºç‰ˆç¤¾, 2011.</li><li><a href="https://docs.oracle.com/javase/specs/jvms/se6/html/Threads.doc.html" target="_blank" rel="noopener noreferrer">Threads and Locks<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="http://ifeve.com/thread-signaling/#missed_signal" target="_blank" rel="noopener noreferrer">çº¿ç¨‹é€šä¿¡<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="http://www.importnew.com/12773.html" target="_blank" rel="noopener noreferrer">Java çº¿ç¨‹é¢è¯•é¢˜ Top 50<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="http://tutorials.jenkov.com/java-util-concurrent/blockingqueue.html" target="_blank" rel="noopener noreferrer">BlockingQueue<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://stackoverflow.com/questions/11265289/thread-state-java" target="_blank" rel="noopener noreferrer">thread state java<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="http://wiki.expertiza.ncsu.edu/index.php/CSC_456_Spring_2012/ch7_MN" target="_blank" rel="noopener noreferrer">CSC 456 Spring 2012/ch7 MN<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.logicbig.com/tutorials/core-java-tutorial/java-multi-threading/happens-before.html" target="_blank" rel="noopener noreferrer">Java - Understanding Happens-before relationship<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.slideshare.net/novathinker/6-thread-synchronization" target="_blank" rel="noopener noreferrer">6ì¥ Thread Synchronization<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://stackoverflow.com/questions/1202444/how-is-javas-threadlocal-implemented-under-the-hood/15653015" target="_blank" rel="noopener noreferrer">How is Java&#39;s ThreadLocal implemented under the hood?<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://sites.google.com/site/webdevelopart/21-compile/06-java/javase/concurrent?tmpl=%2Fsystem%2Fapp%2Ftemplates%2Fprint%2F&amp;showPrintDialog=1" target="_blank" rel="noopener noreferrer">Concurrent<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="http://www.javacreed.com/java-fork-join-example/" title="Java Fork Join Example" target="_blank" rel="noopener noreferrer">JAVA FORK JOIN EXAMPLE<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="http://ifeve.com/talk-concurrency-forkjoin/" target="_blank" rel="noopener noreferrer">èŠèŠå¹¶å‘(å…«)â€”â€”Fork/Join æ¡†æ¶ä»‹ç»<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="http://www.oracle.com/technetwork/java/javase/tech/biasedlocking-oopsla2006-preso-150106.pdf" target="_blank" rel="noopener noreferrer">Eliminating SynchronizationRelated Atomic Operations with Biased Locking and Bulk Rebiasing<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><!--]--></div><!----><footer class="page-meta"><!----><div class="meta-item update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><span class="info">2022/5/16 12:07:59</span></div><div class="meta-item contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: chenwei.tjw@alibaba-inc.com">chenwei.tjw</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/cs-way/notes/Java/Java%E5%B9%B6%E5%8F%91%E5%9F%BA%E7%A1%80.html" class="nav-link prev" aria-label="ä¸€ã€çº¿ç¨‹"><div class="hint"><span class="arrow left"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->ä¸€ã€çº¿ç¨‹</div></a><a href="/cs-way/notes/Java/Java%E5%9F%BA%E7%A1%80.html" class="nav-link next" aria-label="ä¸€ã€æ•°æ®ç±»å‹"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow right"></span></div><div class="link">ä¸€ã€æ•°æ®ç±»å‹<!----></div></a></nav><div class="giscus-wrapper input-top" style="display:block;"></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">é»˜è®¤é¡µè„š</div><div class="copyright">Copyright Â© 2022 Vika</div></footer><!--]--></div><!--]--><!----><!----><div id="pwa-install"><!----><div id="install-modal-wrapper" style="display:none;"><div class="background"></div><div class="install-modal"><div class="header"><button class="close-button" aria-label="å…³é—­"><svg xmlns="http://www.w3.org/2000/svg" class="icon close-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="close icon"><path d="M589.654 511.965 1007.212 84.22a49.777 49.777 0 0 0-.73-70.02 49.046 49.046 0 0 0-69.687.665L519.967 441.946 85.882 14.2a49.08 49.08 0 0 0-69.687.664 49.777 49.777 0 0 0 .664 70.019l433.454 427.082L16.859 939.048a49.777 49.777 0 0 0-.664 70.019 49.013 49.013 0 0 0 69.687.663l434.085-427.746 416.828 427.083A49.013 49.013 0 0 0 972.037 1024a48.416 48.416 0 0 0 34.512-14.27 49.777 49.777 0 0 0 .73-70.019z"></path></svg></button><div class="logo"><!----><div class="title"><h1></h1><p class="desc">è¯¥åº”ç”¨å¯ä»¥å®‰è£…åœ¨ä½ çš„ PC æˆ–ç§»åŠ¨è®¾å¤‡ä¸Šã€‚è¿™å°†ä½¿è¯¥ Web åº”ç”¨ç¨‹åºå¤–è§‚å’Œè¡Œä¸ºä¸å…¶ä»–åº”ç”¨ç¨‹åºç›¸åŒã€‚å®ƒå°†åœ¨å‡ºç°åœ¨åº”ç”¨ç¨‹åºåˆ—è¡¨ä¸­ï¼Œå¹¶å¯ä»¥å›ºå®šåˆ°ä¸»å±å¹•ï¼Œå¼€å§‹èœå•æˆ–ä»»åŠ¡æ ã€‚æ­¤ Web åº”ç”¨ç¨‹åºè¿˜å°†èƒ½å¤Ÿä¸å…¶ä»–åº”ç”¨ç¨‹åºå’Œä½ çš„æ“ä½œç³»ç»Ÿå®‰å…¨åœ°è¿›è¡Œäº¤äº’ã€‚</p></div></div></div><div class="content"><div class="highlight"><!----><!----></div><div class="description"><h3>è¯¦æƒ…</h3><p></p></div></div><div class="button-wrapper"><button class="install-button">å®‰è£…<span></span></button><button class="cancel-button">å–æ¶ˆ</button></div></div></div></div><!--]--></div>
    <script type="module" src="/cs-way/assets/app.7d4bd0aa.js" defer></script>
  </body>
</html>
