import{_ as l}from"./plugin-vue_export-helper.21dcd24c.js";import{r as i,c as r,a as e,b as n,F as p,f as t,d as s,o as c}from"./app.e9c8698e.js";var d="/cs-way/assets/mk-2020-09-01-09-54-41.311ed536.png",o="/cs-way/assets/mk-2020-09-01-10-39-00.d26c22b2.png",h="/cs-way/assets/mk-2020-07-12-17-24-38.ab291de9.png",u="/cs-way/assets/mk-2020-07-12-17-24-26.7b53ab26.png";const b={},m=t('<ul><li><a href="#%E4%B8%80%E6%A6%82%E8%BF%B0">\u4E00\u3001\u6982\u8FF0</a></li><li><a href="#%E4%BA%8C%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B">\u4E8C\u3001\u6570\u636E\u7C7B\u578B</a><ul><li><a href="#string">STRING</a><ul><li><a href="#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E7%8E%B0">\u6570\u636E\u7ED3\u6784\u5B9E\u73B0</a></li></ul></li><li><a href="#list">LIST</a><ul><li><a href="#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E7%8E%B0-1">\u6570\u636E\u7ED3\u6784\u5B9E\u73B0</a></li></ul></li><li><a href="#set">SET</a><ul><li><a href="#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E7%8E%B0-2">\u6570\u636E\u7ED3\u6784\u5B9E\u73B0</a></li></ul></li><li><a href="#hash">HASH</a><ul><li><a href="#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E7%8E%B0-3">\u6570\u636E\u7ED3\u6784\u5B9E\u73B0</a></li></ul></li><li><a href="#zset">ZSET</a><ul><li><a href="#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E7%8E%B0-4">\u6570\u636E\u7ED3\u6784\u5B9E\u73B0</a></li></ul></li></ul></li><li><a href="#%E4%B8%89%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF">\u4E09\u3001\u4F7F\u7528\u573A\u666F</a><ul><li><a href="#%E8%AE%A1%E6%95%B0%E5%99%A8">\u8BA1\u6570\u5668</a></li><li><a href="#%E7%BC%93%E5%AD%98">\u7F13\u5B58</a></li><li><a href="#%E6%9F%A5%E6%89%BE%E8%A1%A8">\u67E5\u627E\u8868</a></li><li><a href="#%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97">\u6D88\u606F\u961F\u5217</a></li><li><a href="#%E4%BC%9A%E8%AF%9D%E7%BC%93%E5%AD%98">\u4F1A\u8BDD\u7F13\u5B58</a></li><li><a href="#%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E5%AE%9E%E7%8E%B0">\u5206\u5E03\u5F0F\u9501\u5B9E\u73B0</a></li><li><a href="#%E5%85%B6%E5%AE%83">\u5176\u5B83</a></li></ul></li><li><a href="#%E5%9B%9Bredis-%E4%B8%8E-memcached">\u56DB\u3001Redis \u4E0E Memcached</a><ul><li><a href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B">\u6570\u636E\u7C7B\u578B</a></li><li><a href="#%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%8C%96">\u6570\u636E\u6301\u4E45\u5316</a></li><li><a href="#%E5%88%86%E5%B8%83%E5%BC%8F">\u5206\u5E03\u5F0F</a></li><li><a href="#%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%9C%BA%E5%88%B6">\u5185\u5B58\u7BA1\u7406\u673A\u5236</a></li></ul></li><li><a href="#%E4%BA%94%E9%94%AE%E7%9A%84%E8%BF%87%E6%9C%9F%E6%97%B6%E9%97%B4">\u4E94\u3001\u952E\u7684\u8FC7\u671F\u65F6\u95F4</a><ul><li><a href="#%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5">\u5220\u9664\u7B56\u7565</a></li></ul></li><li><a href="#%E5%85%AD%E6%95%B0%E6%8D%AE%E6%B7%98%E6%B1%B0%E7%AD%96%E7%95%A5">\u516D\u3001\u6570\u636E\u6DD8\u6C70\u7B56\u7565</a></li><li><a href="#%E4%B8%83%E6%8C%81%E4%B9%85%E5%8C%96">\u4E03\u3001\u6301\u4E45\u5316</a><ul><li><a href="#rdb-%E6%8C%81%E4%B9%85%E5%8C%96-%E5%85%A8%E9%87%8F%E6%A8%A1%E5%BC%8F%E6%8C%81%E4%B9%85%E5%8C%96">RDB \u6301\u4E45\u5316 \u5168\u91CF\u6A21\u5F0F\u6301\u4E45\u5316</a></li><li><a href="#aof-%E6%8C%81%E4%B9%85%E5%8C%96-%E5%A2%9E%E9%87%8F%E6%A8%A1%E5%BC%8F%E6%8C%81%E4%B9%85%E5%8C%96">AOF \u6301\u4E45\u5316 \u589E\u91CF\u6A21\u5F0F\u6301\u4E45\u5316</a></li></ul></li><li><a href="#%E5%85%AB%E4%BA%8B%E5%8A%A1">\u516B\u3001\u4E8B\u52A1</a></li><li><a href="#%E4%B9%9D%E4%BA%8B%E4%BB%B6">\u4E5D\u3001\u4E8B\u4EF6</a><ul><li><a href="#%E6%96%87%E4%BB%B6%E4%BA%8B%E4%BB%B6">\u6587\u4EF6\u4E8B\u4EF6</a></li><li><a href="#%E6%97%B6%E9%97%B4%E4%BA%8B%E4%BB%B6">\u65F6\u95F4\u4E8B\u4EF6</a></li><li><a href="#%E4%BA%8B%E4%BB%B6%E7%9A%84%E8%B0%83%E5%BA%A6%E4%B8%8E%E6%89%A7%E8%A1%8C">\u4E8B\u4EF6\u7684\u8C03\u5EA6\u4E0E\u6267\u884C</a></li></ul></li><li><a href="#%E5%8D%81%E5%A4%8D%E5%88%B6">\u5341\u3001\u590D\u5236</a><ul><li><a href="#%E8%BF%9E%E6%8E%A5%E8%BF%87%E7%A8%8B">\u8FDE\u63A5\u8FC7\u7A0B</a></li><li><a href="#%E4%B8%BB%E4%BB%8E%E9%93%BE">\u4E3B\u4ECE\u94FE</a></li></ul></li><li><a href="#%E5%8D%81%E4%B8%80sentinel">\u5341\u4E00\u3001Sentinel</a></li><li><a href="#%E5%8D%81%E4%BA%8C%E5%88%86%E7%89%87">\u5341\u4E8C\u3001\u5206\u7247</a></li><li><a href="#%E5%8D%81%E4%B8%89%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E8%AE%BA%E5%9D%9B%E7%B3%BB%E7%BB%9F%E5%88%86%E6%9E%90">\u5341\u4E09\u3001\u4E00\u4E2A\u7B80\u5355\u7684\u8BBA\u575B\u7CFB\u7EDF\u5206\u6790</a><ul><li><a href="#%E6%96%87%E7%AB%A0%E4%BF%A1%E6%81%AF">\u6587\u7AE0\u4FE1\u606F</a></li><li><a href="#%E7%82%B9%E8%B5%9E%E5%8A%9F%E8%83%BD">\u70B9\u8D5E\u529F\u80FD</a></li><li><a href="#%E5%AF%B9%E6%96%87%E7%AB%A0%E8%BF%9B%E8%A1%8C%E6%8E%92%E5%BA%8F">\u5BF9\u6587\u7AE0\u8FDB\u884C\u6392\u5E8F</a></li></ul></li><li><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">\u53C2\u8003\u8D44\u6599</a></li></ul><h1 id="\u4E00\u3001\u6982\u8FF0" tabindex="-1"><a class="header-anchor" href="#\u4E00\u3001\u6982\u8FF0" aria-hidden="true">#</a> \u4E00\u3001\u6982\u8FF0</h1><p>Redis \u662F\u901F\u5EA6\u975E\u5E38\u5FEB\u7684\u975E\u5173\u7CFB\u578B\uFF08NoSQL\uFF09\u5185\u5B58\u952E\u503C\u6570\u636E\u5E93\uFF0C\u53EF\u4EE5\u5B58\u50A8\u952E\u548C\u4E94\u79CD\u4E0D\u540C\u7C7B\u578B\u7684\u503C\u4E4B\u95F4\u7684\u6620\u5C04\u3002</p><p>\u952E\u7684\u7C7B\u578B\u53EA\u80FD\u4E3A\u5B57\u7B26\u4E32\uFF0C\u503C\u652F\u6301\u4E94\u79CD\u6570\u636E\u7C7B\u578B\uFF1A\u5B57\u7B26\u4E32\u3001\u5217\u8868\u3001\u96C6\u5408\u3001\u6563\u5217\u8868\u3001\u6709\u5E8F\u96C6\u5408\u3002</p><p>Redis \u652F\u6301\u5F88\u591A\u7279\u6027\uFF0C\u4F8B\u5982\u5C06\u5185\u5B58\u4E2D\u7684\u6570\u636E\u6301\u4E45\u5316\u5230\u786C\u76D8\u4E2D\uFF0C\u4F7F\u7528\u590D\u5236\u6765\u6269\u5C55\u8BFB\u6027\u80FD\uFF0C\u4F7F\u7528\u5206\u7247\u6765\u6269\u5C55\u5199\u6027\u80FD\u3002</p><h1 id="\u4E8C\u3001\u6570\u636E\u7C7B\u578B" tabindex="-1"><a class="header-anchor" href="#\u4E8C\u3001\u6570\u636E\u7C7B\u578B" aria-hidden="true">#</a> \u4E8C\u3001\u6570\u636E\u7C7B\u578B</h1><table><thead><tr><th style="text-align:center;">\u6570\u636E\u7C7B\u578B</th><th style="text-align:center;">\u53EF\u4EE5\u5B58\u50A8\u7684\u503C</th><th style="text-align:center;">\u64CD\u4F5C</th></tr></thead><tbody><tr><td style="text-align:center;">STRING</td><td style="text-align:center;">\u5B57\u7B26\u4E32\u3001\u6574\u6570\u6216\u8005\u6D6E\u70B9\u6570</td><td style="text-align:center;">\u5BF9\u6574\u4E2A\u5B57\u7B26\u4E32\u6216\u8005\u5B57\u7B26\u4E32\u7684\u5176\u4E2D\u4E00\u90E8\u5206\u6267\u884C\u64CD\u4F5C<br> \u5BF9\u6574\u6570\u548C\u6D6E\u70B9\u6570\u6267\u884C\u81EA\u589E\u6216\u8005\u81EA\u51CF\u64CD\u4F5C</td></tr><tr><td style="text-align:center;">LIST</td><td style="text-align:center;">\u5217\u8868</td><td style="text-align:center;">\u4ECE\u4E24\u7AEF\u538B\u5165\u6216\u8005\u5F39\u51FA\u5143\u7D20 <br> \u5BF9\u5355\u4E2A\u6216\u8005\u591A\u4E2A\u5143\u7D20\u8FDB\u884C\u4FEE\u526A\uFF0C<br> \u53EA\u4FDD\u7559\u4E00\u4E2A\u8303\u56F4\u5185\u7684\u5143\u7D20</td></tr><tr><td style="text-align:center;">SET</td><td style="text-align:center;">\u65E0\u5E8F\u96C6\u5408</td><td style="text-align:center;">\u6DFB\u52A0\u3001\u83B7\u53D6\u3001\u79FB\u9664\u5355\u4E2A\u5143\u7D20<br> \u68C0\u67E5\u4E00\u4E2A\u5143\u7D20\u662F\u5426\u5B58\u5728\u4E8E\u96C6\u5408\u4E2D<br> \u8BA1\u7B97\u4EA4\u96C6\u3001\u5E76\u96C6\u3001\u5DEE\u96C6<br> \u4ECE\u96C6\u5408\u91CC\u9762\u968F\u673A\u83B7\u53D6\u5143\u7D20</td></tr><tr><td style="text-align:center;">HASH</td><td style="text-align:center;">\u5305\u542B\u952E\u503C\u5BF9\u7684\u65E0\u5E8F\u6563\u5217\u8868</td><td style="text-align:center;">\u6DFB\u52A0\u3001\u83B7\u53D6\u3001\u79FB\u9664\u5355\u4E2A\u952E\u503C\u5BF9<br> \u83B7\u53D6\u6240\u6709\u952E\u503C\u5BF9<br> \u68C0\u67E5\u67D0\u4E2A\u952E\u662F\u5426\u5B58\u5728</td></tr><tr><td style="text-align:center;">ZSET</td><td style="text-align:center;">\u6709\u5E8F\u96C6\u5408</td><td style="text-align:center;">\u6DFB\u52A0\u3001\u83B7\u53D6\u3001\u5220\u9664\u5143\u7D20<br> \u6839\u636E\u5206\u503C\u8303\u56F4\u6216\u8005\u6210\u5458\u6765\u83B7\u53D6\u5143\u7D20<br> \u8BA1\u7B97\u4E00\u4E2A\u952E\u7684\u6392\u540D</td></tr></tbody></table>',7),E={href:"https://redislabs.com/ebook/part-1-getting-started/chapter-1-getting-to-know-redis/1-2-what-redis-data-structures-look-like/",target:"_blank",rel:"noopener noreferrer"},g=s("What Redis data structures look like"),k=t('<p><img src="'+d+`" alt="" loading="lazy"></p><div class="language-java ext-java"><pre class="language-java"><code>REDIS_ENCODING_INT\uFF08<span class="token keyword">long</span> \u7C7B\u578B\u7684\u6574\u6570\uFF09
REDIS_ENCODING_EMBSTR embstr \uFF08\u7F16\u7801\u7684\u7B80\u5355\u52A8\u6001\u5B57\u7B26\u4E32\uFF09
REDIS_ENCODING_RAW \uFF08\u7B80\u5355\u52A8\u6001\u5B57\u7B26\u4E32\uFF09
REDIS_ENCODING_HT \uFF08\u5B57\u5178\uFF09
REDIS_ENCODING_LINKEDLIST \uFF08\u53CC\u7AEF\u94FE\u8868\uFF09
REDIS_ENCODING_ZIPLIST \uFF08\u538B\u7F29\u5217\u8868\uFF09
REDIS_ENCODING_INTSET \uFF08\u6574\u6570\u96C6\u5408\uFF09
REDIS_ENCODING_SKIPLIST \uFF08\u8DF3\u8DC3\u8868\u548C\u5B57\u5178\uFF09
</code></pre></div><h2 id="string" tabindex="-1"><a class="header-anchor" href="#string" aria-hidden="true">#</a> STRING</h2><div align="center"><img src="https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/6019b2db-bc3e-4408-b6d8-96025f4481d6.png" width="400"></div><br><div class="language-html ext-html"><pre class="language-html"><code>&gt; set hello world
OK
&gt; get hello
&quot;world&quot;
&gt; del hello
(integer) 1
&gt; get hello
(nil)
</code></pre></div><h3 id="\u6570\u636E\u7ED3\u6784\u5B9E\u73B0" tabindex="-1"><a class="header-anchor" href="#\u6570\u636E\u7ED3\u6784\u5B9E\u73B0" aria-hidden="true">#</a> \u6570\u636E\u7ED3\u6784\u5B9E\u73B0</h3><ul><li>int\uFF1A8\u4E2A\u5B57\u8282\u7684\u957F\u6574\u578B</li><li>embstr\uFF1A\u5C0F\u4E8E\u7B49\u4E8E39\u4E2A\u5B57\u8282\u7684\u5B57\u7B26\u4E32</li><li>raw\uFF1A\u5927\u4E8E39\u4E2A\u5B57\u8282\u7684\u5B57\u7B26\u4E32</li></ul><h2 id="list" tabindex="-1"><a class="header-anchor" href="#list" aria-hidden="true">#</a> LIST</h2><div align="center"><img src="https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/fb327611-7e2b-4f2f-9f5b-38592d408f07.png" width="400"></div><br><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code>&gt; rpush list-key item
(integer) 1
&gt; rpush list-key item2
(integer) 2
&gt; rpush list-key item
(integer) 3

&gt; lrange list-key 0 -1
1) &quot;item&quot;
2) &quot;item2&quot;
3) &quot;item&quot;

&gt; lindex list-key 1
&quot;item2&quot;

&gt; lpop list-key
&quot;item&quot;

&gt; lrange list-key 0 -1
1) &quot;item2&quot;
2) &quot;item&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="\u6570\u636E\u7ED3\u6784\u5B9E\u73B0-1" tabindex="-1"><a class="header-anchor" href="#\u6570\u636E\u7ED3\u6784\u5B9E\u73B0-1" aria-hidden="true">#</a> \u6570\u636E\u7ED3\u6784\u5B9E\u73B0</h3><ul><li>ziplist: <ul><li>\u5217\u8868\u5BF9\u8C61\u4FDD\u5B58\u7684\u6240\u6709\u5B57\u7B26\u4E32\u5143\u7D20\u7684\u957F\u5EA6\u90FD\u5C0F\u4E8E64\u5B57\u8282\uFF1B</li><li>\u5217\u8868\u5143\u7D20\u4FDD\u5B58\u7684\u5143\u7D20\u6570\u91CF\u5C0F\u4E8E512\u4E2A\uFF1B</li></ul></li><li>linkedlist</li></ul><h2 id="set" tabindex="-1"><a class="header-anchor" href="#set" aria-hidden="true">#</a> SET</h2><div align="center"><img src="https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/cd5fbcff-3f35-43a6-8ffa-082a93ce0f0e.png" width="400"></div><br><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code>&gt; sadd set-key item
(integer) 1
&gt; sadd set-key item2
(integer) 1
&gt; sadd set-key item3
(integer) 1
&gt; sadd set-key item
(integer) 0

&gt; smembers set-key
1) &quot;item&quot;
2) &quot;item2&quot;
3) &quot;item3&quot;

&gt; sismember set-key item4
(integer) 0
&gt; sismember set-key item
(integer) 1

&gt; srem set-key item2
(integer) 1
&gt; srem set-key item2
(integer) 0

&gt; smembers set-key
1) &quot;item&quot;
2) &quot;item3&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="\u6570\u636E\u7ED3\u6784\u5B9E\u73B0-2" tabindex="-1"><a class="header-anchor" href="#\u6570\u636E\u7ED3\u6784\u5B9E\u73B0-2" aria-hidden="true">#</a> \u6570\u636E\u7ED3\u6784\u5B9E\u73B0</h3><ul><li>intset <ul><li>\u96C6\u5408\u5BF9\u8C61\u4FDD\u5B58\u7684\u6240\u6709\u5143\u7D20\u90FD\u662F\u6574\u6570\u503C\uFF1B</li><li>\u96C6\u5408\u5BF9\u8C61\u4FDD\u5B58\u7684\u5143\u7D20\u6570\u91CF\u4E0D\u8D85\u8FC7 512 \u4E2A\uFF1B</li></ul></li><li>hashtable</li></ul><h2 id="hash" tabindex="-1"><a class="header-anchor" href="#hash" aria-hidden="true">#</a> HASH</h2><div align="center"><img src="https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/7bd202a7-93d4-4f3a-a878-af68ae25539a.png" width="400"></div><br><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code>&gt; hset hash-key sub-key1 value1
(integer) 1
&gt; hset hash-key sub-key2 value2
(integer) 1
&gt; hset hash-key sub-key1 value1
(integer) 0

&gt; hgetall hash-key
1) &quot;sub-key1&quot;
2) &quot;value1&quot;
3) &quot;sub-key2&quot;
4) &quot;value2&quot;

&gt; hdel hash-key sub-key2
(integer) 1
&gt; hdel hash-key sub-key2
(integer) 0

&gt; hget hash-key sub-key1
&quot;value1&quot;

&gt; hgetall hash-key
1) &quot;sub-key1&quot;
2) &quot;value1&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="\u6570\u636E\u7ED3\u6784\u5B9E\u73B0-3" tabindex="-1"><a class="header-anchor" href="#\u6570\u636E\u7ED3\u6784\u5B9E\u73B0-3" aria-hidden="true">#</a> \u6570\u636E\u7ED3\u6784\u5B9E\u73B0</h3><ul><li>ziplist: <ul><li>\u54C8\u5E0C\u5BF9\u8C61\u4FDD\u5B58\u7684\u6240\u6709\u952E\u503C\u5BF9\u7684\u952E\u548C\u503C\u7684\u5B57\u7B26\u4E32\u957F\u5EA6\u90FD\u5C0F\u4E8E 64 \u5B57\u8282\uFF1B</li><li>\u54C8\u5E0C\u5BF9\u8C61\u4FDD\u5B58\u7684\u952E\u503C\u5BF9\u6570\u91CF\u5C0F\u4E8E 512 \u4E2A\uFF1B</li></ul></li><li>hashtable</li></ul><h4 id="\u5B57\u5178" tabindex="-1"><a class="header-anchor" href="#\u5B57\u5178" aria-hidden="true">#</a> \u5B57\u5178</h4><p>dictht \u662F\u4E00\u4E2A\u6563\u5217\u8868\u7ED3\u6784\uFF0C\u4F7F\u7528\u62C9\u94FE\u6CD5\u89E3\u51B3\u54C8\u5E0C\u51B2\u7A81\u3002</p><div class="language-c ext-c"><pre class="language-c"><code><span class="token comment">/* This is our hash table structure. Every dictionary has two of this as we
 * implement incremental rehashing, for the old to the new table. */</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">dictht</span> <span class="token punctuation">{</span>
    dictEntry <span class="token operator">*</span><span class="token operator">*</span>table<span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> size<span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> sizemask<span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> used<span class="token punctuation">;</span>
<span class="token punctuation">}</span> dictht<span class="token punctuation">;</span>
</code></pre></div><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">dictEntry</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token operator">*</span>key<span class="token punctuation">;</span>
    <span class="token keyword">union</span> <span class="token punctuation">{</span>
        <span class="token keyword">void</span> <span class="token operator">*</span>val<span class="token punctuation">;</span>
        <span class="token class-name">uint64_t</span> u64<span class="token punctuation">;</span>
        <span class="token class-name">int64_t</span> s64<span class="token punctuation">;</span>
        <span class="token keyword">double</span> d<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> v<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> <span class="token class-name">dictEntry</span> <span class="token operator">*</span>next<span class="token punctuation">;</span>
<span class="token punctuation">}</span> dictEntry<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>Redis \u7684\u5B57\u5178 dict \u4E2D\u5305\u542B\u4E24\u4E2A\u54C8\u5E0C\u8868 dictht\uFF0C\u8FD9\u662F\u4E3A\u4E86\u65B9\u4FBF\u8FDB\u884C rehash \u64CD\u4F5C\u3002\u5728\u6269\u5BB9\u65F6\uFF0C\u5C06\u5176\u4E2D\u4E00\u4E2A dictht \u4E0A\u7684\u952E\u503C\u5BF9 rehash \u5230\u53E6\u4E00\u4E2A dictht \u4E0A\u9762\uFF0C\u5B8C\u6210\u4E4B\u540E\u91CA\u653E\u7A7A\u95F4\u5E76\u4EA4\u6362\u4E24\u4E2A dictht \u7684\u89D2\u8272\u3002</p><div class="language-c ext-c"><pre class="language-c"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">dict</span> <span class="token punctuation">{</span>
    dictType <span class="token operator">*</span>type<span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token operator">*</span>privdata<span class="token punctuation">;</span>
    dictht ht<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">long</span> rehashidx<span class="token punctuation">;</span> <span class="token comment">/* rehashing not in progress if rehashidx == -1 */</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> iterators<span class="token punctuation">;</span> <span class="token comment">/* number of iterators currently running */</span>
<span class="token punctuation">}</span> dict<span class="token punctuation">;</span>
</code></pre></div><p>rehash \u64CD\u4F5C\u4E0D\u662F\u4E00\u6B21\u6027\u5B8C\u6210\uFF0C\u800C\u662F\u91C7\u7528\u6E10\u8FDB\u65B9\u5F0F\uFF0C\u8FD9\u662F\u4E3A\u4E86\u907F\u514D\u4E00\u6B21\u6027\u6267\u884C\u8FC7\u591A\u7684 rehash \u64CD\u4F5C\u7ED9\u670D\u52A1\u5668\u5E26\u6765\u8FC7\u5927\u7684\u8D1F\u62C5\u3002</p><p>\u6E10\u8FDB\u5F0F rehash \u901A\u8FC7\u8BB0\u5F55 dict \u7684 rehashidx \u5B8C\u6210\uFF0C\u5B83\u4ECE 0 \u5F00\u59CB\uFF0C\u7136\u540E\u6BCF\u6267\u884C\u4E00\u6B21 rehash \u90FD\u4F1A\u9012\u589E\u3002\u4F8B\u5982\u5728\u4E00\u6B21 rehash \u4E2D\uFF0C\u8981\u628A dict[0] rehash \u5230 dict[1]\uFF0C\u8FD9\u4E00\u6B21\u4F1A\u628A dict[0] \u4E0A table[rehashidx] \u7684\u952E\u503C\u5BF9 rehash \u5230 dict[1] \u4E0A\uFF0Cdict[0] \u7684 table[rehashidx] \u6307\u5411 null\uFF0C\u5E76\u4EE4 rehashidx++\u3002</p><p>\u56E0\u4E3A\u5728\u8FDB\u884C\u6E10\u8FDB\u5F0F rehash \u7684\u8FC7\u7A0B\u4E2D\uFF0C \u5B57\u5178\u4F1A\u540C\u65F6\u4F7F\u7528 ht[0] \u548C ht1 \u4E24\u4E2A\u54C8\u5E0C\u8868\uFF0C \u6240\u4EE5\u5728\u6E10\u8FDB\u5F0F rehash \u8FDB\u884C\u671F\u95F4\uFF0C \u5B57\u5178\u7684\u5220\u9664\uFF08delete\uFF09\u3001\u67E5\u627E\uFF08find\uFF09\u3001\u66F4\u65B0\uFF08update\uFF09\u7B49\u64CD\u4F5C\u4F1A\u5728\u4E24\u4E2A\u54C8\u5E0C\u8868\u4E0A\u8FDB\u884C\uFF1A \u6BD4\u5982\u8BF4\uFF0C \u8981\u5728\u5B57\u5178\u91CC\u9762\u67E5\u627E\u4E00\u4E2A\u952E\u7684\u8BDD\uFF0C \u7A0B\u5E8F\u4F1A\u5148\u5728 ht[0] \u91CC\u9762\u8FDB\u884C\u67E5\u627E\uFF0C \u5982\u679C\u6CA1\u627E\u5230\u7684\u8BDD\uFF0C \u5C31\u4F1A\u7EE7\u7EED\u5230 ht1 \u91CC\u9762\u8FDB\u884C\u67E5\u627E\uFF0C \u8BF8\u5982\u6B64\u7C7B\u3002</p><p>\u53E6\u5916\uFF0C \u5728\u6E10\u8FDB\u5F0F rehash \u6267\u884C\u671F\u95F4\uFF0C \u65B0\u6DFB\u52A0\u5230\u5B57\u5178\u7684\u952E\u503C\u5BF9\u4E00\u5F8B\u4F1A\u88AB\u4FDD\u5B58\u5230 ht1 \u91CC\u9762\uFF0C \u800C ht[0] \u5219\u4E0D\u518D\u8FDB\u884C\u4EFB\u4F55\u6DFB\u52A0\u64CD\u4F5C\uFF1A \u8FD9\u4E00\u63AA\u65BD\u4FDD\u8BC1\u4E86 ht[0] \u5305\u542B\u7684\u952E\u503C\u5BF9\u6570\u91CF\u4F1A\u53EA\u51CF\u4E0D\u589E\uFF0C \u5E76\u968F\u7740 rehash \u64CD\u4F5C\u7684\u6267\u884C\u800C\u6700\u7EC8\u53D8\u6210\u7A7A\u8868\u3002</p><p>\u8981\u70B9</p><ul><li>\u5B57\u5178\u4F7F\u7528\u54C8\u5E0C\u8868\u4F5C\u4E3A\u5E95\u5C42\u5B9E\u73B0\uFF0C \u6BCF\u4E2A\u5B57\u5178\u5E26\u6709\u4E24\u4E2A\u54C8\u5E0C\u8868\uFF0C \u4E00\u4E2A\u7528\u4E8E\u5E73\u65F6\u4F7F\u7528\uFF0C \u53E6\u4E00\u4E2A\u4EC5\u5728\u8FDB\u884C rehash \u65F6\u4F7F\u7528</li><li>\u5F53\u54C8\u5E0C\u8868\u4FDD\u5B58\u7684\u952E\u503C\u5BF9\u6570\u91CF\u592A\u591A\u6216\u8005\u592A\u5C11\u65F6\uFF0C \u7A0B\u5E8F\u9700\u8981\u5BF9\u54C8\u5E0C\u8868\u7684\u5927\u5C0F\u8FDB\u884C\u76F8\u5E94\u7684\u6269\u5C55\u6216\u8005\u6536\u7F29\uFF08rehash\uFF09</li><li>rehash \u52A8\u4F5C\u5E76\u4E0D\u662F\u4E00\u6B21\u6027\u3001\u96C6\u4E2D\u5F0F\u5730\u5B8C\u6210\u7684\uFF0C \u800C\u662F\u5206\u591A\u6B21\u3001\u6E10\u8FDB\u5F0F\u5730\u5B8C\u6210\u7684</li><li>\u6E10\u8FDB\u5F0F rehash \u7684\u8FC7\u7A0B\u4E2D\uFF0C \u5B57\u5178\u4F1A\u540C\u65F6\u4F7F\u7528 ht[0] \u548C ht[1] \u4E24\u4E2A\u54C8\u5E0C\u8868</li></ul><h2 id="zset" tabindex="-1"><a class="header-anchor" href="#zset" aria-hidden="true">#</a> ZSET</h2><div align="center"><img src="https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/1202b2d6-9469-4251-bd47-ca6034fb6116.png" width="400"></div><br><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code>&gt; zadd zset-key 728 member1
(integer) 1
&gt; zadd zset-key 982 member0
(integer) 1
&gt; zadd zset-key 982 member0
(integer) 0

&gt; zrange zset-key 0 -1 withscores
1) &quot;member1&quot;
2) &quot;728&quot;
3) &quot;member0&quot;
4) &quot;982&quot;

&gt; zrangebyscore zset-key 0 800 withscores
1) &quot;member1&quot;
2) &quot;728&quot;

&gt; zrem zset-key member1
(integer) 1
&gt; zrem zset-key member1
(integer) 0

&gt; zrange zset-key 0 -1 withscores
1) &quot;member0&quot;
2) &quot;982&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h3 id="\u6570\u636E\u7ED3\u6784\u5B9E\u73B0-4" tabindex="-1"><a class="header-anchor" href="#\u6570\u636E\u7ED3\u6784\u5B9E\u73B0-4" aria-hidden="true">#</a> \u6570\u636E\u7ED3\u6784\u5B9E\u73B0</h3><ul><li>ziplist:</li><li>zskiplist</li></ul><h4 id="\u8DF3\u8DC3\u8868" tabindex="-1"><a class="header-anchor" href="#\u8DF3\u8DC3\u8868" aria-hidden="true">#</a> \u8DF3\u8DC3\u8868</h4><p>\u662F\u6709\u5E8F\u96C6\u5408\u7684\u5E95\u5C42\u5B9E\u73B0\u4E4B\u4E00\u3002</p><p>\u8DF3\u8DC3\u8868\u662F\u57FA\u4E8E\u591A\u6307\u9488\u6709\u5E8F\u94FE\u8868\u5B9E\u73B0\u7684\uFF0C\u53EF\u4EE5\u770B\u6210\u591A\u4E2A\u6709\u5E8F\u94FE\u8868\u3002</p><div align="center"><img src="https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/beba612e-dc5b-4fc2-869d-0b23408ac90a.png" width="600px"></div><br><p>\u5728\u67E5\u627E\u65F6\uFF0C\u4ECE\u4E0A\u5C42\u6307\u9488\u5F00\u59CB\u67E5\u627E\uFF0C\u627E\u5230\u5BF9\u5E94\u7684\u533A\u95F4\u4E4B\u540E\u518D\u5230\u4E0B\u4E00\u5C42\u53BB\u67E5\u627E\u3002\u4E0B\u56FE\u6F14\u793A\u4E86\u67E5\u627E 22 \u7684\u8FC7\u7A0B\u3002</p><div align="center"><img src="https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/0ea37ee2-c224-4c79-b895-e131c6805c40.png" width="600px"></div><br><p>\u4E0E\u7EA2\u9ED1\u6811\u7B49\u5E73\u8861\u6811\u76F8\u6BD4\uFF0C\u8DF3\u8DC3\u8868\u5177\u6709\u4EE5\u4E0B\u4F18\u70B9\uFF1A</p><ul><li>\u63D2\u5165\u901F\u5EA6\u975E\u5E38\u5FEB\u901F\uFF0C\u56E0\u4E3A\u4E0D\u9700\u8981\u8FDB\u884C\u65CB\u8F6C\u7B49\u64CD\u4F5C\u6765\u7EF4\u62A4\u5E73\u8861\u6027\uFF1B</li><li>\u66F4\u5BB9\u6613\u5B9E\u73B0\uFF1B</li><li>\u652F\u6301\u65E0\u9501\u64CD\u4F5C\u3002</li></ul><p><img src="`+o+'" alt="" loading="lazy"></p><p>\u5C55\u793A\u4E86\u4E00\u4E2A\u8DF3\u8DC3\u8868\u793A\u4F8B\uFF0C \u4F4D\u4E8E\u56FE\u7247\u6700\u5DE6\u8FB9\u7684\u662F zskiplist \u7ED3\u6784\uFF0C \u8BE5\u7ED3\u6784\u5305\u542B\u4EE5\u4E0B\u5C5E\u6027\uFF1A</p><blockquote></blockquote><ul><li>header \uFF1A\u6307\u5411\u8DF3\u8DC3\u8868\u7684\u8868\u5934\u8282\u70B9\u3002</li><li>tail \uFF1A\u6307\u5411\u8DF3\u8DC3\u8868\u7684\u8868\u5C3E\u8282\u70B9\u3002</li><li>level \uFF1A\u8BB0\u5F55\u76EE\u524D\u8DF3\u8DC3\u8868\u5185\uFF0C\u5C42\u6570\u6700\u5927\u7684\u90A3\u4E2A\u8282\u70B9\u7684\u5C42\u6570\uFF08\u8868\u5934\u8282\u70B9\u7684\u5C42\u6570\u4E0D\u8BA1\u7B97\u5728\u5185\uFF09\u3002</li><li>length \uFF1A\u8BB0\u5F55\u8DF3\u8DC3\u8868\u7684\u957F\u5EA6\uFF0C\u4E5F\u5373\u662F\uFF0C\u8DF3\u8DC3\u8868\u76EE\u524D\u5305\u542B\u8282\u70B9\u7684\u6570\u91CF\uFF08\u8868\u5934\u8282\u70B9\u4E0D\u8BA1\u7B97\u5728\u5185\uFF09\u3002</li></ul><p>zskiplist \u7ED3\u6784\u53F3\u8FB9\u7684\u662F\u56DB\u4E2A zskiplistNode \u7ED3\u6784\uFF0C \u8BE5\u7ED3\u6784\u5305\u542B\u4EE5\u4E0B\u5C5E\u6027\uFF1A</p><ul><li>\u5C42\uFF08level\uFF09\uFF1A\u8282\u70B9\u4E2D\u7528 L1 \u3001 L2 \u3001 L3 \u7B49\u5B57\u6837\u6807\u8BB0\u8282\u70B9\u7684\u5404\u4E2A\u5C42\uFF0C L1 \u4EE3\u8868\u7B2C\u4E00\u5C42\uFF0C L2 \u4EE3\u8868\u7B2C\u4E8C\u5C42\uFF0C\u4EE5\u6B64\u7C7B\u63A8\u3002\u6BCF\u4E2A\u5C42\u90FD\u5E26\u6709\u4E24\u4E2A\u5C5E\u6027\uFF1A\u524D\u8FDB\u6307\u9488\u548C\u8DE8\u5EA6\u3002\u524D\u8FDB\u6307\u9488\u7528\u4E8E\u8BBF\u95EE\u4F4D\u4E8E\u8868\u5C3E\u65B9\u5411\u7684\u5176\u4ED6\u8282\u70B9\uFF0C\u800C\u8DE8\u5EA6\u5219\u8BB0\u5F55\u4E86\u524D\u8FDB\u6307\u9488\u6240\u6307\u5411\u8282\u70B9\u548C\u5F53\u524D\u8282\u70B9\u7684\u8DDD\u79BB\u3002\u5728\u4E0A\u9762\u7684\u56FE\u7247\u4E2D\uFF0C\u8FDE\u7EBF\u4E0A\u5E26\u6709\u6570\u5B57\u7684\u7BAD\u5934\u5C31\u4EE3\u8868&gt;\u524D\u8FDB\u6307\u9488\uFF0C\u800C\u90A3\u4E2A\u6570\u5B57\u5C31\u662F\u8DE8\u5EA6\u3002\u5F53\u7A0B\u5E8F\u4ECE\u8868\u5934\u5411\u8868\u5C3E\u8FDB\u884C\u904D\u5386\u65F6\uFF0C\u8BBF\u95EE\u4F1A\u6CBF\u7740\u5C42\u7684\u524D\u8FDB\u6307\u9488\u8FDB\u884C\u3002</li><li>\u540E\u9000\u6307\u9488\uFF08backward\uFF09\uFF1A\u8282\u70B9\u4E2D\u7528 BW \u5B57\u6837\u6807\u8BB0\u8282\u70B9\u7684\u540E\u9000\u6307\u9488\uFF0C\u5B83\u6307\u5411\u4F4D\u4E8E\u5F53\u524D\u8282\u70B9\u7684\u524D\u4E00\u4E2A\u8282\u70B9\u3002\u540E\u9000\u6307\u9488\u5728\u7A0B\u5E8F\u4ECE\u8868\u5C3E\u5411\u8868\u5934\u904D\u5386\u65F6\u4F7F\u7528\u3002</li><li>\u5206\u503C\uFF08score\uFF09\uFF1A\u5404\u4E2A\u8282\u70B9\u4E2D\u7684 1.0 \u3001 2.0 \u548C 3.0 \u662F\u8282\u70B9\u6240\u4FDD\u5B58\u7684\u5206\u503C\u3002\u5728\u8DF3\u8DC3\u8868\u4E2D\uFF0C\u8282\u70B9\u6309\u5404\u81EA\u6240\u4FDD\u5B58\u7684\u5206\u503C\u4ECE\u5C0F\u5230\u5927\u6392\u5217\u3002</li><li>\u6210\u5458\u5BF9\u8C61\uFF08obj\uFF09\uFF1A\u5404\u4E2A\u8282\u70B9\u4E2D\u7684 o1 \u3001 o2 \u548C o3 \u662F\u8282\u70B9\u6240\u4FDD\u5B58\u7684\u6210\u5458\u5BF9\u8C61\u3002</li></ul><p>\u6CE8\u610F\u8868\u5934\u8282\u70B9\u548C\u5176\u4ED6\u8282\u70B9\u7684\u6784\u9020\u662F\u4E00\u6837\u7684\uFF1A \u8868\u5934\u8282\u70B9\u4E5F\u6709\u540E\u9000\u6307\u9488\u3001\u5206\u503C\u548C\u6210\u5458\u5BF9\u8C61\uFF0C \u4E0D\u8FC7\u8868\u5934\u8282\u70B9\u7684\u8FD9\u4E9B\u5C5E\u6027\u90FD\u4E0D\u4F1A\u88AB\u7528\u5230\uFF0C \u6240\u4EE5\u56FE\u4E2D\u7701\u7565\u4E86\u8FD9\u4E9B\u90E8\u5206\uFF0C \u53EA\u663E\u793A\u4E86\u8868\u5934\u8282\u70B9\u7684\u5404\u4E2A\u5C42\u3002</p><h1 id="\u4E09\u3001\u4F7F\u7528\u573A\u666F" tabindex="-1"><a class="header-anchor" href="#\u4E09\u3001\u4F7F\u7528\u573A\u666F" aria-hidden="true">#</a> \u4E09\u3001\u4F7F\u7528\u573A\u666F</h1><h2 id="\u8BA1\u6570\u5668" tabindex="-1"><a class="header-anchor" href="#\u8BA1\u6570\u5668" aria-hidden="true">#</a> \u8BA1\u6570\u5668</h2><p>\u53EF\u4EE5\u5BF9 String \u8FDB\u884C\u81EA\u589E\u81EA\u51CF\u8FD0\u7B97\uFF0C\u4ECE\u800C\u5B9E\u73B0\u8BA1\u6570\u5668\u529F\u80FD\u3002</p><p>Redis \u8FD9\u79CD\u5185\u5B58\u578B\u6570\u636E\u5E93\u7684\u8BFB\u5199\u6027\u80FD\u975E\u5E38\u9AD8\uFF0C\u5F88\u9002\u5408\u5B58\u50A8\u9891\u7E41\u8BFB\u5199\u7684\u8BA1\u6570\u91CF\u3002</p><h2 id="\u7F13\u5B58" tabindex="-1"><a class="header-anchor" href="#\u7F13\u5B58" aria-hidden="true">#</a> \u7F13\u5B58</h2><p>\u5C06\u70ED\u70B9\u6570\u636E\u653E\u5230\u5185\u5B58\u4E2D\uFF0C\u8BBE\u7F6E\u5185\u5B58\u7684\u6700\u5927\u4F7F\u7528\u91CF\u4EE5\u53CA\u6DD8\u6C70\u7B56\u7565\u6765\u4FDD\u8BC1\u7F13\u5B58\u7684\u547D\u4E2D\u7387\u3002</p><h2 id="\u67E5\u627E\u8868" tabindex="-1"><a class="header-anchor" href="#\u67E5\u627E\u8868" aria-hidden="true">#</a> \u67E5\u627E\u8868</h2><p>\u4F8B\u5982 DNS \u8BB0\u5F55\u5C31\u5F88\u9002\u5408\u4F7F\u7528 Redis \u8FDB\u884C\u5B58\u50A8\u3002</p><p>\u67E5\u627E\u8868\u548C\u7F13\u5B58\u7C7B\u4F3C\uFF0C\u4E5F\u662F\u5229\u7528\u4E86 Redis \u5FEB\u901F\u7684\u67E5\u627E\u7279\u6027\u3002\u4F46\u662F\u67E5\u627E\u8868\u7684\u5185\u5BB9\u4E0D\u80FD\u5931\u6548\uFF0C\u800C\u7F13\u5B58\u7684\u5185\u5BB9\u53EF\u4EE5\u5931\u6548\uFF0C\u56E0\u4E3A\u7F13\u5B58\u4E0D\u4F5C\u4E3A\u53EF\u9760\u7684\u6570\u636E\u6765\u6E90\u3002</p><h2 id="\u6D88\u606F\u961F\u5217" tabindex="-1"><a class="header-anchor" href="#\u6D88\u606F\u961F\u5217" aria-hidden="true">#</a> \u6D88\u606F\u961F\u5217</h2><p>List \u662F\u4E00\u4E2A\u53CC\u5411\u94FE\u8868\uFF0C\u53EF\u4EE5\u901A\u8FC7 lpush \u548C rpop \u5199\u5165\u548C\u8BFB\u53D6\u6D88\u606F</p><p>\u4E0D\u8FC7\u6700\u597D\u4F7F\u7528 Kafka\u3001RabbitMQ \u7B49\u6D88\u606F\u4E2D\u95F4\u4EF6\u3002</p><h2 id="\u4F1A\u8BDD\u7F13\u5B58" tabindex="-1"><a class="header-anchor" href="#\u4F1A\u8BDD\u7F13\u5B58" aria-hidden="true">#</a> \u4F1A\u8BDD\u7F13\u5B58</h2><p>\u53EF\u4EE5\u4F7F\u7528 Redis \u6765\u7EDF\u4E00\u5B58\u50A8\u591A\u53F0\u5E94\u7528\u670D\u52A1\u5668\u7684\u4F1A\u8BDD\u4FE1\u606F\u3002</p><p>\u5F53\u5E94\u7528\u670D\u52A1\u5668\u4E0D\u518D\u5B58\u50A8\u7528\u6237\u7684\u4F1A\u8BDD\u4FE1\u606F\uFF0C\u4E5F\u5C31\u4E0D\u518D\u5177\u6709\u72B6\u6001\uFF0C\u4E00\u4E2A\u7528\u6237\u53EF\u4EE5\u8BF7\u6C42\u4EFB\u610F\u4E00\u4E2A\u5E94\u7528\u670D\u52A1\u5668\uFF0C\u4ECE\u800C\u66F4\u5BB9\u6613\u5B9E\u73B0\u9AD8\u53EF\u7528\u6027\u4EE5\u53CA\u53EF\u4F38\u7F29\u6027\u3002</p><h2 id="\u5206\u5E03\u5F0F\u9501\u5B9E\u73B0" tabindex="-1"><a class="header-anchor" href="#\u5206\u5E03\u5F0F\u9501\u5B9E\u73B0" aria-hidden="true">#</a> \u5206\u5E03\u5F0F\u9501\u5B9E\u73B0</h2><p>\u5728\u5206\u5E03\u5F0F\u573A\u666F\u4E0B\uFF0C\u65E0\u6CD5\u4F7F\u7528\u5355\u673A\u73AF\u5883\u4E0B\u7684\u9501\u6765\u5BF9\u591A\u4E2A\u8282\u70B9\u4E0A\u7684\u8FDB\u7A0B\u8FDB\u884C\u540C\u6B65\u3002</p><p>\u53EF\u4EE5\u4F7F\u7528 Redis \u81EA\u5E26\u7684 SETNX \u547D\u4EE4\u5B9E\u73B0\u5206\u5E03\u5F0F\u9501\uFF0C\u9664\u6B64\u4E4B\u5916\uFF0C\u8FD8\u53EF\u4EE5\u4F7F\u7528\u5B98\u65B9\u63D0\u4F9B\u7684 RedLock \u5206\u5E03\u5F0F\u9501\u5B9E\u73B0\u3002</p><h2 id="\u5176\u5B83" tabindex="-1"><a class="header-anchor" href="#\u5176\u5B83" aria-hidden="true">#</a> \u5176\u5B83</h2><p>Set \u53EF\u4EE5\u5B9E\u73B0\u4EA4\u96C6\u3001\u5E76\u96C6\u7B49\u64CD\u4F5C\uFF0C\u4ECE\u800C\u5B9E\u73B0\u5171\u540C\u597D\u53CB\u7B49\u529F\u80FD\u3002</p><p>ZSet \u53EF\u4EE5\u5B9E\u73B0\u6709\u5E8F\u6027\u64CD\u4F5C\uFF0C\u4ECE\u800C\u5B9E\u73B0\u6392\u884C\u699C\u7B49\u529F\u80FD\u3002</p><h1 id="\u56DB\u3001redis-\u4E0E-memcached" tabindex="-1"><a class="header-anchor" href="#\u56DB\u3001redis-\u4E0E-memcached" aria-hidden="true">#</a> \u56DB\u3001Redis \u4E0E Memcached</h1><p>\u4E24\u8005\u90FD\u662F\u975E\u5173\u7CFB\u578B\u5185\u5B58\u952E\u503C\u6570\u636E\u5E93\uFF0C\u4E3B\u8981\u6709\u4EE5\u4E0B\u4E0D\u540C\uFF1A</p><h2 id="\u6570\u636E\u7C7B\u578B" tabindex="-1"><a class="header-anchor" href="#\u6570\u636E\u7C7B\u578B" aria-hidden="true">#</a> \u6570\u636E\u7C7B\u578B</h2><p>Memcached \u4EC5\u652F\u6301\u5B57\u7B26\u4E32\u7C7B\u578B\uFF0C\u800C Redis \u652F\u6301\u4E94\u79CD\u4E0D\u540C\u7684\u6570\u636E\u7C7B\u578B\uFF0C\u53EF\u4EE5\u66F4\u7075\u6D3B\u5730\u89E3\u51B3\u95EE\u9898\u3002</p><h2 id="\u6570\u636E\u6301\u4E45\u5316" tabindex="-1"><a class="header-anchor" href="#\u6570\u636E\u6301\u4E45\u5316" aria-hidden="true">#</a> \u6570\u636E\u6301\u4E45\u5316</h2><p>Redis \u652F\u6301\u4E24\u79CD\u6301\u4E45\u5316\u7B56\u7565\uFF1ARDB \u5FEB\u7167\u548C AOF \u65E5\u5FD7\uFF0C\u800C Memcached \u4E0D\u652F\u6301\u6301\u4E45\u5316\u3002</p><h2 id="\u5206\u5E03\u5F0F" tabindex="-1"><a class="header-anchor" href="#\u5206\u5E03\u5F0F" aria-hidden="true">#</a> \u5206\u5E03\u5F0F</h2><p>Memcached \u4E0D\u652F\u6301\u5206\u5E03\u5F0F\uFF0C\u53EA\u80FD\u901A\u8FC7\u5728\u5BA2\u6237\u7AEF\u4F7F\u7528\u4E00\u81F4\u6027\u54C8\u5E0C\u6765\u5B9E\u73B0\u5206\u5E03\u5F0F\u5B58\u50A8\uFF0C\u8FD9\u79CD\u65B9\u5F0F\u5728\u5B58\u50A8\u548C\u67E5\u8BE2\u65F6\u90FD\u9700\u8981\u5148\u5728\u5BA2\u6237\u7AEF\u8BA1\u7B97\u4E00\u6B21\u6570\u636E\u6240\u5728\u7684\u8282\u70B9\u3002</p><p>Redis Cluster \u5B9E\u73B0\u4E86\u5206\u5E03\u5F0F\u7684\u652F\u6301\u3002</p><h2 id="\u5185\u5B58\u7BA1\u7406\u673A\u5236" tabindex="-1"><a class="header-anchor" href="#\u5185\u5B58\u7BA1\u7406\u673A\u5236" aria-hidden="true">#</a> \u5185\u5B58\u7BA1\u7406\u673A\u5236</h2><ul><li><p>\u5728 Redis \u4E2D\uFF0C\u5E76\u4E0D\u662F\u6240\u6709\u6570\u636E\u90FD\u4E00\u76F4\u5B58\u50A8\u5728\u5185\u5B58\u4E2D\uFF0C\u53EF\u4EE5\u5C06\u4E00\u4E9B\u5F88\u4E45\u6CA1\u7528\u7684 value \u4EA4\u6362\u5230\u78C1\u76D8\uFF0C\u800C Memcached \u7684\u6570\u636E\u5219\u4F1A\u4E00\u76F4\u5728\u5185\u5B58\u4E2D\u3002</p></li><li><p>Memcached \u5C06\u5185\u5B58\u5206\u5272\u6210\u7279\u5B9A\u957F\u5EA6\u7684\u5757\u6765\u5B58\u50A8\u6570\u636E\uFF0C\u4EE5\u5B8C\u5168\u89E3\u51B3\u5185\u5B58\u788E\u7247\u7684\u95EE\u9898\u3002\u4F46\u662F\u8FD9\u79CD\u65B9\u5F0F\u4F1A\u4F7F\u5F97\u5185\u5B58\u7684\u5229\u7528\u7387\u4E0D\u9AD8\uFF0C\u4F8B\u5982\u5757\u7684\u5927\u5C0F\u4E3A 128 bytes\uFF0C\u53EA\u5B58\u50A8 100 bytes \u7684\u6570\u636E\uFF0C\u90A3\u4E48\u5269\u4E0B\u7684 28 bytes \u5C31\u6D6A\u8D39\u6389\u4E86\u3002</p></li></ul><h1 id="\u4E94\u3001\u952E\u7684\u8FC7\u671F\u65F6\u95F4" tabindex="-1"><a class="header-anchor" href="#\u4E94\u3001\u952E\u7684\u8FC7\u671F\u65F6\u95F4" aria-hidden="true">#</a> \u4E94\u3001\u952E\u7684\u8FC7\u671F\u65F6\u95F4</h1><p>Redis \u53EF\u4EE5\u4E3A\u6BCF\u4E2A\u952E\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4\uFF0C\u5F53\u952E\u8FC7\u671F\u65F6\uFF0C\u4F1A\u81EA\u52A8\u5220\u9664\u8BE5\u952E\u3002</p><p>\u5BF9\u4E8E\u6563\u5217\u8868\u8FD9\u79CD\u5BB9\u5668\uFF0C\u53EA\u80FD\u4E3A\u6574\u4E2A\u952E\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4\uFF08\u6574\u4E2A\u6563\u5217\u8868\uFF09\uFF0C\u800C\u4E0D\u80FD\u4E3A\u952E\u91CC\u9762\u7684\u5355\u4E2A\u5143\u7D20\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4\u3002</p><h2 id="\u5220\u9664\u7B56\u7565" tabindex="-1"><a class="header-anchor" href="#\u5220\u9664\u7B56\u7565" aria-hidden="true">#</a> \u5220\u9664\u7B56\u7565</h2><table><thead><tr><th>\u5220\u9664\u7B56\u7565</th><th>\u5BF9\u6BD4\u7ED3\u679C</th></tr></thead><tbody><tr><td>\u5B9A\u65F6\u5220\u9664</td><td>1.\u8282\u7EA6\u5185\u5B58,\u65E0\u5360\u7528 2.\u4E0D\u5206\u65F6\u6BB5\u5360\u7528CPU\u8D44\u6E90,\u9891\u5EA6\u9AD8 3.\u62FF\u65F6\u95F4\u6362\u7A7A\u95F4</td></tr><tr><td>\u60F0\u6027\u5220\u9664</td><td>1.\u5185\u5B58\u5360\u7528\u4E25\u91CD 2.\u5EF6\u65F6\u6267\u884C,CPU\u5229\u7528\u7387\u9AD8 3.\u62FF\u7A7A\u95F4\u6362\u65F6\u95F4</td></tr><tr><td>\u5B9A\u671F\u5220\u9664</td><td>1.\u5185\u5B58\u5B9A\u671F\u968F\u673A\u6E05\u7406 2.\u6BCF\u79D2\u82B1\u8D39\u56FA\u5B9A\u7684CPU\u8D44\u6E90\u7EF4\u62A4\u5185\u5B58 3.\u968F\u673A\u62BD\u67E5,\u91CD\u70B9\u62BD\u67E5</td></tr></tbody></table><p>Redis \u91C7\u7528\u7684\u662F \u5B9A\u671F\u5220\u9664+\u60F0\u6027/\u61D2\u6C49\u5F0F\u5220\u9664</p><p>\u4EC5\u4EC5\u901A\u8FC7\u7ED9 key \u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4\u8FD8\u662F\u6709\u95EE\u9898\u7684\u3002\u56E0\u4E3A\u8FD8\u662F\u53EF\u80FD\u5B58\u5728\u5B9A\u671F\u5220\u9664\u548C\u60F0\u6027\u5220\u9664\u6F0F\u6389\u4E86\u5F88\u591A\u8FC7\u671F key \u7684\u60C5\u51B5\u3002\u8FD9\u6837\u5C31\u5BFC\u81F4\u5927\u91CF\u8FC7\u671F key \u5806\u79EF\u5728\u5185\u5B58\u91CC\uFF0C\u7136\u540E\u5C31Out of memory\u4E86\u3002</p><p>\u600E\u4E48\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898\u5462\uFF1F\u7B54\u6848\u5C31\u662F\uFF1A Redis \u5185\u5B58\u6DD8\u6C70\u673A\u5236\u3002</p><h1 id="\u516D\u3001\u6570\u636E\u6DD8\u6C70\u7B56\u7565" tabindex="-1"><a class="header-anchor" href="#\u516D\u3001\u6570\u636E\u6DD8\u6C70\u7B56\u7565" aria-hidden="true">#</a> \u516D\u3001\u6570\u636E\u6DD8\u6C70\u7B56\u7565</h1><p>\u53EF\u4EE5\u8BBE\u7F6E\u5185\u5B58\u6700\u5927\u4F7F\u7528\u91CF\uFF0C\u5F53\u5185\u5B58\u4F7F\u7528\u91CF\u8D85\u51FA\u65F6\uFF0C\u4F1A\u65BD\u884C\u6570\u636E\u6DD8\u6C70\u7B56\u7565\u3002</p><p>Redis \u5177\u4F53\u6709 6 \u79CD\u6DD8\u6C70\u7B56\u7565\uFF1A</p><table><thead><tr><th style="text-align:center;">\u7B56\u7565</th><th style="text-align:center;">\u63CF\u8FF0</th></tr></thead><tbody><tr><td style="text-align:center;">volatile-lru</td><td style="text-align:center;">\u4ECE\u5DF2\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4\u7684\u6570\u636E\u96C6\u4E2D\u6311\u9009\u6700\u8FD1\u6700\u5C11\u4F7F\u7528\u7684\u6570\u636E\u6DD8\u6C70</td></tr><tr><td style="text-align:center;">volatile-ttl</td><td style="text-align:center;">\u4ECE\u5DF2\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4\u7684\u6570\u636E\u96C6\u4E2D\u6311\u9009\u5C06\u8981\u8FC7\u671F\u7684\u6570\u636E\u6DD8\u6C70</td></tr><tr><td style="text-align:center;">volatile-random</td><td style="text-align:center;">\u4ECE\u5DF2\u8BBE\u7F6E\u8FC7\u671F\u65F6\u95F4\u7684\u6570\u636E\u96C6\u4E2D\u4EFB\u610F\u9009\u62E9\u6570\u636E\u6DD8\u6C70</td></tr><tr><td style="text-align:center;">allkeys-lru</td><td style="text-align:center;">\u4ECE\u6240\u6709\u6570\u636E\u96C6\u4E2D\u6311\u9009\u6700\u8FD1\u6700\u5C11\u4F7F\u7528\u7684\u6570\u636E\u6DD8\u6C70</td></tr><tr><td style="text-align:center;">allkeys-random</td><td style="text-align:center;">\u4ECE\u6240\u6709\u6570\u636E\u96C6\u4E2D\u4EFB\u610F\u9009\u62E9\u6570\u636E\u8FDB\u884C\u6DD8\u6C70</td></tr><tr><td style="text-align:center;">noeviction</td><td style="text-align:center;">\u7981\u6B62\u9A71\u9010\u6570\u636E</td></tr></tbody></table><p>\u4F5C\u4E3A\u5185\u5B58\u6570\u636E\u5E93\uFF0C\u51FA\u4E8E\u5BF9\u6027\u80FD\u548C\u5185\u5B58\u6D88\u8017\u7684\u8003\u8651\uFF0CRedis \u7684\u6DD8\u6C70\u7B97\u6CD5\u5B9E\u9645\u5B9E\u73B0\u4E0A\u5E76\u975E\u9488\u5BF9\u6240\u6709 key\uFF0C\u800C\u662F\u62BD\u6837\u4E00\u5C0F\u90E8\u5206\u5E76\u4E14\u4ECE\u4E2D\u9009\u51FA\u88AB\u6DD8\u6C70\u7684 key\u3002</p><p>\u4F7F\u7528 Redis \u7F13\u5B58\u6570\u636E\u65F6\uFF0C\u4E3A\u4E86\u63D0\u9AD8\u7F13\u5B58\u547D\u4E2D\u7387\uFF0C\u9700\u8981\u4FDD\u8BC1\u7F13\u5B58\u6570\u636E\u90FD\u662F\u70ED\u70B9\u6570\u636E\u3002\u53EF\u4EE5\u5C06\u5185\u5B58\u6700\u5927\u4F7F\u7528\u91CF\u8BBE\u7F6E\u4E3A\u70ED\u70B9\u6570\u636E\u5360\u7528\u7684\u5185\u5B58\u91CF\uFF0C\u7136\u540E\u542F\u7528 allkeys-lru \u6DD8\u6C70\u7B56\u7565\uFF0C\u5C06\u6700\u8FD1\u6700\u5C11\u4F7F\u7528\u7684\u6570\u636E\u6DD8\u6C70\u3002</p><p>Redis 4.0 \u5F15\u5165\u4E86 volatile-lfu \u548C allkeys-lfu \u6DD8\u6C70\u7B56\u7565\uFF0CLFU \u7B56\u7565\u901A\u8FC7\u7EDF\u8BA1\u8BBF\u95EE\u9891\u7387\uFF0C\u5C06\u8BBF\u95EE\u9891\u7387\u6700\u5C11\u7684\u952E\u503C\u5BF9\u6DD8\u6C70\u3002</p><h1 id="\u4E03\u3001\u6301\u4E45\u5316" tabindex="-1"><a class="header-anchor" href="#\u4E03\u3001\u6301\u4E45\u5316" aria-hidden="true">#</a> \u4E03\u3001\u6301\u4E45\u5316</h1><p>Redis \u662F\u5185\u5B58\u578B\u6570\u636E\u5E93\uFF0C\u4E3A\u4E86\u4FDD\u8BC1\u6570\u636E\u5728\u65AD\u7535\u540E\u4E0D\u4F1A\u4E22\u5931\uFF0C\u9700\u8981\u5C06\u5185\u5B58\u4E2D\u7684\u6570\u636E\u6301\u4E45\u5316\u5230\u786C\u76D8\u4E0A\u3002</p><h2 id="rdb-\u6301\u4E45\u5316-\u5168\u91CF\u6A21\u5F0F\u6301\u4E45\u5316" tabindex="-1"><a class="header-anchor" href="#rdb-\u6301\u4E45\u5316-\u5168\u91CF\u6A21\u5F0F\u6301\u4E45\u5316" aria-hidden="true">#</a> RDB \u6301\u4E45\u5316 \u5168\u91CF\u6A21\u5F0F\u6301\u4E45\u5316</h2><p>\u5C06\u67D0\u4E2A\u65F6\u95F4\u70B9\u7684\u6240\u6709\u6570\u636E\u90FD\u5B58\u653E\u5230\u786C\u76D8\u4E0A\u3002</p><p>\u53EF\u4EE5\u5C06\u5FEB\u7167\u590D\u5236\u5230\u5176\u5B83\u670D\u52A1\u5668\u4ECE\u800C\u521B\u5EFA\u5177\u6709\u76F8\u540C\u6570\u636E\u7684\u670D\u52A1\u5668\u526F\u672C\u3002</p><p>\u5982\u679C\u7CFB\u7EDF\u53D1\u751F\u6545\u969C\uFF0C\u5C06\u4F1A\u4E22\u5931\u6700\u540E\u4E00\u6B21\u521B\u5EFA\u5FEB\u7167\u4E4B\u540E\u7684\u6570\u636E\u3002</p><p>\u5982\u679C\u6570\u636E\u91CF\u5F88\u5927\uFF0C\u4FDD\u5B58\u5FEB\u7167\u7684\u65F6\u95F4\u4F1A\u5F88\u957F\u3002</p><p><img src="'+h+'" alt="" title=":size=500" loading="lazy"></p><h2 id="aof-\u6301\u4E45\u5316-\u589E\u91CF\u6A21\u5F0F\u6301\u4E45\u5316" tabindex="-1"><a class="header-anchor" href="#aof-\u6301\u4E45\u5316-\u589E\u91CF\u6A21\u5F0F\u6301\u4E45\u5316" aria-hidden="true">#</a> AOF \u6301\u4E45\u5316 \u589E\u91CF\u6A21\u5F0F\u6301\u4E45\u5316</h2><p>\u5C06\u5199\u547D\u4EE4\u6DFB\u52A0\u5230 AOF \u6587\u4EF6\uFF08Append Only File\uFF09\u7684\u672B\u5C3E\u3002</p><p>\u4F7F\u7528 AOF \u6301\u4E45\u5316\u9700\u8981\u8BBE\u7F6E\u540C\u6B65\u9009\u9879\uFF0C\u4ECE\u800C\u786E\u4FDD\u5199\u547D\u4EE4\u540C\u6B65\u5230\u78C1\u76D8\u6587\u4EF6\u4E0A\u7684\u65F6\u673A\u3002\u8FD9\u662F\u56E0\u4E3A\u5BF9\u6587\u4EF6\u8FDB\u884C\u5199\u5165\u5E76\u4E0D\u4F1A\u9A6C\u4E0A\u5C06\u5185\u5BB9\u540C\u6B65\u5230\u78C1\u76D8\u4E0A\uFF0C\u800C\u662F\u5148\u5B58\u50A8\u5230\u7F13\u51B2\u533A\uFF0C\u7136\u540E\u7531\u64CD\u4F5C\u7CFB\u7EDF\u51B3\u5B9A\u4EC0\u4E48\u65F6\u5019\u540C\u6B65\u5230\u78C1\u76D8\u3002\u6709\u4EE5\u4E0B\u540C\u6B65\u9009\u9879\uFF1A</p><table><thead><tr><th style="text-align:center;">\u9009\u9879</th><th style="text-align:center;">\u540C\u6B65\u9891\u7387</th></tr></thead><tbody><tr><td style="text-align:center;">always</td><td style="text-align:center;">\u6BCF\u4E2A\u5199\u547D\u4EE4\u90FD\u540C\u6B65</td></tr><tr><td style="text-align:center;">everysec</td><td style="text-align:center;">\u6BCF\u79D2\u540C\u6B65\u4E00\u6B21</td></tr><tr><td style="text-align:center;">no</td><td style="text-align:center;">\u8BA9\u64CD\u4F5C\u7CFB\u7EDF\u6765\u51B3\u5B9A\u4F55\u65F6\u540C\u6B65</td></tr></tbody></table><ul><li>always \u9009\u9879\u4F1A\u4E25\u91CD\u51CF\u4F4E\u670D\u52A1\u5668\u7684\u6027\u80FD\uFF1B</li><li>everysec \u9009\u9879\u6BD4\u8F83\u5408\u9002\uFF0C\u53EF\u4EE5\u4FDD\u8BC1\u7CFB\u7EDF\u5D29\u6E83\u65F6\u53EA\u4F1A\u4E22\u5931\u4E00\u79D2\u5DE6\u53F3\u7684\u6570\u636E\uFF0C\u5E76\u4E14 Redis \u6BCF\u79D2\u6267\u884C\u4E00\u6B21\u540C\u6B65\u5BF9\u670D\u52A1\u5668\u6027\u80FD\u51E0\u4E4E\u6CA1\u6709\u4EFB\u4F55\u5F71\u54CD\uFF1B</li><li>no \u9009\u9879\u5E76\u4E0D\u80FD\u7ED9\u670D\u52A1\u5668\u6027\u80FD\u5E26\u6765\u591A\u5927\u7684\u63D0\u5347\uFF0C\u800C\u4E14\u4E5F\u4F1A\u589E\u52A0\u7CFB\u7EDF\u5D29\u6E83\u65F6\u6570\u636E\u4E22\u5931\u7684\u6570\u91CF\u3002</li></ul><p><img src="'+u+`" alt="" title=":size=500" loading="lazy"></p><p>\u968F\u7740\u670D\u52A1\u5668\u5199\u8BF7\u6C42\u7684\u589E\u591A\uFF0CAOF \u6587\u4EF6\u4F1A\u8D8A\u6765\u8D8A\u5927\u3002Redis \u63D0\u4F9B\u4E86\u4E00\u79CD\u5C06 AOF \u91CD\u5199\u7684\u7279\u6027\uFF0C\u80FD\u591F\u53BB\u9664 AOF \u6587\u4EF6\u4E2D\u7684\u5197\u4F59\u5199\u547D\u4EE4\u3002</p><p>AOF \u91CD\u5199\u53EF\u4EE5\u4EA7\u751F\u4E00\u4E2A\u65B0\u7684 AOF \u6587\u4EF6\uFF0C\u8FD9\u4E2A\u65B0\u7684 AOF \u6587\u4EF6\u548C\u539F\u6709\u7684 AOF \u6587\u4EF6\u6240\u4FDD\u5B58\u7684\u6570\u636E\u5E93\u72B6\u6001\u4E00\u6837\uFF0C\u4F46\u4F53\u79EF\u66F4\u5C0F\u3002</p><p>AOF \u91CD\u5199\u662F\u4E00\u4E2A\u6709\u6B67\u4E49\u7684\u540D\u5B57\uFF0C\u8BE5\u529F\u80FD\u662F\u901A\u8FC7\u8BFB\u53D6\u6570\u636E\u5E93\u4E2D\u7684\u952E\u503C\u5BF9\u6765\u5B9E\u73B0\u7684\uFF0C\u7A0B\u5E8F\u65E0\u987B\u5BF9\u73B0\u6709 AOF \u6587\u4EF6\u8FDB\u884C\u4EFB\u4F55\u8BFB\u5165\u3001\u5206\u6790\u6216\u8005\u5199\u5165\u64CD\u4F5C\u3002</p><p>\u5728\u6267\u884C BGREWRITEAOF \u547D\u4EE4\u65F6\uFF0CRedis \u670D\u52A1\u5668\u4F1A\u7EF4\u62A4\u4E00\u4E2A AOF \u91CD\u5199\u7F13\u51B2\u533A\uFF0C\u8BE5\u7F13\u51B2\u533A\u4F1A\u5728\u5B50\u8FDB\u7A0B\u521B\u5EFA\u65B0 AOF \u6587\u4EF6\u671F\u95F4\uFF0C\u8BB0\u5F55\u670D\u52A1\u5668\u6267\u884C\u7684\u6240\u6709\u5199\u547D\u4EE4\u3002\u5F53\u5B50\u8FDB\u7A0B\u5B8C\u6210\u521B\u5EFA\u65B0 AOF \u6587\u4EF6\u7684\u5DE5\u4F5C\u4E4B\u540E\uFF0C\u670D\u52A1\u5668\u4F1A\u5C06\u91CD\u5199\u7F13\u51B2\u533A\u4E2D\u7684\u6240\u6709\u5185\u5BB9\u8FFD\u52A0\u5230\u65B0 AOF \u6587\u4EF6\u7684\u672B\u5C3E\uFF0C\u4F7F\u5F97\u65B0\u65E7\u4E24\u4E2A AOF \u6587\u4EF6\u6240\u4FDD\u5B58\u7684\u6570\u636E\u5E93\u72B6\u6001\u4E00\u81F4\u3002\u6700\u540E\uFF0C\u670D\u52A1\u5668\u7528\u65B0\u7684 AOF \u6587\u4EF6\u66FF\u6362\u65E7\u7684 AOF \u6587\u4EF6\uFF0C\u4EE5\u6B64\u6765\u5B8C\u6210 AOF \u6587\u4EF6\u91CD\u5199\u64CD\u4F5C</p><h1 id="\u516B\u3001\u4E8B\u52A1" tabindex="-1"><a class="header-anchor" href="#\u516B\u3001\u4E8B\u52A1" aria-hidden="true">#</a> \u516B\u3001\u4E8B\u52A1</h1><p>\u4E00\u4E2A\u4E8B\u52A1\u5305\u542B\u4E86\u591A\u4E2A\u547D\u4EE4\uFF0C\u670D\u52A1\u5668\u5728\u6267\u884C\u4E8B\u52A1\u671F\u95F4\uFF0C\u4E0D\u4F1A\u6539\u53BB\u6267\u884C\u5176\u5B83\u5BA2\u6237\u7AEF\u7684\u547D\u4EE4\u8BF7\u6C42\u3002</p><p>\u4E8B\u52A1\u4E2D\u7684\u591A\u4E2A\u547D\u4EE4\u88AB\u4E00\u6B21\u6027\u53D1\u9001\u7ED9\u670D\u52A1\u5668\uFF0C\u800C\u4E0D\u662F\u4E00\u6761\u4E00\u6761\u53D1\u9001\uFF0C\u8FD9\u79CD\u65B9\u5F0F\u88AB\u79F0\u4E3A\u6D41\u6C34\u7EBF\uFF0C\u5B83\u53EF\u4EE5\u51CF\u5C11\u5BA2\u6237\u7AEF\u4E0E\u670D\u52A1\u5668\u4E4B\u95F4\u7684\u7F51\u7EDC\u901A\u4FE1\u6B21\u6570\u4ECE\u800C\u63D0\u5347\u6027\u80FD\u3002</p><p>Redis \u6700\u7B80\u5355\u7684\u4E8B\u52A1\u5B9E\u73B0\u65B9\u5F0F\u662F\u4F7F\u7528 MULTI \u548C EXEC \u547D\u4EE4\u5C06\u4E8B\u52A1\u64CD\u4F5C\u5305\u56F4\u8D77\u6765\u3002</p><h1 id="\u4E5D\u3001\u4E8B\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u4E5D\u3001\u4E8B\u4EF6" aria-hidden="true">#</a> \u4E5D\u3001\u4E8B\u4EF6</h1><p>Redis \u670D\u52A1\u5668\u662F\u4E00\u4E2A\u4E8B\u4EF6\u9A71\u52A8\u7A0B\u5E8F\u3002</p><h2 id="\u6587\u4EF6\u4E8B\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u6587\u4EF6\u4E8B\u4EF6" aria-hidden="true">#</a> \u6587\u4EF6\u4E8B\u4EF6</h2><p>\u670D\u52A1\u5668\u901A\u8FC7\u5957\u63A5\u5B57\u4E0E\u5BA2\u6237\u7AEF\u6216\u8005\u5176\u5B83\u670D\u52A1\u5668\u8FDB\u884C\u901A\u4FE1\uFF0C\u6587\u4EF6\u4E8B\u4EF6\u5C31\u662F\u5BF9\u5957\u63A5\u5B57\u64CD\u4F5C\u7684\u62BD\u8C61\u3002</p><p>Redis \u57FA\u4E8E Reactor \u6A21\u5F0F\u5F00\u53D1\u4E86\u81EA\u5DF1\u7684\u7F51\u7EDC\u4E8B\u4EF6\u5904\u7406\u5668\uFF0C\u4F7F\u7528 I/O \u591A\u8DEF\u590D\u7528\u7A0B\u5E8F\u6765\u540C\u65F6\u76D1\u542C\u591A\u4E2A\u5957\u63A5\u5B57\uFF0C\u5E76\u5C06\u5230\u8FBE\u7684\u4E8B\u4EF6\u4F20\u9001\u7ED9\u6587\u4EF6\u4E8B\u4EF6\u5206\u6D3E\u5668\uFF0C\u5206\u6D3E\u5668\u4F1A\u6839\u636E\u5957\u63A5\u5B57\u4EA7\u751F\u7684\u4E8B\u4EF6\u7C7B\u578B\u8C03\u7528\u76F8\u5E94\u7684\u4E8B\u4EF6\u5904\u7406\u5668\u3002</p><div align="center"><img src="https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/9ea86eb5-000a-4281-b948-7b567bd6f1d8.png" width=""></div><br><p>\u6CE8\u610F\uFF01 Redis 6.0 \u4E4B\u540E\u7684\u7248\u672C\u629B\u5F03\u4E86\u5355\u7EBF\u7A0B\u6A21\u578B\u8FD9\u4E00\u8BBE\u8BA1\uFF0C\u539F\u672C\u4F7F\u7528\u5355\u7EBF\u7A0B\u8FD0\u884C\u7684 Redis \u4E5F\u5F00\u59CB\u9009\u62E9\u6027\u5730\u4F7F\u7528\u591A\u7EBF\u7A0B\u6A21\u578B\u3002</p><p>\u524D\u9762\u8FD8\u5728\u5F3A\u8C03 Redis \u5355\u7EBF\u7A0B\u6A21\u578B\u7684\u9AD8\u6548\u6027\uFF0C\u73B0\u5728\u4E3A\u4EC0\u4E48\u53C8\u8981\u5F15\u5165\u591A\u7EBF\u7A0B\uFF1F\u8FD9\u5176\u5B9E\u8BF4\u660E Redis \u5728\u6709\u4E9B\u65B9\u9762\uFF0C\u5355\u7EBF\u7A0B\u5DF2\u7ECF\u4E0D\u5177\u6709\u4F18\u52BF\u4E86\u3002\u56E0\u4E3A\u8BFB\u5199\u7F51\u7EDC\u7684 Read/Write \u7CFB\u7EDF\u8C03\u7528\u5728 Redis \u6267\u884C\u671F\u95F4\u5360\u7528\u4E86\u5927\u90E8\u5206 CPU \u65F6\u95F4\uFF0C\u5982\u679C\u628A\u7F51\u7EDC\u8BFB\u5199\u505A\u6210\u591A\u7EBF\u7A0B\u7684\u65B9\u5F0F\u5BF9\u6027\u80FD\u4F1A\u6709\u5F88\u5927\u63D0\u5347\u3002</p><p>Redis \u7684\u591A\u7EBF\u7A0B\u90E8\u5206\u53EA\u662F\u7528\u6765\u5904\u7406\u7F51\u7EDC\u6570\u636E\u7684\u8BFB\u5199\u548C\u534F\u8BAE\u89E3\u6790\uFF0C\u6267\u884C\u547D\u4EE4\u4ECD\u7136\u662F\u5355\u7EBF\u7A0B\u3002 \u4E4B\u6240\u4EE5\u8FD9\u4E48\u8BBE\u8BA1\u662F\u4E0D\u60F3 Redis \u56E0\u4E3A\u591A\u7EBF\u7A0B\u800C\u53D8\u5F97\u590D\u6742\uFF0C\u9700\u8981\u53BB\u63A7\u5236 key\u3001lua\u3001\u4E8B\u52A1\u3001LPUSH/LPOP \u7B49\u7B49\u7684\u5E76\u53D1\u95EE\u9898\u3002</p><h2 id="\u65F6\u95F4\u4E8B\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u65F6\u95F4\u4E8B\u4EF6" aria-hidden="true">#</a> \u65F6\u95F4\u4E8B\u4EF6</h2><p>\u670D\u52A1\u5668\u6709\u4E00\u4E9B\u64CD\u4F5C\u9700\u8981\u5728\u7ED9\u5B9A\u7684\u65F6\u95F4\u70B9\u6267\u884C\uFF0C\u65F6\u95F4\u4E8B\u4EF6\u662F\u5BF9\u8FD9\u7C7B\u5B9A\u65F6\u64CD\u4F5C\u7684\u62BD\u8C61\u3002</p><p>\u65F6\u95F4\u4E8B\u4EF6\u53C8\u5206\u4E3A\uFF1A</p><ul><li>\u5B9A\u65F6\u4E8B\u4EF6\uFF1A\u662F\u8BA9\u4E00\u6BB5\u7A0B\u5E8F\u5728\u6307\u5B9A\u7684\u65F6\u95F4\u4E4B\u5185\u6267\u884C\u4E00\u6B21\uFF1B</li><li>\u5468\u671F\u6027\u4E8B\u4EF6\uFF1A\u662F\u8BA9\u4E00\u6BB5\u7A0B\u5E8F\u6BCF\u9694\u6307\u5B9A\u65F6\u95F4\u5C31\u6267\u884C\u4E00\u6B21\u3002</li></ul><p>Redis \u5C06\u6240\u6709\u65F6\u95F4\u4E8B\u4EF6\u90FD\u653E\u5728\u4E00\u4E2A\u65E0\u5E8F\u94FE\u8868\u4E2D\uFF0C\u901A\u8FC7\u904D\u5386\u6574\u4E2A\u94FE\u8868\u67E5\u627E\u51FA\u5DF2\u5230\u8FBE\u7684\u65F6\u95F4\u4E8B\u4EF6\uFF0C\u5E76\u8C03\u7528\u76F8\u5E94\u7684\u4E8B\u4EF6\u5904\u7406\u5668\u3002</p><h2 id="\u4E8B\u4EF6\u7684\u8C03\u5EA6\u4E0E\u6267\u884C" tabindex="-1"><a class="header-anchor" href="#\u4E8B\u4EF6\u7684\u8C03\u5EA6\u4E0E\u6267\u884C" aria-hidden="true">#</a> \u4E8B\u4EF6\u7684\u8C03\u5EA6\u4E0E\u6267\u884C</h2><p>\u670D\u52A1\u5668\u9700\u8981\u4E0D\u65AD\u76D1\u542C\u6587\u4EF6\u4E8B\u4EF6\u7684\u5957\u63A5\u5B57\u624D\u80FD\u5F97\u5230\u5F85\u5904\u7406\u7684\u6587\u4EF6\u4E8B\u4EF6\uFF0C\u4F46\u662F\u4E0D\u80FD\u4E00\u76F4\u76D1\u542C\uFF0C\u5426\u5219\u65F6\u95F4\u4E8B\u4EF6\u65E0\u6CD5\u5728\u89C4\u5B9A\u7684\u65F6\u95F4\u5185\u6267\u884C\uFF0C\u56E0\u6B64\u76D1\u542C\u65F6\u95F4\u5E94\u8BE5\u6839\u636E\u8DDD\u79BB\u73B0\u5728\u6700\u8FD1\u7684\u65F6\u95F4\u4E8B\u4EF6\u6765\u51B3\u5B9A\u3002</p><p>\u4E8B\u4EF6\u8C03\u5EA6\u4E0E\u6267\u884C\u7531 aeProcessEvents \u51FD\u6570\u8D1F\u8D23\uFF0C\u4F2A\u4EE3\u7801\u5982\u4E0B\uFF1A</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">aeProcessEvents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># \u83B7\u53D6\u5230\u8FBE\u65F6\u95F4\u79BB\u5F53\u524D\u65F6\u95F4\u6700\u63A5\u8FD1\u7684\u65F6\u95F4\u4E8B\u4EF6</span>
    time_event <span class="token operator">=</span> aeSearchNearestTimer<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># \u8BA1\u7B97\u6700\u63A5\u8FD1\u7684\u65F6\u95F4\u4E8B\u4EF6\u8DDD\u79BB\u5230\u8FBE\u8FD8\u6709\u591A\u5C11\u6BEB\u79D2</span>
    remaind_ms <span class="token operator">=</span> time_event<span class="token punctuation">.</span>when <span class="token operator">-</span> unix_ts_now<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># \u5982\u679C\u4E8B\u4EF6\u5DF2\u5230\u8FBE\uFF0C\u90A3\u4E48 remaind_ms \u7684\u503C\u53EF\u80FD\u4E3A\u8D1F\u6570\uFF0C\u5C06\u5B83\u8BBE\u4E3A 0</span>
    <span class="token keyword">if</span> remaind_ms <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        remaind_ms <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token comment"># \u6839\u636E remaind_ms \u7684\u503C\uFF0C\u521B\u5EFA timeval</span>
    timeval <span class="token operator">=</span> create_timeval_with_ms<span class="token punctuation">(</span>remaind_ms<span class="token punctuation">)</span>
    <span class="token comment"># \u963B\u585E\u5E76\u7B49\u5F85\u6587\u4EF6\u4E8B\u4EF6\u4EA7\u751F\uFF0C\u6700\u5927\u963B\u585E\u65F6\u95F4\u7531\u4F20\u5165\u7684 timeval \u51B3\u5B9A</span>
    aeApiPoll<span class="token punctuation">(</span>timeval<span class="token punctuation">)</span>
    <span class="token comment"># \u5904\u7406\u6240\u6709\u5DF2\u4EA7\u751F\u7684\u6587\u4EF6\u4E8B\u4EF6</span>
    procesFileEvents<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># \u5904\u7406\u6240\u6709\u5DF2\u5230\u8FBE\u7684\u65F6\u95F4\u4E8B\u4EF6</span>
    processTimeEvents<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>\u5C06 aeProcessEvents \u51FD\u6570\u7F6E\u4E8E\u4E00\u4E2A\u5FAA\u73AF\u91CC\u9762\uFF0C\u52A0\u4E0A\u521D\u59CB\u5316\u548C\u6E05\u7406\u51FD\u6570\uFF0C\u5C31\u6784\u6210\u4E86 Redis \u670D\u52A1\u5668\u7684\u4E3B\u51FD\u6570\uFF0C\u4F2A\u4EE3\u7801\u5982\u4E0B\uFF1A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># \u521D\u59CB\u5316\u670D\u52A1\u5668</span>
    init_server<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># \u4E00\u76F4\u5904\u7406\u4E8B\u4EF6\uFF0C\u76F4\u5230\u670D\u52A1\u5668\u5173\u95ED\u4E3A\u6B62</span>
    <span class="token keyword">while</span> server_is_not_shutdown<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        aeProcessEvents<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># \u670D\u52A1\u5668\u5173\u95ED\uFF0C\u6267\u884C\u6E05\u7406\u64CD\u4F5C</span>
    clean_server<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>\u4ECE\u4E8B\u4EF6\u5904\u7406\u7684\u89D2\u5EA6\u6765\u770B\uFF0C\u670D\u52A1\u5668\u8FD0\u884C\u6D41\u7A0B\u5982\u4E0B\uFF1A</p><div align="center"><img src="https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/c0a9fa91-da2e-4892-8c9f-80206a6f7047.png" width="350"></div><br><h1 id="\u5341\u3001\u590D\u5236" tabindex="-1"><a class="header-anchor" href="#\u5341\u3001\u590D\u5236" aria-hidden="true">#</a> \u5341\u3001\u590D\u5236</h1><p>\u901A\u8FC7\u4F7F\u7528 slaveof host port \u547D\u4EE4\u6765\u8BA9\u4E00\u4E2A\u670D\u52A1\u5668\u6210\u4E3A\u53E6\u4E00\u4E2A\u670D\u52A1\u5668\u7684\u4ECE\u670D\u52A1\u5668\u3002</p><p>\u4E00\u4E2A\u4ECE\u670D\u52A1\u5668\u53EA\u80FD\u6709\u4E00\u4E2A\u4E3B\u670D\u52A1\u5668\uFF0C\u5E76\u4E14\u4E0D\u652F\u6301\u4E3B\u4E3B\u590D\u5236\u3002</p><h2 id="\u8FDE\u63A5\u8FC7\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u8FDE\u63A5\u8FC7\u7A0B" aria-hidden="true">#</a> \u8FDE\u63A5\u8FC7\u7A0B</h2><ol><li><p>\u4E3B\u670D\u52A1\u5668\u521B\u5EFA\u5FEB\u7167\u6587\u4EF6\uFF0C\u53D1\u9001\u7ED9\u4ECE\u670D\u52A1\u5668\uFF0C\u5E76\u5728\u53D1\u9001\u671F\u95F4\u4F7F\u7528\u7F13\u51B2\u533A\u8BB0\u5F55\u6267\u884C\u7684\u5199\u547D\u4EE4\u3002\u5FEB\u7167\u6587\u4EF6\u53D1\u9001\u5B8C\u6BD5\u4E4B\u540E\uFF0C\u5F00\u59CB\u5411\u4ECE\u670D\u52A1\u5668\u53D1\u9001\u5B58\u50A8\u5728\u7F13\u51B2\u533A\u4E2D\u7684\u5199\u547D\u4EE4\uFF1B</p></li><li><p>\u4ECE\u670D\u52A1\u5668\u4E22\u5F03\u6240\u6709\u65E7\u6570\u636E\uFF0C\u8F7D\u5165\u4E3B\u670D\u52A1\u5668\u53D1\u6765\u7684\u5FEB\u7167\u6587\u4EF6\uFF0C\u4E4B\u540E\u4ECE\u670D\u52A1\u5668\u5F00\u59CB\u63A5\u53D7\u4E3B\u670D\u52A1\u5668\u53D1\u6765\u7684\u5199\u547D\u4EE4\uFF1B</p></li><li><p>\u4E3B\u670D\u52A1\u5668\u6BCF\u6267\u884C\u4E00\u6B21\u5199\u547D\u4EE4\uFF0C\u5C31\u5411\u4ECE\u670D\u52A1\u5668\u53D1\u9001\u76F8\u540C\u7684\u5199\u547D\u4EE4\u3002</p></li></ol><h2 id="\u4E3B\u4ECE\u94FE" tabindex="-1"><a class="header-anchor" href="#\u4E3B\u4ECE\u94FE" aria-hidden="true">#</a> \u4E3B\u4ECE\u94FE</h2><p>\u968F\u7740\u8D1F\u8F7D\u4E0D\u65AD\u4E0A\u5347\uFF0C\u4E3B\u670D\u52A1\u5668\u53EF\u80FD\u65E0\u6CD5\u5F88\u5FEB\u5730\u66F4\u65B0\u6240\u6709\u4ECE\u670D\u52A1\u5668\uFF0C\u6216\u8005\u91CD\u65B0\u8FDE\u63A5\u548C\u91CD\u65B0\u540C\u6B65\u4ECE\u670D\u52A1\u5668\u5C06\u5BFC\u81F4\u7CFB\u7EDF\u8D85\u8F7D\u3002\u4E3A\u4E86\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898\uFF0C\u53EF\u4EE5\u521B\u5EFA\u4E00\u4E2A\u4E2D\u95F4\u5C42\u6765\u5206\u62C5\u4E3B\u670D\u52A1\u5668\u7684\u590D\u5236\u5DE5\u4F5C\u3002\u4E2D\u95F4\u5C42\u7684\u670D\u52A1\u5668\u662F\u6700\u4E0A\u5C42\u670D\u52A1\u5668\u7684\u4ECE\u670D\u52A1\u5668\uFF0C\u53C8\u662F\u6700\u4E0B\u5C42\u670D\u52A1\u5668\u7684\u4E3B\u670D\u52A1\u5668\u3002</p><div align="center"><img src="https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/395a9e83-b1a1-4a1d-b170-d081e7bb5bab.png" width="600"></div><br><h1 id="\u5341\u4E00\u3001sentinel" tabindex="-1"><a class="header-anchor" href="#\u5341\u4E00\u3001sentinel" aria-hidden="true">#</a> \u5341\u4E00\u3001Sentinel</h1><p>Sentinel\uFF08\u54E8\u5175\uFF09\u53EF\u4EE5\u76D1\u542C\u96C6\u7FA4\u4E2D\u7684\u670D\u52A1\u5668\uFF0C\u5E76\u5728\u4E3B\u670D\u52A1\u5668\u8FDB\u5165\u4E0B\u7EBF\u72B6\u6001\u65F6\uFF0C\u81EA\u52A8\u4ECE\u4ECE\u670D\u52A1\u5668\u4E2D\u9009\u4E3E\u51FA\u65B0\u7684\u4E3B\u670D\u52A1\u5668\u3002</p><h1 id="\u5341\u4E8C\u3001\u5206\u7247" tabindex="-1"><a class="header-anchor" href="#\u5341\u4E8C\u3001\u5206\u7247" aria-hidden="true">#</a> \u5341\u4E8C\u3001\u5206\u7247</h1><p>\u5206\u7247\u662F\u5C06\u6570\u636E\u5212\u5206\u4E3A\u591A\u4E2A\u90E8\u5206\u7684\u65B9\u6CD5\uFF0C\u53EF\u4EE5\u5C06\u6570\u636E\u5B58\u50A8\u5230\u591A\u53F0\u673A\u5668\u91CC\u9762\uFF0C\u8FD9\u79CD\u65B9\u6CD5\u5728\u89E3\u51B3\u67D0\u4E9B\u95EE\u9898\u65F6\u53EF\u4EE5\u83B7\u5F97\u7EBF\u6027\u7EA7\u522B\u7684\u6027\u80FD\u63D0\u5347\u3002</p><p>\u5047\u8BBE\u6709 4 \u4E2A Redis \u5B9E\u4F8B R0\uFF0CR1\uFF0CR2\uFF0CR3\uFF0C\u8FD8\u6709\u5F88\u591A\u8868\u793A\u7528\u6237\u7684\u952E user:1\uFF0Cuser:2\uFF0C... \uFF0C\u6709\u4E0D\u540C\u7684\u65B9\u5F0F\u6765\u9009\u62E9\u4E00\u4E2A\u6307\u5B9A\u7684\u952E\u5B58\u50A8\u5728\u54EA\u4E2A\u5B9E\u4F8B\u4E2D\u3002</p><ul><li>\u6700\u7B80\u5355\u7684\u65B9\u5F0F\u662F\u8303\u56F4\u5206\u7247\uFF0C\u4F8B\u5982\u7528\u6237 id \u4ECE 0~1000 \u7684\u5B58\u50A8\u5230\u5B9E\u4F8B R0 \u4E2D\uFF0C\u7528\u6237 id \u4ECE 1001~2000 \u7684\u5B58\u50A8\u5230\u5B9E\u4F8B R1 \u4E2D\uFF0C\u7B49\u7B49\u3002\u4F46\u662F\u8FD9\u6837\u9700\u8981\u7EF4\u62A4\u4E00\u5F20\u6620\u5C04\u8303\u56F4\u8868\uFF0C\u7EF4\u62A4\u64CD\u4F5C\u4EE3\u4EF7\u5F88\u9AD8\u3002</li><li>\u8FD8\u6709\u4E00\u79CD\u65B9\u5F0F\u662F\u54C8\u5E0C\u5206\u7247\uFF0C\u4F7F\u7528 CRC32 \u54C8\u5E0C\u51FD\u6570\u5C06\u952E\u8F6C\u6362\u4E3A\u4E00\u4E2A\u6570\u5B57\uFF0C\u518D\u5BF9\u5B9E\u4F8B\u6570\u91CF\u6C42\u6A21\u5C31\u80FD\u77E5\u9053\u5E94\u8BE5\u5B58\u50A8\u7684\u5B9E\u4F8B\u3002</li></ul><p>\u6839\u636E\u6267\u884C\u5206\u7247\u7684\u4F4D\u7F6E\uFF0C\u53EF\u4EE5\u5206\u4E3A\u4E09\u79CD\u5206\u7247\u65B9\u5F0F\uFF1A</p><ul><li>\u5BA2\u6237\u7AEF\u5206\u7247\uFF1A\u5BA2\u6237\u7AEF\u4F7F\u7528\u4E00\u81F4\u6027\u54C8\u5E0C\u7B49\u7B97\u6CD5\u51B3\u5B9A\u952E\u5E94\u5F53\u5206\u5E03\u5230\u54EA\u4E2A\u8282\u70B9\u3002</li><li>\u4EE3\u7406\u5206\u7247\uFF1A\u5C06\u5BA2\u6237\u7AEF\u8BF7\u6C42\u53D1\u9001\u5230\u4EE3\u7406\u4E0A\uFF0C\u7531\u4EE3\u7406\u8F6C\u53D1\u8BF7\u6C42\u5230\u6B63\u786E\u7684\u8282\u70B9\u4E0A\u3002</li><li>\u670D\u52A1\u5668\u5206\u7247\uFF1ARedis Cluster\u3002</li></ul><h1 id="\u5341\u4E09\u3001\u4E00\u4E2A\u7B80\u5355\u7684\u8BBA\u575B\u7CFB\u7EDF\u5206\u6790" tabindex="-1"><a class="header-anchor" href="#\u5341\u4E09\u3001\u4E00\u4E2A\u7B80\u5355\u7684\u8BBA\u575B\u7CFB\u7EDF\u5206\u6790" aria-hidden="true">#</a> \u5341\u4E09\u3001\u4E00\u4E2A\u7B80\u5355\u7684\u8BBA\u575B\u7CFB\u7EDF\u5206\u6790</h1><p>\u8BE5\u8BBA\u575B\u7CFB\u7EDF\u529F\u80FD\u5982\u4E0B\uFF1A</p><ul><li>\u53EF\u4EE5\u53D1\u5E03\u6587\u7AE0\uFF1B</li><li>\u53EF\u4EE5\u5BF9\u6587\u7AE0\u8FDB\u884C\u70B9\u8D5E\uFF1B</li><li>\u5728\u9996\u9875\u53EF\u4EE5\u6309\u6587\u7AE0\u7684\u53D1\u5E03\u65F6\u95F4\u6216\u8005\u6587\u7AE0\u7684\u70B9\u8D5E\u6570\u8FDB\u884C\u6392\u5E8F\u663E\u793A\u3002</li></ul><h2 id="\u6587\u7AE0\u4FE1\u606F" tabindex="-1"><a class="header-anchor" href="#\u6587\u7AE0\u4FE1\u606F" aria-hidden="true">#</a> \u6587\u7AE0\u4FE1\u606F</h2><p>\u6587\u7AE0\u5305\u62EC\u6807\u9898\u3001\u4F5C\u8005\u3001\u8D5E\u6570\u7B49\u4FE1\u606F\uFF0C\u5728\u5173\u7CFB\u578B\u6570\u636E\u5E93\u4E2D\u5F88\u5BB9\u6613\u6784\u5EFA\u4E00\u5F20\u8868\u6765\u5B58\u50A8\u8FD9\u4E9B\u4FE1\u606F\uFF0C\u5728 Redis \u4E2D\u53EF\u4EE5\u4F7F\u7528 HASH \u6765\u5B58\u50A8\u6BCF\u79CD\u4FE1\u606F\u4EE5\u53CA\u5176\u5BF9\u5E94\u7684\u503C\u7684\u6620\u5C04\u3002</p><p>Redis \u6CA1\u6709\u5173\u7CFB\u578B\u6570\u636E\u5E93\u4E2D\u7684\u8868\u8FD9\u4E00\u6982\u5FF5\u6765\u5C06\u540C\u79CD\u7C7B\u578B\u7684\u6570\u636E\u5B58\u653E\u5728\u4E00\u8D77\uFF0C\u800C\u662F\u4F7F\u7528\u547D\u540D\u7A7A\u95F4\u7684\u65B9\u5F0F\u6765\u5B9E\u73B0\u8FD9\u4E00\u529F\u80FD\u3002\u952E\u540D\u7684\u524D\u9762\u90E8\u5206\u5B58\u50A8\u547D\u540D\u7A7A\u95F4\uFF0C\u540E\u9762\u90E8\u5206\u7684\u5185\u5BB9\u5B58\u50A8 ID\uFF0C\u901A\u5E38\u4F7F\u7528 : \u6765\u8FDB\u884C\u5206\u9694\u3002\u4F8B\u5982\u4E0B\u9762\u7684 HASH \u7684\u952E\u540D\u4E3A article:92617\uFF0C\u5176\u4E2D article \u4E3A\u547D\u540D\u7A7A\u95F4\uFF0CID \u4E3A 92617\u3002</p><div align="center"><img src="https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/7c54de21-e2ff-402e-bc42-4037de1c1592.png" width="400"></div><br><h2 id="\u70B9\u8D5E\u529F\u80FD" tabindex="-1"><a class="header-anchor" href="#\u70B9\u8D5E\u529F\u80FD" aria-hidden="true">#</a> \u70B9\u8D5E\u529F\u80FD</h2><p>\u5F53\u6709\u7528\u6237\u4E3A\u4E00\u7BC7\u6587\u7AE0\u70B9\u8D5E\u65F6\uFF0C\u9664\u4E86\u8981\u5BF9\u8BE5\u6587\u7AE0\u7684 votes \u5B57\u6BB5\u8FDB\u884C\u52A0 1 \u64CD\u4F5C\uFF0C\u8FD8\u5FC5\u987B\u8BB0\u5F55\u8BE5\u7528\u6237\u5DF2\u7ECF\u5BF9\u8BE5\u6587\u7AE0\u8FDB\u884C\u4E86\u70B9\u8D5E\uFF0C\u9632\u6B62\u7528\u6237\u70B9\u8D5E\u6B21\u6570\u8D85\u8FC7 1\u3002\u53EF\u4EE5\u5EFA\u7ACB\u6587\u7AE0\u7684\u5DF2\u6295\u7968\u7528\u6237\u96C6\u5408\u6765\u8FDB\u884C\u8BB0\u5F55\u3002</p><p>\u4E3A\u4E86\u8282\u7EA6\u5185\u5B58\uFF0C\u89C4\u5B9A\u4E00\u7BC7\u6587\u7AE0\u53D1\u5E03\u6EE1\u4E00\u5468\u4E4B\u540E\uFF0C\u5C31\u4E0D\u80FD\u518D\u5BF9\u5B83\u8FDB\u884C\u6295\u7968\uFF0C\u800C\u6587\u7AE0\u7684\u5DF2\u6295\u7968\u96C6\u5408\u4E5F\u4F1A\u88AB\u5220\u9664\uFF0C\u53EF\u4EE5\u4E3A\u6587\u7AE0\u7684\u5DF2\u6295\u7968\u96C6\u5408\u8BBE\u7F6E\u4E00\u4E2A\u4E00\u5468\u7684\u8FC7\u671F\u65F6\u95F4\u5C31\u80FD\u5B9E\u73B0\u8FD9\u4E2A\u89C4\u5B9A\u3002</p><div align="center"><img src="https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/485fdf34-ccf8-4185-97c6-17374ee719a0.png" width="400"></div><br><h2 id="\u5BF9\u6587\u7AE0\u8FDB\u884C\u6392\u5E8F" tabindex="-1"><a class="header-anchor" href="#\u5BF9\u6587\u7AE0\u8FDB\u884C\u6392\u5E8F" aria-hidden="true">#</a> \u5BF9\u6587\u7AE0\u8FDB\u884C\u6392\u5E8F</h2><p>\u4E3A\u4E86\u6309\u53D1\u5E03\u65F6\u95F4\u548C\u70B9\u8D5E\u6570\u8FDB\u884C\u6392\u5E8F\uFF0C\u53EF\u4EE5\u5EFA\u7ACB\u4E00\u4E2A\u6587\u7AE0\u53D1\u5E03\u65F6\u95F4\u7684\u6709\u5E8F\u96C6\u5408\u548C\u4E00\u4E2A\u6587\u7AE0\u70B9\u8D5E\u6570\u7684\u6709\u5E8F\u96C6\u5408\u3002\uFF08\u4E0B\u56FE\u4E2D\u7684 score \u5C31\u662F\u8FD9\u91CC\u6240\u8BF4\u7684\u70B9\u8D5E\u6570\uFF1B\u4E0B\u9762\u6240\u793A\u7684\u6709\u5E8F\u96C6\u5408\u5206\u503C\u5E76\u4E0D\u76F4\u63A5\u662F\u65F6\u95F4\u548C\u70B9\u8D5E\u6570\uFF0C\u800C\u662F\u6839\u636E\u65F6\u95F4\u548C\u70B9\u8D5E\u6570\u95F4\u63A5\u8BA1\u7B97\u51FA\u6765\u7684\uFF09</p><div align="center"><img src="https://cs-notes-1256109796.cos.ap-guangzhou.myqcloud.com/f7d170a3-e446-4a64-ac2d-cb95028f81a8.png" width="800"></div><h1 id="\u53C2\u8003\u8D44\u6599" tabindex="-1"><a class="header-anchor" href="#\u53C2\u8003\u8D44\u6599" aria-hidden="true">#</a> \u53C2\u8003\u8D44\u6599</h1>`,188),y=e("li",null,"Carlson J L. Redis in Action[J]. Media.johnwiley.com.au, 2013.",-1),f={href:"http://redisbook.com/index.html",target:"_blank",rel:"noopener noreferrer"},B=s("\u9EC4\u5065\u5B8F. Redis \u8BBE\u8BA1\u4E0E\u5B9E\u73B0 [M]. \u673A\u68B0\u5DE5\u4E1A\u51FA\u7248\u793E, 2014."),x={href:"https://redislabs.com/ebook/foreword/",target:"_blank",rel:"noopener noreferrer"},A=s("REDIS IN ACTION"),v={href:"http://ticki.github.io/blog/skip-lists-done-right/",target:"_blank",rel:"noopener noreferrer"},_=s("Skip Lists: Done Right"),R={href:"http://www.cnblogs.com/loveincode/p/7411911.html",target:"_blank",rel:"noopener noreferrer"},q=s("\u8BBA\u8FF0 Redis \u548C Memcached \u7684\u5DEE\u5F02"),w={href:"http://wiki.jikexueyuan.com/project/redis-guide",target:"_blank",rel:"noopener noreferrer"},F=s("Redis 3.0 \u4E2D\u6587\u7248- \u5206\u7247"),D={href:"http://www.scienjus.com/redis-use-case/",target:"_blank",rel:"noopener noreferrer"},z=s("Redis \u5E94\u7528\u573A\u666F"),C={href:"https://redis.io/topics/lru-cache",target:"_blank",rel:"noopener noreferrer"},S=s("Using Redis as an LRU cache");function I(O,N){const a=i("ExternalLinkIcon");return c(),r(p,null,[m,e("blockquote",null,[e("p",null,[e("a",E,[g,n(a)])])]),k,e("ul",null,[y,e("li",null,[e("a",f,[B,n(a)])]),e("li",null,[e("a",x,[A,n(a)])]),e("li",null,[e("a",v,[_,n(a)])]),e("li",null,[e("a",R,[q,n(a)])]),e("li",null,[e("a",w,[F,n(a)])]),e("li",null,[e("a",D,[z,n(a)])]),e("li",null,[e("a",C,[S,n(a)])])])],64)}var P=l(b,[["render",I],["__file","Redis.html.vue"]]);export{P as default};
